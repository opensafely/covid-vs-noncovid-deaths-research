------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  E:\analyses\covid-vs-noncovid-deaths-research\analysis/output/an_imputed_GENERAL_MAINSA_anywhereonDC_coviddeath_agesex_agespl.log
  log type:  text
 opened on:  20 Feb 2021, 21:59:45

. 
. use ./analysis/an_impute_imputeddata_`dataset', replace

. 
. if "`5'"=="SA_anywhereonDC"{
.         replace coviddeath = 1 if onsdeath>=1 & onsdeath<. & died_ons_covid_flag_any==1
(1,574 real changes made)
.         replace noncoviddeath = 0 if died_ons_covid_flag_any==1
(1,574 real changes made)
. }

. 
. if "`5'"=="SA_u071only"{
.         replace coviddeath = 0 if died_ons_covidconf_flag_und!=1
.         replace noncoviddeath = 1 if onsdeath>=1 & onsdeath<. & died_ons_covidconf_flag_und!=1
. }

. 
. if "`outcome'"=="deathsonlyCvN"{
.         drop if !(onsdeath>=1&onsdeath<.)
.         gen deathsonlyCvN = (coviddeath==1)
. }

. 
. tab `outcome'

 coviddeath |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 | 17,437,878       99.89       99.89
          1 |     18,637        0.11      100.00
------------+-----------------------------------
      Total | 17,456,515      100.00

. 
. if "`modeltorun'"=="agesex_cox"{
.         gen onsdeath_cnc = onsdeath
.         recode onsdeath_cnc 2/6=2
.         if "`outcome'"=="coviddeath" local outcomenum = 1
.         else if "`outcome'"=="noncoviddeath" local outcomenum = 2
.         mi stset stime_onsdeath, fail(onsdeath_cnc==`outcomenum') id(patient_id) enter(enter_date) origin(enter_date)
.         mi estimate: stcox age1 age2 age3 male i.ethnicity, strata(stp)
.         drop if !(onsdeath>=1&onsdeath<.)
.         gen deathsonlyCvN = (coviddeath==1)
. }

.                 
. if "`modeltorun'"=="agesex"{
. *Age-sex model
. mi estimate, eform post: logistic `outcome' age1 age2 age3 i.male i.stp i.ethnicity 

Multiple-imputation estimates                   Imputations       =         10
Logistic regression                             Number of obs     = 17,456,515
                                                Average RVI       =     0.0335
                                                Largest FMI       =     0.4063
DF adjustment:   Large sample                   DF:     min       =      60.14
                                                        avg       =   7.67e+08
                                                        max       =   1.61e+09
Model F test:       Equal FMI                   F(  39,310153.6)  =     948.64
Within VCE type:          OIM                   Prob > F          =     0.0000

-----------------------------------------------------------------------------------------
             coviddeath |     exp(b)   Std. Err.      t    P>|t|     [95% Conf. Interval]
------------------------+----------------------------------------------------------------
                   age1 |   1.156835   .0188822     8.93   0.000     1.120413    1.194442
                   age2 |   .9388625   .0334061    -1.77   0.076     .8756187    1.006674
                   age3 |   1.166859   .0961729     1.87   0.061     .9928009    1.371434
                 1.male |   1.705386   .0255379    35.65   0.000      1.65606    1.756181
                        |
                    stp |
                     2  |   .5674626   .4045633    -0.79   0.427     .1403094    2.295026
                     3  |   .4063819   .2899368    -1.26   0.207     .1003777    1.645249
                     4  |   .8551287    .611343    -0.22   0.827     .2106183    3.471898
                     5  |   .7111397   .5093999    -0.48   0.634     .1746734    2.895231
                     6  |   .6213015   .4431133    -0.67   0.505     .1535409     2.51409
                     7  |   .6957801   .5013514    -0.50   0.615     .1694845    2.856366
                     8  |   .5397568   .3850632    -0.86   0.387     .1333367    2.184975
                     9  |   .1974012   .1411516    -2.27   0.023      .048607    .8016798
                    10  |   .5108228   .3644295    -0.94   0.346     .1261853     2.06791
                    11  |   .4352197   .3105446    -1.17   0.244     .1074846    1.762264
                    12  |   .7160096   .5115296    -0.47   0.640     .1765249    2.904236
                    13  |   .5986756   .4273599    -0.72   0.472     .1477638    2.425577
                    14  |   .5521186   .3941711    -0.83   0.405     .1362506     2.23731
                    15  |   .3167908   .2262439    -1.61   0.107     .0781387    1.284337
                    16  |   .2292327   .1636941    -2.06   0.039     .0565506    .9292148
                    17  |   .3330324   .2377717    -1.54   0.124     .0821794    1.349616
                    18  |   .5339882   .3809957    -0.88   0.379     .1318886    2.162002
                    19  |   .4448126   .3174707    -1.14   0.256     .1098144    1.801751
                    20  |   .4975308   .3548639    -0.98   0.328      .122942    2.013444
                    21  |   .5730971   .4088081    -0.78   0.435     .1415922    2.319621
                    22  |   .5004476   .3623444    -0.96   0.339     .1210749    2.068536
                    23  |   .2748139    .196203    -1.81   0.070     .0678148    1.113661
                    24  |   .4829194   .3512037    -1.00   0.317     .1161014    2.008685
                    25  |    .129116   .0931967    -2.84   0.005     .0313745     .531352
                    26  |   .1199155   .0858238    -2.96   0.003     .0294896    .4876206
                    27  |   .3008003   .2147435    -1.68   0.092     .0742334    1.218869
                    28  |     .16244   .1161092    -2.54   0.011     .0400193    .6593511
                    29  |   .2643481   .1889447    -1.86   0.063     .0651289    1.072948
                    30  |   .3938827   .2813591    -1.30   0.192     .0971258    1.597346
                    31  |   .2588846   .1970977    -1.78   0.076      .058218    1.151211
                    32  |    .600246   .4279613    -0.72   0.474     .1484029    2.427817
                        |
              ethnicity |
                 Mixed  |   1.619498   .1634225     4.78   0.000     1.328378    1.974417
Asian or Asian British  |   1.896429   .0741174    16.37   0.000     1.753825    2.050627
                 Black  |   1.778672   .1041809     9.83   0.000     1.584364     1.99681
                 Other  |   1.348347   .1077738     3.74   0.000     1.151803    1.578428
                        |
                  _cons |   2.18e-07   2.02e-07   -16.55   0.000     3.55e-08    1.34e-06
-----------------------------------------------------------------------------------------
. estimates save ./analysis/output/models/an_imputed_agesex_`dataset'`sensan'_`outcome', replace
file ./analysis/output/models/an_imputed_agesex_MAINSA_anywhereonDC_coviddeath.ster saved
. }

. 
. if "`modeltorun'"=="full"{
. *Full model
. mi estimate, eform post: logistic `outcome' ///
>                         `age'                                                   ///
>                         i.male                                                  ///
>                         i.obese4cat                                             ///
>                         i.smoke_nomiss                                  ///
>                         i.ethnicity                                             ///
>                         i.imd                                                   ///
>                         i.htdiag_or_highbp                              ///
>                         i.chronic_respiratory_disease   ///
>                         i.asthmacat                                             ///
>                         i.chronic_cardiac_disease               ///
>                         i.diabcat                                               ///
>                         i.cancer_exhaem_cat                             ///
>                         i.cancer_haem_cat                               ///
>                         i.chronic_liver_disease                 ///
>                         i.stroke                                                ///     
>                         i.dementia                                              ///
>                         i.other_neuro                                   ///
>                         i.reduced_kidney_function_cat2  ///
>                         i.organ_transplant                              ///
>                         i.spleen                                                ///
>                         i.ra_sle_psoriasis                      ///
>                         i.other_immunosuppression               ///
>                         i.stp
. estimates save ./analysis/output/models/an_imputed_full_`dataset'`sensan'_`outcome'_`agetype', replace
. }

. 
. log close
      name:  <unnamed>
       log:  E:\analyses\covid-vs-noncovid-deaths-research\analysis/output/an_imputed_GENERAL_MAINSA_anywhereonDC_coviddeath_agesex_agespl.log
  log type:  text
 closed on:  20 Feb 2021, 22:37:45
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
