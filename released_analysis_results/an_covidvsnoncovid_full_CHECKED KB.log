----------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  e:\analyses\covid-vs-noncovid-deaths-research\analysis\output/an_covidvsnoncovid_full.log
  log type:  text
 opened on:  10 Sep 2020, 01:11:14

. 
. use cr_create_analysis_dataset, clear
(covid vs noncovid ()2020))

. 
. stset stime_onsdeath, fail(onsdeath==1) id(patient_id) enter(enter_date) origin(enter_date)

                id:  patient_id
     failure event:  onsdeath == 1
obs. time interval:  (stime_onsdeath[_n-1], stime_onsdeath]
 enter on or after:  time enter_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time enter_date

------------------------------------------------------------------------------
   17362187  total observations
      4,578  observations end on or before enter()
------------------------------------------------------------------------------
   17357609  observations remaining, representing
   17357609  subjects
     15,513  failures in single-failure-per-subject data
 3.0458e+09  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =       176

. 
. **MULTIVARIATE
. cap prog drop baselogistic 

. prog define baselogistic
  1.         syntax , age(string) bp(string) [ethnicity(real 0) if(string)] 
  2. 
.         if `ethnicity'==1 local ethnicity "i.ethnicity"
  3.         else local ethnicity
  4. 
. cap logistic _d `age'                   ///
>                         i.male                                                  ///
>                         i.obese4cat                                             ///
>                         i.smoke_nomiss                                  ///
>                         `ethnicity'                                             ///
>                         i.imd                                                   ///
>                         `bp'                                                    ///
>                         i.chronic_respiratory_disease   ///
>                         i.asthmacat                                             ///
>                         i.chronic_cardiac_disease               ///
>                         i.diabcat                                               ///
>                         i.cancer_exhaem_cat                             ///
>                         i.cancer_haem_cat                               ///
>                         i.chronic_liver_disease                 ///
>                         i.stroke_dementia                               ///
>                         i.other_neuro                                   ///
>                         i.reduced_kidney_function_cat   ///
>                         i.organ_transplant                              ///
>                         i.spleen                                                ///
>                         i.ra_sle_psoriasis                      ///
>                         i.other_immunosuppression
  5.                         
. end                     

. 
. baselogistic, age("age1 age2 age3")  bp("i.htdiag_or_highbp") ethnicity(0)

. if _rc==0{
. estimates

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(36)       =   54584.51
                                                Prob > chi2       =     0.0000
Log likelihood = -97116.743                     Pseudo R2         =     0.2194

-----------------------------------------------------------------------------------------------
                           _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------------+----------------------------------------------------------------
                         age1 |   1.184259   .0221991     9.02   0.000      1.14154    1.228578
                         age2 |   .8493801   .0345748    -4.01   0.000     .7842474    .9199222
                         age3 |   1.493478   .1405576     4.26   0.000     1.241906    1.796011
                       1.male |   1.489403   .0253601    23.40   0.000     1.440518    1.539946
                              |
                    obese4cat |
           Obese I (30-34.9)  |   .9988389   .0229859    -0.05   0.960     .9547882    1.044922
          Obese II (35-39.9)  |   1.344812   .0453688     8.78   0.000     1.258767    1.436739
             Obese III (40+)  |   1.840148   .0857834    13.08   0.000     1.679468    2.016201
                              |
                 smoke_nomiss |
                      Former  |   1.156169    .021069     7.96   0.000     1.115603     1.19821
                     Current  |   .9403683   .0333259    -1.73   0.083     .8772676    1.008008
                              |
                          imd |
                           2  |   1.113996   .0298237     4.03   0.000     1.057049     1.17401
                           3  |    1.18705   .0316337     6.43   0.000      1.12664    1.250698
                           4  |   1.522747   .0397072    16.13   0.000     1.446878    1.602595
             5 most deprived  |   1.884911   .0492551    24.26   0.000     1.790804    1.983964
                              |
           1.htdiag_or_highbp |   .8983779   .0174762    -5.51   0.000     .8647699    .9332921
1.chronic_respiratory_disease |    1.61872   .0344943    22.60   0.000     1.552505    1.687759
                              |
                    asthmacat |
                 Yes, no OCS  |   .9925087   .0259165    -0.29   0.773     .9429911    1.044626
                Yes with OCS  |   1.125727   .0541521     2.46   0.014      1.02444    1.237027
                              |
    1.chronic_cardiac_disease |   1.184237   .0215019     9.31   0.000     1.142835    1.227139
                              |
                      diabcat |
         Controlled diabetes  |   1.359014   .0285376    14.61   0.000     1.304217    1.416114
       Uncontrolled diabetes  |   1.940284   .0533646    24.10   0.000     1.838461    2.047747
  Diabetes, no hba1c measure  |   2.000023   .0847619    16.36   0.000     1.840605    2.173248
                              |
            cancer_exhaem_cat |
                   Last year  |   1.680688   .0959463     9.09   0.000     1.502775    1.879663
               2-5 years ago  |    1.18522   .0479152     4.20   0.000     1.094932    1.282953
                    5+ years  |   .9813534   .0260107    -0.71   0.478     .9316749    1.033681
                              |
              cancer_haem_cat |
                   Last year  |    2.97619   .3719826     8.73   0.000     2.329551    3.802323
               2-5 years ago  |   2.296947   .1858961    10.28   0.000     1.960026    2.691785
                    5+ years  |   1.586058   .1036119     7.06   0.000     1.395446    1.802708
                              |
      1.chronic_liver_disease |   1.905395   .1201755    10.22   0.000     1.683832    2.156112
            1.stroke_dementia |   2.119648   .0431441    36.91   0.000     2.036752    2.205919
                1.other_neuro |   2.728294   .0924228    29.63   0.000     2.553031    2.915588
                              |
  reduced_kidney_function_cat |
Stage 3a/3b egfr 30-60        |   1.268921    .024312    12.43   0.000     1.222154    1.317478
           Stage 4/5 egfr<30  |   2.347695    .077975    25.70   0.000     2.199735    2.505607
                              |
           1.organ_transplant |   3.304855   .3730356    10.59   0.000     2.648945    4.123175
                     1.spleen |   1.167734   .1654358     1.09   0.274     .8846104    1.541472
           1.ra_sle_psoriasis |   1.198811   .0342861     6.34   0.000      1.13346     1.26793
    1.other_immunosuppression |    2.26254   .2712826     6.81   0.000     1.788692    2.861916
                        _cons |   3.48e-08   2.37e-08   -25.19   0.000     9.15e-09    1.32e-07
-----------------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
. estimates save ./output/models/an_covidvsnoncovid_full_fail1_agespline_bmicat_noeth, replace
file ./output/models/an_covidvsnoncovid_full_fail1_agespline_bmicat_noeth.ster saved
. *estat concordance /*c-statistic*/
. }

. else di "WARNING AGE SPLINE MODEL DID NOT FIT (OUTCOME `outcome')"

.  
. *Age group model (not adj ethnicity)
. baselogistic, age("ib3.agegroup") bp("i.htdiag_or_highbp") ethnicity(0)

. if _rc==0{
. estimates

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(38)       =   51722.24
                                                Prob > chi2       =     0.0000
Log likelihood = -98547.877                     Pseudo R2         =     0.2079

-----------------------------------------------------------------------------------------------
                           _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------------+----------------------------------------------------------------
                     agegroup |
                      18-<40  |   .0611283   .0075896   -22.51   0.000     .0479246    .0779699
                      40-<50  |   .3402196   .0272778   -13.45   0.000     .2907452    .3981127
                      60-<70  |   2.408867   .1119003    18.93   0.000     2.199234    2.638482
                      70-<80  |   5.964847   .2561182    41.59   0.000     5.483407    6.488557
                         80+  |   21.80401   .9287817    72.36   0.000     20.05755    23.70254
                              |
                       1.male |    1.37223   .0231386    18.77   0.000     1.327621    1.418339
                              |
                    obese4cat |
           Obese I (30-34.9)  |   .9013882   .0205871    -4.55   0.000      .861928    .9426548
          Obese II (35-39.9)  |   1.173464     .03934     4.77   0.000     1.098838    1.253159
             Obese III (40+)  |     1.5631   .0725388     9.63   0.000     1.427201     1.71194
                              |
                 smoke_nomiss |
                      Former  |   1.151877   .0209782     7.76   0.000     1.111486    1.193737
                     Current  |   .8538658   .0301051    -4.48   0.000     .7968535    .9149572
                              |
                          imd |
                           2  |   1.116408   .0298592     4.12   0.000     1.059393    1.176492
                           3  |   1.191945   .0317362     6.59   0.000     1.131338    1.255798
                           4  |   1.526078   .0397703    16.22   0.000     1.450087    1.606051
             5 most deprived  |   1.871438   .0488923    23.99   0.000     1.778023    1.969761
                              |
           1.htdiag_or_highbp |   .9317018   .0181633    -3.63   0.000     .8967738    .9679902
1.chronic_respiratory_disease |    1.58499   .0338021    21.60   0.000     1.520105    1.652645
                              |
                    asthmacat |
                 Yes, no OCS  |   .9649977   .0251615    -1.37   0.172     .9169211    1.015595
                Yes with OCS  |   1.087627   .0522447     1.75   0.080     .9899023       1.195
                              |
    1.chronic_cardiac_disease |   1.238428   .0225474    11.75   0.000     1.195015    1.283418
                              |
                      diabcat |
         Controlled diabetes  |   1.301846    .027364    12.55   0.000     1.249304    1.356599
       Uncontrolled diabetes  |    1.78573   .0490925    21.09   0.000     1.692056    1.884589
  Diabetes, no hba1c measure  |   2.085132   .0881837    17.38   0.000     1.919264    2.265334
                              |
            cancer_exhaem_cat |
                   Last year  |   1.643885   .0937743     8.71   0.000     1.469993    1.838348
               2-5 years ago  |   1.156453   .0467224     3.60   0.000      1.06841     1.25175
                    5+ years  |   .9980782   .0264422    -0.07   0.942      .947575    1.051273
                              |
              cancer_haem_cat |
                   Last year  |    2.83004   .3532781     8.33   0.000     2.215827    3.614509
               2-5 years ago  |   2.159623   .1746132     9.52   0.000     1.843127    2.530467
                    5+ years  |   1.552263   .1012991     6.74   0.000     1.365894    1.764062
                              |
      1.chronic_liver_disease |   1.798826   .1132733     9.32   0.000     1.589968     2.03512
            1.stroke_dementia |   2.274885   .0462446    40.43   0.000     2.186029    2.367352
                1.other_neuro |   2.612322   .0883849    28.38   0.000     2.444709    2.791426
                              |
  reduced_kidney_function_cat |
Stage 3a/3b egfr 30-60        |   1.479582   .0278883    20.78   0.000     1.425919    1.535264
           Stage 4/5 egfr<30  |   3.007559   .0987353    33.54   0.000     2.820135    3.207438
                              |
           1.organ_transplant |   2.797056    .315554     9.12   0.000     2.242186    3.489239
                     1.spleen |   1.124237   .1592335     0.83   0.408     .8517188    1.483951
           1.ra_sle_psoriasis |   1.163256   .0332312     5.29   0.000     1.099914    1.230246
    1.other_immunosuppression |   2.103508   .2522539     6.20   0.000     1.662905    2.660852
                        _cons |   .0001165   5.28e-06  -199.89   0.000     .0001066    .0001273
-----------------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
. estimates save ./output/models/an_covidvsnoncovid_full_fail1_agegroup_bmicat_noeth, replace
file ./output/models/an_covidvsnoncovid_full_fail1_agegroup_bmicat_noeth.ster saved
. *estat concordance /*c-statistic*/
. }

. else di "WARNING GROUP MODEL DID NOT FIT (OUTCOME `outcome')"

. 
. *Complete case ethnicity model
. baselogistic, age("age1 age2 age3") bp("i.htdiag_or_highbp") ethnicity(1)

. if _rc==0{
. estimates

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 12,783,591
                                                LR chi2(40)       =   41208.90
                                                Prob > chi2       =     0.0000
Log likelihood = -72100.168                     Pseudo R2         =     0.2223

-----------------------------------------------------------------------------------------------
                           _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------------+----------------------------------------------------------------
                         age1 |   1.175318   .0250345     7.58   0.000     1.127261    1.225423
                         age2 |   .8651436   .0400521    -3.13   0.002     .7900992    .9473159
                         age3 |   1.433429   .1534628     3.36   0.001     1.162108    1.768095
                       1.male |   1.452215   .0286515    18.91   0.000     1.397131    1.509471
                              |
                    obese4cat |
           Obese I (30-34.9)  |   1.014931   .0266401     0.56   0.572     .9640375    1.068511
          Obese II (35-39.9)  |    1.37569   .0528341     8.30   0.000     1.275939     1.48324
             Obese III (40+)  |   1.875565   .1003508    11.75   0.000     1.688843    2.082932
                              |
                 smoke_nomiss |
                      Former  |   1.199487   .0258118     8.45   0.000     1.149948    1.251159
                     Current  |   .9913966   .0403956    -0.21   0.832     .9153015    1.073818
                              |
                    ethnicity |
                       Mixed  |   1.607709   .1861262     4.10   0.000     1.281335    2.017213
      Asian or Asian British  |   1.661943   .0661935    12.75   0.000     1.537141    1.796879
                       Black  |   1.784323   .1072987     9.63   0.000     1.585941    2.007519
                       Other  |   1.501919   .1313002     4.65   0.000     1.265416    1.782625
                              |
                          imd |
                           2  |   1.157577   .0370642     4.57   0.000     1.087165    1.232549
                           3  |   1.227839   .0390059     6.46   0.000      1.15372     1.30672
                           4  |   1.535979   .0476276    13.84   0.000     1.445411    1.632222
             5 most deprived  |   1.821029   .0565644    19.30   0.000     1.713472    1.935337
                              |
           1.htdiag_or_highbp |   .9138669   .0208823    -3.94   0.000     .8738413    .9557259
1.chronic_respiratory_disease |   1.632808   .0397967    20.12   0.000     1.556642    1.712701
                              |
                    asthmacat |
                 Yes, no OCS  |   .9431948   .0284404    -1.94   0.052     .8890678    1.000617
                Yes with OCS  |   1.089866   .0591649     1.59   0.113     .9798609    1.212221
                              |
    1.chronic_cardiac_disease |   1.169338   .0245886     7.44   0.000     1.122125    1.218538
                              |
                      diabcat |
         Controlled diabetes  |   1.313828   .0318236    11.27   0.000     1.252913    1.377706
       Uncontrolled diabetes  |   1.832736   .0580789    19.12   0.000     1.722367    1.950178
  Diabetes, no hba1c measure  |   1.898551   .0924639    13.16   0.000     1.725706    2.088709
                              |
            cancer_exhaem_cat |
                   Last year  |   1.673907     .11141     7.74   0.000      1.46919    1.907149
               2-5 years ago  |   1.240128   .0573857     4.65   0.000     1.132603     1.35786
                    5+ years  |    .999412   .0307729    -0.02   0.985     .9408822    1.061583
                              |
              cancer_haem_cat |
                   Last year  |   2.786789   .4205138     6.79   0.000     2.073298    3.745817
               2-5 years ago  |   2.415753   .2228098     9.56   0.000     2.016251    2.894414
                    5+ years  |    1.59845   .1209413     6.20   0.000     1.378147    1.853968
                              |
      1.chronic_liver_disease |   1.893129   .1352212     8.94   0.000     1.645815    2.177606
            1.stroke_dementia |   2.156684   .0505977    32.76   0.000      2.05976    2.258169
                1.other_neuro |   2.643999   .1042302    24.66   0.000     2.447405    2.856386
                              |
  reduced_kidney_function_cat |
Stage 3a/3b egfr 30-60        |   1.297449   .0289193    11.68   0.000     1.241989    1.355386
           Stage 4/5 egfr<30  |   2.355249   .0906764    22.25   0.000     2.184066    2.539848
                              |
           1.organ_transplant |   3.177344   .4112283     8.93   0.000     2.465457    4.094786
                     1.spleen |   1.090864    .181521     0.52   0.601     .7872811    1.511512
           1.ra_sle_psoriasis |   1.163278    .038815     4.53   0.000     1.089636    1.241896
    1.other_immunosuppression |    2.17498   .2935944     5.76   0.000     1.669375    2.833718
                        _cons |   4.20e-08   3.25e-08   -21.94   0.000     9.22e-09    1.92e-07
-----------------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
. estimates save ./output/models/an_covidvsnoncovid_full_fail1_agespline_bmicat_CCeth, replace
file ./output/models/an_covidvsnoncovid_full_fail1_agespline_bmicat_CCeth.ster saved
. *estat concordance /*c-statistic*/
.  }

.  else di "WARNING CC ETHNICITY MODEL WITH AGESPLINE DID NOT FIT (OUTCOME `outcome')"

.  
.  ***
. 
. stset stime_onsdeath, fail(onsdeath==2) id(patient_id) enter(enter_date) origin(enter_date)

                id:  patient_id
     failure event:  onsdeath == 2
obs. time interval:  (stime_onsdeath[_n-1], stime_onsdeath]
 enter on or after:  time enter_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time enter_date

------------------------------------------------------------------------------
   17362187  total observations
      4,578  observations end on or before enter()
------------------------------------------------------------------------------
   17357609  observations remaining, representing
   17357609  subjects
     83,067  failures in single-failure-per-subject data
 3.0458e+09  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =       176

. 
. 
. baselogistic, age("age1 age2 age3")  bp("i.htdiag_or_highbp") ethnicity(0)

. if _rc==0{
. estimates

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(36)       =  291110.70
                                                Prob > chi2       =     0.0000
Log likelihood = -381068.01                     Pseudo R2         =     0.2764

-----------------------------------------------------------------------------------------------
                           _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------------+----------------------------------------------------------------
                         age1 |   1.191653   .0075644    27.62   0.000     1.176919    1.206571
                         age2 |   .7820624   .0111065   -17.31   0.000     .7605942    .8041366
                         age3 |   1.911056   .0636081    19.46   0.000     1.790366    2.039882
                       1.male |   1.070678    .008045     9.09   0.000     1.055026    1.086563
                              |
                    obese4cat |
           Obese I (30-34.9)  |   .7428039   .0082679   -26.71   0.000     .7267747    .7591867
          Obese II (35-39.9)  |   .8910601   .0154557    -6.65   0.000     .8612767    .9218735
             Obese III (40+)  |   1.215265   .0292606     8.10   0.000     1.159248     1.27399
                              |
                 smoke_nomiss |
                      Former  |   1.143819   .0094629    16.24   0.000     1.125422    1.162517
                     Current  |   1.955129   .0245416    53.41   0.000     1.907616    2.003827
                              |
                          imd |
                           2  |   1.083707   .0123682     7.04   0.000     1.059735    1.108221
                           3  |    1.16185    .013204    13.20   0.000     1.136257     1.18802
                           4  |   1.289197   .0148447    22.06   0.000     1.260428    1.318623
             5 most deprived  |   1.453567   .0171281    31.74   0.000     1.420381    1.487528
                              |
           1.htdiag_or_highbp |   .9595899   .0082304    -4.81   0.000     .9435935    .9758576
1.chronic_respiratory_disease |   1.803449   .0170386    62.42   0.000     1.770361    1.837155
                              |
                    asthmacat |
                 Yes, no OCS  |    .923182   .0109886    -6.72   0.000     .9018939    .9449725
                Yes with OCS  |   .8998334   .0210459    -4.51   0.000     .8595154    .9420426
                              |
    1.chronic_cardiac_disease |   1.410318   .0115294    42.06   0.000     1.387901    1.433097
                              |
                      diabcat |
         Controlled diabetes  |   1.115028   .0110331    11.00   0.000     1.093612    1.136863
       Uncontrolled diabetes  |   1.464554   .0204212    27.36   0.000     1.425071     1.50513
  Diabetes, no hba1c measure  |   1.813532   .0365044    29.57   0.000     1.743378    1.886509
                              |
            cancer_exhaem_cat |
                   Last year  |   10.68801   .1567648   161.52   0.000     10.38513    10.99972
               2-5 years ago  |   3.492868   .0459488    95.08   0.000     3.403961    3.584097
                    5+ years  |   1.560234   .0170801    40.63   0.000     1.527114    1.594072
                              |
              cancer_haem_cat |
                   Last year  |   4.996751   .2411433    33.34   0.000     4.545783    5.492457
               2-5 years ago  |   2.586247   .0918957    26.74   0.000     2.412264    2.772779
                    5+ years  |    1.68099   .0490536    17.80   0.000     1.587544    1.779936
                              |
      1.chronic_liver_disease |   3.340314   .0771237    52.24   0.000     3.192523    3.494946
            1.stroke_dementia |   1.817345   .0179143    60.60   0.000     1.782571    1.852798
                1.other_neuro |   2.551232   .0434862    54.95   0.000     2.467408    2.637903
                              |
  reduced_kidney_function_cat |
Stage 3a/3b egfr 30-60        |   1.149435   .0100116    15.99   0.000     1.129979    1.169226
           Stage 4/5 egfr<30  |   2.611928   .0406932    61.62   0.000     2.533376    2.692916
                              |
           1.organ_transplant |   1.851184   .1157296     9.85   0.000     1.637704    2.092492
                     1.spleen |   1.563713   .0842736     8.30   0.000     1.406964    1.737925
           1.ra_sle_psoriasis |   1.108592   .0145009     7.88   0.000     1.080532     1.13738
    1.other_immunosuppression |   2.300594   .1200972    15.96   0.000     2.076849    2.548444
                        _cons |   3.46e-07   7.88e-08   -65.30   0.000     2.21e-07    5.41e-07
-----------------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
. estimates save ./output/models/an_covidvsnoncovid_full_fail2_agespline_bmicat_noeth, replace
file ./output/models/an_covidvsnoncovid_full_fail2_agespline_bmicat_noeth.ster saved
. *estat concordance /*c-statistic*/
. }

. else di "WARNING AGE SPLINE MODEL DID NOT FIT (OUTCOME `outcome')"

.  
. *Age group model (not adj ethnicity)
. baselogistic, age("ib3.agegroup") bp("i.htdiag_or_highbp") ethnicity(0)

. if _rc==0{
. estimates

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(38)       =  272957.08
                                                Prob > chi2       =     0.0000
Log likelihood = -390144.82                     Pseudo R2         =     0.2592

-----------------------------------------------------------------------------------------------
                           _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------------+----------------------------------------------------------------
                     agegroup |
                      18-<40  |   .0915857   .0038291   -57.18   0.000     .0843801    .0994066
                      40-<50  |   .4284439   .0126034   -28.81   0.000     .4044404     .453872
                      60-<70  |   2.263335   .0419582    44.06   0.000     2.182574    2.347084
                      70-<80  |   4.692714   .0818813    88.60   0.000     4.534943    4.855974
                         80+  |   16.44103   .2857931   161.06   0.000     15.89032    17.01082
                              |
                       1.male |   .9904609   .0073522    -1.29   0.197     .9761552    1.004976
                              |
                    obese4cat |
           Obese I (30-34.9)  |   .6693216   .0073985   -36.32   0.000     .6549767    .6839806
          Obese II (35-39.9)  |   .7720201   .0133234   -14.99   0.000     .7463433    .7985802
             Obese III (40+)  |    1.01537   .0243861     0.64   0.525     .9686813    1.064308
                              |
                 smoke_nomiss |
                      Former  |   1.138261    .009368    15.74   0.000     1.120048    1.156771
                     Current  |   1.743745   .0216529    44.78   0.000     1.701818    1.786704
                              |
                          imd |
                           2  |   1.085049   .0123216     7.19   0.000     1.061166     1.10947
                           3  |   1.163984   .0131644    13.43   0.000     1.138466    1.190074
                           4  |   1.286605   .0147484    21.98   0.000     1.258021    1.315838
             5 most deprived  |   1.435881   .0168555    30.82   0.000     1.403222      1.4693
                              |
           1.htdiag_or_highbp |   1.011875   .0086499     1.38   0.167     .9950628    1.028971
1.chronic_respiratory_disease |   1.772158   .0166973    60.73   0.000     1.739732    1.805188
                              |
                    asthmacat |
                 Yes, no OCS  |   .8981769   .0106412    -9.06   0.000     .8775608    .9192774
                Yes with OCS  |   .8690053   .0202467    -6.03   0.000      .830215    .9096081
                              |
    1.chronic_cardiac_disease |   1.493292   .0121941    49.10   0.000     1.469582    1.517385
                              |
                      diabcat |
         Controlled diabetes  |   1.076771   .0106332     7.49   0.000     1.056131    1.097815
       Uncontrolled diabetes  |   1.348974    .018763    21.52   0.000     1.312696    1.386255
  Diabetes, no hba1c measure  |   1.883254   .0376154    31.69   0.000     1.810954    1.958441
                              |
            cancer_exhaem_cat |
                   Last year  |   10.29863   .1499547   160.16   0.000     10.00888    10.59677
               2-5 years ago  |   3.389922   .0443462    93.32   0.000     3.304109    3.477962
                    5+ years  |   1.597819    .017412    43.00   0.000     1.564054    1.632313
                              |
              cancer_haem_cat |
                   Last year  |   4.758557   .2283098    32.51   0.000     4.331473    5.227751
               2-5 years ago  |   2.440137    .086507    25.16   0.000     2.276343    2.615717
                    5+ years  |   1.649732   .0478855    17.25   0.000     1.558498    1.746307
                              |
      1.chronic_liver_disease |   3.120222   .0718755    49.40   0.000     2.982482    3.264324
            1.stroke_dementia |   1.970821    .019321    69.20   0.000     1.933314    2.009055
                1.other_neuro |   2.443034   .0414254    52.68   0.000     2.363176    2.525591
                              |
  reduced_kidney_function_cat |
Stage 3a/3b egfr 30-60        |   1.379699   .0118034    37.62   0.000     1.356757    1.403028
           Stage 4/5 egfr<30  |   3.428908   .0525659    80.38   0.000     3.327414    3.533499
                              |
           1.organ_transplant |   1.505894   .0939472     6.56   0.000     1.332573    1.701758
                     1.spleen |   1.504304   .0806479     7.62   0.000     1.354258    1.670974
           1.ra_sle_psoriasis |   1.076841   .0140285     5.68   0.000     1.049694    1.104691
    1.other_immunosuppression |   2.135702   .1113366    14.56   0.000     1.928264    2.365455
                        _cons |   .0008614   .0000158  -384.12   0.000     .0008309     .000893
-----------------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
. estimates save ./output/models/an_covidvsnoncovid_full_fail2_agegroup_bmicat_noeth, replace
file ./output/models/an_covidvsnoncovid_full_fail2_agegroup_bmicat_noeth.ster saved
. *estat concordance /*c-statistic*/
. }

. else di "WARNING GROUP MODEL DID NOT FIT (OUTCOME `outcome')"

. 
. *Complete case ethnicity model
. baselogistic, age("age1 age2 age3") bp("i.htdiag_or_highbp") ethnicity(1)

. if _rc==0{
. estimates

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 12,783,591
                                                LR chi2(40)       =  207973.47
                                                Prob > chi2       =     0.0000
Log likelihood = -271325.19                     Pseudo R2         =     0.2771

-----------------------------------------------------------------------------------------------
                           _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------------+----------------------------------------------------------------
                         age1 |   1.213322   .0097197    24.14   0.000     1.194421    1.232523
                         age2 |   .7466411    .013209   -16.52   0.000     .7211957    .7729843
                         age3 |   2.140164   .0882325    18.46   0.000     1.974033    2.320275
                       1.male |   1.090373   .0097351     9.69   0.000     1.071459    1.109622
                              |
                    obese4cat |
           Obese I (30-34.9)  |   .7348578   .0095757   -23.64   0.000     .7163274    .7538675
          Obese II (35-39.9)  |   .8843312   .0178436    -6.09   0.000      .850041    .9200047
             Obese III (40+)  |   1.188508   .0334481     6.14   0.000     1.124727    1.255907
                              |
                 smoke_nomiss |
                      Former  |   1.135118   .0113428    12.68   0.000     1.113103    1.157568
                     Current  |   1.921371   .0287026    43.71   0.000      1.86593    1.978458
                              |
                    ethnicity |
                       Mixed  |   .7236779   .0537336    -4.36   0.000     .6256666    .8370427
      Asian or Asian British  |   .7640742   .0196121   -10.48   0.000     .7265861    .8034965
                       Black  |   .7560861    .031115    -6.79   0.000     .6974965    .8195972
                       Other  |   .6404524   .0362341    -7.88   0.000     .5732307    .7155572
                              |
                          imd |
                           2  |   1.105301   .0153686     7.20   0.000     1.075586    1.135837
                           3  |   1.180064   .0163322    11.96   0.000     1.148484    1.212513
                           4  |   1.325791   .0184277    20.29   0.000      1.29016    1.362405
             5 most deprived  |   1.519334   .0213626    29.75   0.000     1.478036    1.561787
                              |
           1.htdiag_or_highbp |   .9737209   .0100075    -2.59   0.010     .9543028    .9935342
1.chronic_respiratory_disease |   1.803703   .0199016    53.46   0.000     1.765115    1.843134
                              |
                    asthmacat |
                 Yes, no OCS  |   .9448281   .0130338    -4.11   0.000     .9196245    .9707224
                Yes with OCS  |   .9071707   .0244215    -3.62   0.000     .8605464    .9563212
                              |
    1.chronic_cardiac_disease |   1.411946   .0137055    35.54   0.000     1.385338    1.439066
                              |
                      diabcat |
         Controlled diabetes  |   1.146905   .0133619    11.76   0.000     1.121012    1.173395
       Uncontrolled diabetes  |   1.511342   .0246396    25.33   0.000     1.463813    1.560415
  Diabetes, no hba1c measure  |   1.895738   .0446792    27.14   0.000      1.81016    1.985362
                              |
            cancer_exhaem_cat |
                   Last year  |   10.85902   .1872916   138.28   0.000     10.49807    11.23238
               2-5 years ago  |   3.525517   .0549097    80.90   0.000     3.419522    3.634797
                    5+ years  |   1.557539   .0203525    33.91   0.000     1.518155    1.597944
                              |
              cancer_haem_cat |
                   Last year  |   4.856321   .2813317    27.28   0.000     4.335073    5.440244
               2-5 years ago  |   2.611437   .1102562    22.74   0.000     2.404038    2.836728
                    5+ years  |   1.646901   .0575617    14.27   0.000     1.537859    1.763673
                              |
      1.chronic_liver_disease |   3.297862    .088453    44.49   0.000     3.128975    3.475864
            1.stroke_dementia |   1.822127   .0212643    51.41   0.000     1.780923    1.864285
                1.other_neuro |   2.560827   .0513572    46.89   0.000     2.462121     2.66349
                              |
  reduced_kidney_function_cat |
Stage 3a/3b egfr 30-60        |   1.140223    .011913    12.56   0.000     1.117111    1.163812
           Stage 4/5 egfr<30  |    2.63216   .0487716    52.23   0.000     2.538284    2.729507
                              |
           1.organ_transplant |    1.69692   .1302679     6.89   0.000     1.459879    1.972449
                     1.spleen |   1.516359   .0965911     6.54   0.000     1.338385       1.718
           1.ra_sle_psoriasis |   1.111304   .0170782     6.87   0.000      1.07833    1.145285
    1.other_immunosuppression |   2.345553   .1413539    14.15   0.000     2.084241    2.639627
                        _cons |   1.85e-07   5.35e-08   -53.62   0.000     1.05e-07    3.26e-07
-----------------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
. estimates save ./output/models/an_covidvsnoncovid_full_fail2_agespline_bmicat_CCeth, replace
file ./output/models/an_covidvsnoncovid_full_fail2_agespline_bmicat_CCeth.ster saved
. *estat concordance /*c-statistic*/
.  }

.  else di "WARNING CC ETHNICITY MODEL WITH AGESPLINE DID NOT FIT (OUTCOME `outcome')"

.  
.  *** 
.  
.  log close
      name:  <unnamed>
       log:  e:\analyses\covid-vs-noncovid-deaths-research\analysis\output/an_covidvsnoncovid_full.log
  log type:  text
 closed on:  10 Sep 2020, 02:22:06
----------------------------------------------------------------------------------------------------------------------------------
