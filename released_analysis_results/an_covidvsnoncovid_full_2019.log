------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  e:\analyses\covid-vs-noncovid-deaths-research\analysis/output/an_covidvsnoncovid_full_2019.log
  log type:  text
 opened on:  14 Dec 2020, 18:55:12

. 
. use  ./analysis/cr_create_analysis_dataset_`1'_STSET.dta, clear

. 
. `check'

.         
. `genoutput1'

. `genoutput2'

.         
. foreach outcome of local outcomes{
  2.         tab `outcome'
  3. }

primarycare |
      death |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 | 17,132,364       99.25       99.25
          1 |    129,364        0.75      100.00
------------+-----------------------------------
      Total | 17,261,728      100.00

.         
. **MULTIVARIATE
. cap prog drop baselogistic 

. prog define baselogistic
  1.         syntax , outcome(string) age(string) bp(string) [ethnicity(real 0) if(string)] 
  2. 
.         if `ethnicity'==1 local ethnicity "i.ethnicity"
  3.         else local ethnicity
  4. 
. cap logistic `outcome' `age'                    ///
>                         i.male                                                  ///
>                         i.obese4cat                                             ///
>                         i.smoke_nomiss                                  ///
>                         `ethnicity'                                             ///
>                         i.imd                                                   ///
>                         `bp'                                                    ///
>                         i.chronic_respiratory_disease   ///
>                         i.asthmacat                                             ///
>                         i.chronic_cardiac_disease               ///
>                         i.diabcat                                               ///
>                         i.cancer_exhaem_cat                             ///
>                         i.cancer_haem_cat                               ///
>                         i.chronic_liver_disease                 ///
>                         i.stroke                                                ///     
>                         i.dementia                                              ///
>                         i.other_neuro                                   ///
>                         i.reduced_kidney_function_cat2  ///
>                         i.organ_transplant                              ///
>                         i.spleen                                                ///
>                         i.ra_sle_psoriasis                      ///
>                         i.other_immunosuppression
  5.                         
. end                     

. 
. foreach outcome of local outcomes{
  2.         baselogistic, outcome(`outcome') age("age1 age2 age3")  bp("i.htdiag_or_highbp") ethnicity(0)
  3.         if _rc==0{
  4.         estimates
  5.         estimates save ./analysis/output/models/an_covidvsnoncovid_full_`1'_`outcome'_agespline_bmicat_noeth, replace
  6.         }
  7.         else di "WARNING AGE SPLINE MODEL DID NOT FIT (OUTCOME `outcome')"
  8.          
.         *Age group model (not adj ethnicity)
.         baselogistic, outcome(`outcome') age("ib3.agegroup") bp("i.htdiag_or_highbp") ethnicity(0)
  9.         if _rc==0{
 10.         estimates
 11.         estimates save ./analysis/output/models/an_covidvsnoncovid_full_`1'_`outcome'_agegroup_bmicat_noeth, replace
 12.         }
 13.         else di "WARNING GROUP MODEL DID NOT FIT (OUTCOME `outcome')"
 14. 
.         *Complete case ethnicity model
.         baselogistic, outcome(`outcome') age("age1 age2 age3") bp("i.htdiag_or_highbp") ethnicity(1)
 15.         if _rc==0{
 16.         estimates
 17.         estimates save ./analysis/output/models/an_covidvsnoncovid_full_`1'_`outcome'_agespline_bmicat_CCeth, replace
 18.          }
 19.          else di "WARNING CC ETHNICITY MODEL WITH AGESPLINE DID NOT FIT (OUTCOME `outcome')"
 20. } 

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
active results
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,261,728
                                                LR chi2(38)       =  426572.16
                                                Prob > chi2       =     0.0000
Log likelihood = -548649.82                     Pseudo R2         =     0.2799

-----------------------------------------------------------------------------------------------
             primarycaredeath | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------------+----------------------------------------------------------------
                         age1 |   1.105303   .0035763    30.94   0.000     1.098316    1.112334
                         age2 |   .8900781   .0068318   -15.17   0.000     .8767881    .9035694
                         age3 |   1.459174   .0273347    20.17   0.000      1.40657    1.513744
                       1.male |   1.123555   .0068531    19.10   0.000     1.110203    1.137068
                              |
                    obese4cat |
           Obese I (30-34.9)  |   .7667055   .0069483   -29.31   0.000     .7532073    .7804456
          Obese II (35-39.9)  |   .8998752   .0127533    -7.44   0.000     .8752231    .9252217
             Obese III (40+)  |   1.229549   .0240356    10.57   0.000     1.183331    1.277572
                              |
                 smoke_nomiss |
                      Former  |   1.174252    .007962    23.69   0.000      1.15875    1.189961
                     Current  |   2.119146   .0209064    76.13   0.000     2.078564    2.160521
                              |
                          imd |
                           2  |   1.074345   .0099903     7.71   0.000     1.054942    1.094105
                           3  |   1.145035     .01061    14.62   0.000     1.124428     1.16602
                           4  |   1.255707   .0118078    24.21   0.000     1.232776    1.279064
             5 most deprived  |   1.395596   .0132588    35.08   0.000      1.36985    1.421826
                              |
           1.htdiag_or_highbp |   .9713728   .0067553    -4.18   0.000     .9582224    .9847037
1.chronic_respiratory_disease |   1.955363   .0150158    87.32   0.000     1.926152    1.985016
                              |
                    asthmacat |
                 Yes, no OCS  |   .9522777   .0091129    -5.11   0.000     .9345833    .9703072
                Yes with OCS  |   .9332509   .0178106    -3.62   0.000     .8989875    .9688201
                              |
    1.chronic_cardiac_disease |   1.480823   .0099197    58.61   0.000     1.461508    1.500394
                              |
                      diabcat |
         Controlled diabetes  |   1.142025     .00934    16.24   0.000     1.123865    1.160479
       Uncontrolled diabetes  |   1.507109   .0176071    35.11   0.000     1.472992    1.542017
  Diabetes, no hba1c measure  |   1.688689   .0289912    30.52   0.000     1.632813    1.746478
                              |
            cancer_exhaem_cat |
                   Last year  |   10.36515   .1304244   185.84   0.000     10.11265    10.62395
               2-5 years ago  |   3.500843   .0385533   113.78   0.000      3.42609    3.577228
                    5+ years  |   1.580588   .0144079    50.22   0.000       1.5526    1.609081
                              |
              cancer_haem_cat |
                   Last year  |   4.580094   .1920903    36.28   0.000     4.218663    4.972491
               2-5 years ago  |   2.490001   .0766396    29.64   0.000     2.344231    2.644835
                    5+ years  |   1.857108   .0443822    25.90   0.000     1.772126    1.946165
                              |
      1.chronic_liver_disease |   3.698017   .0701997    68.89   0.000     3.562956    3.838198
                     1.stroke |   1.483453    .013314    43.94   0.000     1.457586    1.509779
                   1.dementia |   2.797675   .0430201    66.90   0.000     2.714615    2.883276
                1.other_neuro |   2.642087   .0375288    68.40   0.000     2.569547    2.716676
                              |
 reduced_kidney_function_cat2 |
Stage 3a/3b egfr 30-60        |   1.150807   .0082526    19.59   0.000     1.134745    1.167096
         Stage 4 egfr 15-<30  |   2.204863   .0325459    53.56   0.000     2.141988    2.269583
Stage 5 egfr <15 or dialysis  |   5.996279   .1537372    69.86   0.000     5.702405    6.305297
                              |
           1.organ_transplant |   .9040966   .0462807    -1.97   0.049     .8177901    .9995116
                     1.spleen |   1.556699   .0693397     9.94   0.000     1.426559    1.698711
           1.ra_sle_psoriasis |   1.137024   .0121409    12.03   0.000     1.113475     1.16107
    1.other_immunosuppression |   2.232356   .0978697    18.32   0.000     2.048545     2.43266
                        _cons |   .0000116   1.29e-06  -101.95   0.000     9.33e-06    .0000144
-----------------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
(note: file ./analysis/output/models/an_covidvsnoncovid_full_2019_primarycaredeath_agespline_bmicat_noeth.ster not found)
file ./analysis/output/models/an_covidvsnoncovid_full_2019_primarycaredeath_agespline_bmicat_noeth.ster saved

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
active results
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,261,728
                                                LR chi2(40)       =  401597.25
                                                Prob > chi2       =     0.0000
Log likelihood = -561137.28                     Pseudo R2         =     0.2635

-----------------------------------------------------------------------------------------------
             primarycaredeath | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------------+----------------------------------------------------------------
                     agegroup |
                      18-<40  |   .1740459   .0042424   -71.73   0.000     .1659265    .1825627
                      40-<50  |   .4833478   .0102568   -34.26   0.000     .4636571    .5038747
                      60-<70  |   2.062017   .0293079    50.92   0.000     2.005367    2.120267
                      70-<80  |   4.216153   .0565083   107.36   0.000     4.106841    4.328375
                         80+  |   14.41711   .1934238   198.89   0.000     14.04295    14.80125
                              |
                       1.male |   1.046306   .0063032     7.51   0.000     1.034025    1.058733
                              |
                    obese4cat |
           Obese I (30-34.9)  |   .6962892   .0062659   -40.23   0.000     .6841158    .7086792
          Obese II (35-39.9)  |   .7906439    .011155   -16.65   0.000     .7690801    .8128124
             Obese III (40+)  |    1.04803   .0204413     2.41   0.016     1.008722    1.088869
                              |
                 smoke_nomiss |
                      Former  |   1.170551   .0078892    23.37   0.000      1.15519    1.186116
                     Current  |   1.916856   .0187006    66.70   0.000     1.880552    1.953862
                              |
                          imd |
                           2  |   1.074785   .0099371     7.80   0.000     1.055484    1.094439
                           3  |   1.146693   .0105643    14.86   0.000     1.126173    1.167587
                           4  |   1.253928   .0117296    24.19   0.000     1.231148    1.277129
             5 most deprived  |   1.381089   .0130613    34.14   0.000     1.355725    1.406927
                              |
           1.htdiag_or_highbp |   1.021847   .0070793     3.12   0.002     1.008066    1.035817
1.chronic_respiratory_disease |   1.928419    .014764    85.78   0.000     1.899698    1.957574
                              |
                    asthmacat |
                 Yes, no OCS  |   .9254419   .0088113    -8.14   0.000     .9083321    .9428739
                Yes with OCS  |   .9015743   .0171466    -5.45   0.000     .8685862    .9358152
                              |
    1.chronic_cardiac_disease |   1.561915   .0104441    66.69   0.000     1.541578    1.582519
                              |
                      diabcat |
         Controlled diabetes  |   1.103665   .0090066    12.09   0.000     1.086153     1.12146
       Uncontrolled diabetes  |   1.391932   .0162194    28.38   0.000     1.360503    1.424087
  Diabetes, no hba1c measure  |   1.737664   .0296079    32.43   0.000     1.680592    1.796675
                              |
            cancer_exhaem_cat |
                   Last year  |   10.04898   .1256255   184.58   0.000     9.805749    10.29824
               2-5 years ago  |   3.421932   .0374713   112.34   0.000     3.349272    3.496168
                    5+ years  |   1.621304   .0147018    53.29   0.000     1.592743    1.650376
                              |
              cancer_haem_cat |
                   Last year  |   4.358011   .1821202    35.22   0.000     4.015289    4.729986
               2-5 years ago  |   2.366635   .0726627    28.06   0.000     2.228419    2.513423
                    5+ years  |   1.828304    .043464    25.38   0.000      1.74507    1.915507
                              |
      1.chronic_liver_disease |   3.480045   .0659372    65.82   0.000     3.353181    3.611709
                     1.stroke |   1.567395   .0140098    50.28   0.000     1.540176    1.595096
                   1.dementia |   3.161014   .0483247    75.28   0.000     3.067704    3.257162
                1.other_neuro |   2.552778   .0360842    66.30   0.000     2.483025     2.62449
                              |
 reduced_kidney_function_cat2 |
Stage 3a/3b egfr 30-60        |   1.364442   .0096204    44.07   0.000     1.345716    1.383428
         Stage 4 egfr 15-<30  |   2.927635   .0425651    73.88   0.000     2.845386    3.012261
Stage 5 egfr <15 or dialysis  |   6.406676   .1627956    73.09   0.000     6.095418    6.733828
                              |
           1.organ_transplant |   .7823604   .0400217    -4.80   0.000     .7077235    .8648685
                     1.spleen |   1.499148   .0664652     9.13   0.000     1.374379    1.635245
           1.ra_sle_psoriasis |      1.108   .0117818     9.64   0.000     1.085147    1.131334
    1.other_immunosuppression |   2.086874    .091191    16.84   0.000     1.915583    2.273482
                        _cons |   .0014182   .0000202  -459.82   0.000     .0013791    .0014584
-----------------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
(note: file ./analysis/output/models/an_covidvsnoncovid_full_2019_primarycaredeath_agegroup_bmicat_noeth.ster not found)
file ./analysis/output/models/an_covidvsnoncovid_full_2019_primarycaredeath_agegroup_bmicat_noeth.ster saved

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
active results
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 12,867,303
                                                LR chi2(42)       =  301416.01
                                                Prob > chi2       =     0.0000
Log likelihood = -389925.77                     Pseudo R2         =     0.2788

-----------------------------------------------------------------------------------------------
             primarycaredeath | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------------+----------------------------------------------------------------
                         age1 |   1.114187   .0044837    26.87   0.000     1.105433    1.123009
                         age2 |   .8661083   .0081529   -15.27   0.000     .8502755     .882236
                         age3 |   1.568102   .0358338    19.69   0.000     1.499419    1.639932
                       1.male |   1.137515   .0082706    17.72   0.000      1.12142    1.153841
                              |
                    obese4cat |
           Obese I (30-34.9)  |   .7662576   .0081306   -25.09   0.000     .7504865    .7823601
          Obese II (35-39.9)  |   .8801435   .0146615    -7.66   0.000     .8518715    .9093539
             Obese III (40+)  |   1.204455   .0275658     8.13   0.000     1.151621    1.259714
                              |
                 smoke_nomiss |
                      Former  |   1.162944   .0095531    18.38   0.000      1.14437     1.18182
                     Current  |   2.075676   .0245051    61.86   0.000     2.028199    2.124266
                              |
                    ethnicity |
                       Mixed  |   .7817326   .0447013    -4.31   0.000     .6988508    .8744439
      Asian or Asian British  |    .706715   .0152109   -16.13   0.000     .6775222    .7371656
                       Black  |   .6330751   .0228565   -12.66   0.000     .5898255    .6794961
                       Other  |   .6013279   .0283237   -10.80   0.000     .5482997    .6594845
                              |
                          imd |
                           2  |   1.083888   .0122897     7.10   0.000     1.060066    1.108245
                           3  |   1.164847   .0131344    13.53   0.000     1.139387    1.190877
                           4  |    1.30086   .0147562    23.19   0.000     1.272257    1.330106
             5 most deprived  |   1.465819   .0166811    33.60   0.000     1.433486     1.49888
                              |
           1.htdiag_or_highbp |   .9751161   .0081316    -3.02   0.003      .959308    .9911848
1.chronic_respiratory_disease |   1.978319   .0177626    75.99   0.000      1.94381    2.013441
                              |
                    asthmacat |
                 Yes, no OCS  |   .9669133   .0108033    -3.01   0.003     .9459694    .9883209
                Yes with OCS  |   .9233676   .0205185    -3.59   0.000     .8840152    .9644717
                              |
    1.chronic_cardiac_disease |   1.493145   .0118988    50.31   0.000     1.470005    1.516649
                              |
                      diabcat |
         Controlled diabetes  |    1.17846   .0113744    17.01   0.000     1.156376    1.200965
       Uncontrolled diabetes  |   1.560545   .0214035    32.45   0.000     1.519154    1.603064
  Diabetes, no hba1c measure  |   1.765511   .0356333    28.16   0.000     1.697034    1.836751
                              |
            cancer_exhaem_cat |
                   Last year  |   10.52742   .1562621   158.59   0.000     10.22557    10.83819
               2-5 years ago  |   3.541846   .0461971    96.96   0.000     3.452449    3.633558
                    5+ years  |   1.584014   .0172609    42.21   0.000     1.550542    1.618208
                              |
              cancer_haem_cat |
                   Last year  |    4.85842   .2384219    32.21   0.000     4.412891    5.348929
               2-5 years ago  |   2.511988   .0916202    25.25   0.000     2.338684    2.698134
                    5+ years  |   1.815292   .0520923    20.78   0.000     1.716012    1.920317
                              |
      1.chronic_liver_disease |    3.74239   .0819423    60.27   0.000     3.585184     3.90649
                     1.stroke |   1.497065   .0159092    37.97   0.000     1.466206    1.528574
                   1.dementia |   2.864369   .0518887    58.09   0.000     2.764453    2.967896
                1.other_neuro |   2.565401   .0435224    55.53   0.000     2.481502    2.652138
                              |
 reduced_kidney_function_cat2 |
Stage 3a/3b egfr 30-60        |   1.150918   .0099143    16.32   0.000      1.13165    1.170515
         Stage 4 egfr 15-<30  |   2.205056   .0389665    44.75   0.000     2.129991    2.282767
Stage 5 egfr <15 or dialysis  |   6.339226    .191409    61.16   0.000     5.974956    6.725704
                              |
           1.organ_transplant |   .8780839    .053394    -2.14   0.033     .7794291    .9892258
                     1.spleen |   1.567321   .0817661     8.61   0.000     1.414983    1.736059
           1.ra_sle_psoriasis |    1.14073   .0143487    10.47   0.000     1.112951    1.169202
    1.other_immunosuppression |    2.26937   .1156246    16.08   0.000     2.053697    2.507691
                        _cons |   9.01e-06   1.26e-06   -83.24   0.000     6.86e-06    .0000118
-----------------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
(note: file ./analysis/output/models/an_covidvsnoncovid_full_2019_primarycaredeath_agespline_bmicat_CCeth.ster not found)
file ./analysis/output/models/an_covidvsnoncovid_full_2019_primarycaredeath_agespline_bmicat_CCeth.ster saved

. 
end of do-file

. exit, clear
