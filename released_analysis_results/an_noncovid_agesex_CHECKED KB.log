----------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  e:\analyses\covid-vs-noncovid-deaths-research\analysis\output/an_noncovid_agesex.log
  log type:  text
 opened on:  10 Sep 2020, 01:11:15

. 
.         cap prog drop baselogistic 

.         prog define baselogistic
  1.                 syntax , age(string) addvariable(string)
  2. 
.                 cap logistic _d `age'                   ///
>                                         i.male                          ///
>                                         i.`addvariable'                 
  3.         end                     

. 
. foreach year of numlist 2019 2020{
  2.         if `year'==2019 use cr_create_analysis_dataset_2019, clear
  3.         else if `year'==2020 use cr_create_analysis_dataset, clear
  4.         
.         stset stime_primarycaredeath, fail(primarycaredeath) id(patient_id) enter(enter_date) origin(enter_date)
  5. 
.         foreach addvariable of any asthmacat    ///
>                         cancer_exhaem_cat                                       ///
>                         cancer_haem_cat                                         ///
>                         chronic_cardiac_disease                         ///
>                         reduced_kidney_function_cat                     ///
>                         dialysis                                                        ///
>                         chronic_liver_disease                           ///
>                         chronic_respiratory_disease             ///
>                         diabcat                                                         ///
>                         ethnicity                                                       ///
>                         htdiag_or_highbp                                        ///
>                          bpcat                                                          ///
>                          hypertension                                           ///
>                         imd                                                             ///
>                         obese4cat                                                       ///
>                          bmicat                                                         ///
>                         organ_transplant                                        ///
>                         other_immunosuppression                         ///
>                         other_neuro                                             ///
>                         ra_sle_psoriasis                                        ///  
>                         smoke                                                           ///
>                         smoke_nomiss                                            ///
>                         spleen                                                          ///
>                         stroke_dementia {
  6.                                 baselogistic, age("age1 age2 age3")  addvariable("i.`addvariable'") 
  7.                                 if _rc==0{
  8.                                 estimates
  9.                                 estimates save ./output/models/an_noncovid_`year'_agesex_`addvariable', replace
 10.                                 }
 11.                         else di "MODEL DID NOT FIT (adding `addvariable')"
 12.          }
 13. 
.          cap logistic _d age1 age2 age3 i.male
 14.                                 if _rc==0{
 15.                                 estimates
 16.                                 estimates save ./output/models/an_noncovid_`year'_agesex_SEX, replace
 17.                         }
 18.          cap logistic _d i.agegroup i.male
 19.                                 if _rc==0{
 20.                                 estimates
 21.                                 estimates save ./output/models/an_noncovid_`year'_agesex_AGEGROUP, replace
 22.                         }
 23.          
. }
(covid vs non covid 2019)

                id:  patient_id
     failure event:  primarycaredeath != 0 & primarycaredeath < .
obs. time interval:  (stime_primarycaredeath[_n-1], stime_primarycaredeath]
 enter on or after:  time enter_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time enter_date

------------------------------------------------------------------------------
   17357709  total observations
     20,197  observations end on or before enter()
------------------------------------------------------------------------------
   17337512  observations remaining, representing
   17337512  subjects
     68,616  failures in single-failure-per-subject data
 3.0453e+09  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =       176

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,337,512
                                                LR chi2(6)        =  178189.30
                                                Prob > chi2       =     0.0000
Log likelihood =  -358976.1                     Pseudo R2         =     0.1988

-------------------------------------------------------------------------------
           _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
--------------+----------------------------------------------------------------
         age1 |   1.083965   .0045495    19.21   0.000     1.075084    1.092918
         age2 |   .9701888   .0097463    -3.01   0.003     .9512732    .9894804
         age3 |   1.159757   .0275197     6.25   0.000     1.107054    1.214968
       1.male |   1.381289   .0108264    41.21   0.000     1.360232    1.402672
              |
    asthmacat |
 Yes, no OCS  |    1.06945   .0133172     5.39   0.000     1.043665    1.095872
Yes with OCS  |   1.039274   .0283087     1.41   0.157     .9852449    1.096266
              |
        _cons |   .0000142   2.06e-06   -77.02   0.000     .0000107    .0000189
-------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
(note: file ./output/models/an_noncovid_2019_agesex_asthmacat.ster not found)
file ./output/models/an_noncovid_2019_agesex_asthmacat.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,337,512
                                                LR chi2(7)        =  203939.72
                                                Prob > chi2       =     0.0000
Log likelihood = -346100.89                     Pseudo R2         =     0.2276

-----------------------------------------------------------------------------------
               _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
             age1 |   1.101811   .0047644    22.42   0.000     1.092512    1.111188
             age2 |   .9039566   .0092955    -9.82   0.000     .8859201    .9223602
             age3 |   1.393234   .0337604    13.69   0.000     1.328612       1.461
           1.male |    1.26144   .0099617    29.41   0.000     1.242066    1.281117
                  |
cancer_exhaem_cat |
       Last year  |   6.908593   .1151748   115.93   0.000     6.686503     7.13806
   2-5 years ago  |   6.099279    .070738   155.91   0.000     5.962199    6.239511
        5+ years  |   1.779019   .0208482    49.16   0.000     1.738623    1.820353
                  |
            _cons |   9.45e-06   1.42e-06   -77.25   0.000     7.05e-06    .0000127
-----------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
(note: file ./output/models/an_noncovid_2019_agesex_cancer_exhaem_cat.ster not found)
file ./output/models/an_noncovid_2019_agesex_cancer_exhaem_cat.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,337,512
                                                LR chi2(7)        =  180130.62
                                                Prob > chi2       =     0.0000
Log likelihood = -358005.44                     Pseudo R2         =     0.2010

---------------------------------------------------------------------------------
             _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
----------------+----------------------------------------------------------------
           age1 |   1.085501   .0045677    19.50   0.000     1.076586    1.094491
           age2 |   .9641544   .0097045    -3.63   0.000     .9453204    .9833637
           age3 |   1.178436   .0280104     6.91   0.000     1.124796    1.234634
         1.male |    1.36507   .0106984    39.71   0.000     1.344261      1.3862
                |
cancer_haem_cat |
     Last year  |   3.787636   .2062414    24.46   0.000     3.404232     4.21422
 2-5 years ago  |    3.59619    .118907    38.71   0.000     3.370527     3.83696
      5+ years  |   2.044963   .0594466    24.61   0.000     1.931707    2.164859
                |
          _cons |   .0000139   2.02e-06   -76.97   0.000     .0000104    .0000185
---------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
(note: file ./output/models/an_noncovid_2019_agesex_cancer_haem_cat.ster not found)
file ./output/models/an_noncovid_2019_agesex_cancer_haem_cat.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,337,512
                                                LR chi2(5)        =  183473.35
                                                Prob > chi2       =     0.0000
Log likelihood = -356334.08                     Pseudo R2         =     0.2047

-------------------------------------------------------------------------------------------
                       _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
--------------------------+----------------------------------------------------------------
                     age1 |   1.087019   .0045847    19.78   0.000     1.078071    1.096042
                     age2 |   .9569468   .0096533    -4.36   0.000     .9382125    .9760551
                     age3 |   1.189235   .0283263     7.28   0.000     1.134993     1.24607
                   1.male |   1.279727   .0101213    31.19   0.000     1.260043    1.299719
1.chronic_cardiac_disease |   1.880225   .0159169    74.58   0.000     1.849285    1.911682
                    _cons |   .0000138   2.01e-06   -76.81   0.000     .0000104    .0000184
-------------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
(note: file ./output/models/an_noncovid_2019_agesex_chronic_cardiac_disease.ster not found)
file ./output/models/an_noncovid_2019_agesex_chronic_cardiac_disease.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,337,512
                                                LR chi2(6)        =  183103.55
                                                Prob > chi2       =     0.0000
Log likelihood = -356518.98                     Pseudo R2         =     0.2043

-----------------------------------------------------------------------------------------------
                           _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------------+----------------------------------------------------------------
                         age1 |   1.077685   .0044828    17.99   0.000     1.068935    1.086507
                         age2 |    .991197   .0099039    -0.88   0.376     .9719746      1.0108
                         age3 |   1.081392   .0255705     3.31   0.001     1.032418    1.132689
                       1.male |   1.360215     .01067    39.22   0.000     1.339462    1.381289
                              |
  reduced_kidney_function_cat |
Stage 3a/3b egfr 30-60        |    1.22853   .0116392    21.72   0.000     1.205928    1.251555
           Stage 4/5 egfr<30  |   3.267212   .0498465    77.60   0.000     3.170961    3.366385
                              |
                        _cons |   .0000171   2.45e-06   -76.55   0.000     .0000129    .0000226
-----------------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
(note: file ./output/models/an_noncovid_2019_agesex_reduced_kidney_function_cat.ster not found)
file ./output/models/an_noncovid_2019_agesex_reduced_kidney_function_cat.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,337,512
                                                LR chi2(5)        =  179566.94
                                                Prob > chi2       =     0.0000
Log likelihood = -358287.28                     Pseudo R2         =     0.2004

------------------------------------------------------------------------------
          _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        age1 |   1.084129   .0045526    19.24   0.000     1.075243    1.093088
        age2 |   .9682784    .009731    -3.21   0.001     .9493926    .9875399
        age3 |   1.166617   .0276923     6.49   0.000     1.113584    1.222175
      1.male |   1.370576   .0107396    40.23   0.000     1.349688    1.391788
  1.dialysis |    5.67029   .2118228    46.45   0.000      5.26996    6.101032
       _cons |   .0000144   2.08e-06   -76.92   0.000     .0000108    .0000191
------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
(note: file ./output/models/an_noncovid_2019_agesex_dialysis.ster not found)
file ./output/models/an_noncovid_2019_agesex_dialysis.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,337,512
                                                LR chi2(5)        =  181292.74
                                                Prob > chi2       =     0.0000
Log likelihood = -357424.38                     Pseudo R2         =     0.2023

-----------------------------------------------------------------------------------------
                     _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------+----------------------------------------------------------------
                   age1 |   1.084055   .0045548    19.21   0.000     1.075165    1.093019
                   age2 |   .9655724   .0097077    -3.48   0.000     .9467319    .9847878
                   age3 |   1.178495   .0279845     6.92   0.000     1.124903     1.23464
                 1.male |   1.374411   .0107722    40.58   0.000     1.353459    1.395687
1.chronic_liver_disease |   4.745508   .1084805    68.12   0.000     4.537582     4.96296
                  _cons |   .0000143   2.08e-06   -76.89   0.000     .0000108     .000019
-----------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
(note: file ./output/models/an_noncovid_2019_agesex_chronic_liver_disease.ster not found)
file ./output/models/an_noncovid_2019_agesex_chronic_liver_disease.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,337,512
                                                LR chi2(5)        =  186442.50
                                                Prob > chi2       =     0.0000
Log likelihood =  -354849.5                     Pseudo R2         =     0.2081

-----------------------------------------------------------------------------------------------
                           _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------------+----------------------------------------------------------------
                         age1 |   1.095082   .0046784    21.26   0.000     1.085951     1.10429
                         age2 |   .9299318    .009472    -7.13   0.000      .911551    .9486832
                         age3 |   1.293285   .0310685    10.71   0.000     1.233803    1.355634
                       1.male |   1.323009   .0103834    35.66   0.000     1.302814    1.343518
1.chronic_respiratory_disease |   2.491774    .023192    98.09   0.000      2.44673    2.537646
                        _cons |    .000011   1.63e-06   -77.27   0.000     8.24e-06    .0000147
-----------------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
(note: file ./output/models/an_noncovid_2019_agesex_chronic_respiratory_disease.ster not found)
file ./output/models/an_noncovid_2019_agesex_chronic_respiratory_disease.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,337,512
                                                LR chi2(7)        =  194437.76
                                                Prob > chi2       =     0.0000
Log likelihood = -350851.87                     Pseudo R2         =     0.2170

---------------------------------------------------------------------------------------------
                         _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
----------------------------+----------------------------------------------------------------
                       age1 |   1.077401   .0044863    17.90   0.000     1.068644     1.08623
                       age2 |   .9854901   .0098585    -1.46   0.144      .966356    1.005003
                       age3 |   1.113409   .0263503     4.54   0.000     1.062943    1.166271
                     1.male |   1.379036   .0108943    40.68   0.000     1.357848    1.400555
                            |
                    diabcat |
       Controlled diabetes  |   .7710862   .0099035   -20.24   0.000      .751918    .7907431
     Uncontrolled diabetes  |   1.184924   .0203612     9.87   0.000     1.145681    1.225511
Diabetes, no hba1c measure  |   6.365356   .0804293   146.48   0.000     6.209654    6.524963
                            |
                      _cons |   .0000166   2.39e-06   -76.65   0.000     .0000126     .000022
---------------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
(note: file ./output/models/an_noncovid_2019_agesex_diabcat.ster not found)
file ./output/models/an_noncovid_2019_agesex_diabcat.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 12,702,120
                                                LR chi2(8)        =  125515.98
                                                Prob > chi2       =     0.0000
Log likelihood = -253529.36                     Pseudo R2         =     0.1984

-----------------------------------------------------------------------------------------
                     _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------+----------------------------------------------------------------
                   age1 |   1.088059   .0057692    15.92   0.000     1.076811    1.099426
                   age2 |   .9557988   .0119197    -3.63   0.000     .9327198    .9794489
                   age3 |   1.209919   .0354055     6.51   0.000     1.142478    1.281341
                 1.male |   1.406509   .0131376    36.52   0.000     1.380994    1.432495
                        |
              ethnicity |
                 Mixed  |   .7959544   .0613344    -2.96   0.003     .6843788    .9257204
Asian or Asian British  |   .7486354   .0208347   -10.40   0.000     .7088938    .7906049
                 Black  |    .723832   .0343571    -6.81   0.000     .6595307    .7944023
                 Other  |   .6011411   .0376827    -8.12   0.000     .5316412    .6797265
                        |
                  _cons |    .000013   2.40e-06   -60.95   0.000     9.06e-06    .0000187
-----------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
(note: file ./output/models/an_noncovid_2019_agesex_ethnicity.ster not found)
file ./output/models/an_noncovid_2019_agesex_ethnicity.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,337,512
                                                LR chi2(5)        =  178161.73
                                                Prob > chi2       =     0.0000
Log likelihood = -358989.89                     Pseudo R2         =     0.1988

------------------------------------------------------------------------------------
                _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------------+----------------------------------------------------------------
              age1 |   1.083772   .0045482    19.17   0.000     1.074894    1.092723
              age2 |   .9697418   .0097535    -3.05   0.002     .9508124     .989048
              age3 |   1.161359   .0276013     6.29   0.000     1.108502    1.216737
            1.male |   1.379042   .0107991    41.04   0.000     1.358038    1.400371
1.htdiag_or_highbp |   1.013785    .009096     1.53   0.127     .9961125     1.03177
             _cons |   .0000145   2.09e-06   -76.92   0.000     .0000109    .0000192
------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
(note: file ./output/models/an_noncovid_2019_agesex_htdiag_or_highbp.ster not found)
file ./output/models/an_noncovid_2019_agesex_htdiag_or_highbp.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 15,679,660
                                                LR chi2(7)        =  179147.91
                                                Prob > chi2       =     0.0000
Log likelihood = -349299.78                     Pseudo R2         =     0.2041

---------------------------------------------------------------------------------
             _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
----------------+----------------------------------------------------------------
           age1 |   1.090589   .0052098    18.15   0.000     1.080425    1.100848
           age2 |   .9847906   .0109495    -1.38   0.168     .9635621    1.006487
           age3 |   1.091485    .028371     3.37   0.001     1.037271    1.148532
         1.male |   1.378229   .0108411    40.78   0.000     1.357144    1.399642
                |
          bpcat |
      Elevated  |   .4663998   .0056987   -62.42   0.000     .4553633    .4777039
 High, stage I  |   .3783643   .0039141   -93.95   0.000       .37077    .3861141
High, stage II  |    .350186   .0036551  -100.53   0.000     .3430949    .3574237
                |
          _cons |   .0000196   3.28e-06   -64.77   0.000     .0000141    .0000272
---------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
(note: file ./output/models/an_noncovid_2019_agesex_bpcat.ster not found)
file ./output/models/an_noncovid_2019_agesex_bpcat.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,337,512
                                                LR chi2(5)        =  178642.14
                                                Prob > chi2       =     0.0000
Log likelihood = -358749.68                     Pseudo R2         =     0.1993

--------------------------------------------------------------------------------
            _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
---------------+----------------------------------------------------------------
          age1 |   1.086151   .0045759    19.62   0.000     1.077219    1.095157
          age2 |   .9578699   .0096639    -4.27   0.000      .939115    .9769994
          age3 |   1.197184   .0285253     7.55   0.000     1.142561    1.254418
        1.male |   1.382472   .0108309    41.34   0.000     1.361406    1.403864
1.hypertension |   1.204664   .0102779    21.82   0.000     1.184687    1.224977
         _cons |   .0000136   1.97e-06   -77.03   0.000     .0000102     .000018
--------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
(note: file ./output/models/an_noncovid_2019_agesex_hypertension.ster not found)
file ./output/models/an_noncovid_2019_agesex_hypertension.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,337,512
                                                LR chi2(8)        =  180387.45
                                                Prob > chi2       =     0.0000
Log likelihood = -357877.03                     Pseudo R2         =     0.2013

----------------------------------------------------------------------------------
              _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-----------------+----------------------------------------------------------------
            age1 |   1.083653    .004555    19.11   0.000     1.074762    1.092617
            age2 |   .9756713   .0098196    -2.45   0.014     .9566138    .9951085
            age3 |   1.141142   .0271293     5.55   0.000      1.08919    1.195573
          1.male |   1.384589   .0108509    41.52   0.000     1.363485    1.406021
                 |
             imd |
              2  |   1.135209   .0140089    10.28   0.000     1.108081       1.163
              3  |   1.238916   .0152083    17.45   0.000     1.209464    1.269086
              4  |   1.411463   .0174821    27.82   0.000     1.377611    1.446146
5 most deprived  |   1.727398   .0215507    43.81   0.000     1.685671    1.770157
                 |
           _cons |   .0000108   1.57e-06   -78.67   0.000     8.15e-06    .0000144
----------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
(note: file ./output/models/an_noncovid_2019_agesex_imd.ster not found)
file ./output/models/an_noncovid_2019_agesex_imd.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,337,512
                                                LR chi2(7)        =  178643.26
                                                Prob > chi2       =     0.0000
Log likelihood = -358749.12                     Pseudo R2         =     0.1993

-------------------------------------------------------------------------------------
                 _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
--------------------+----------------------------------------------------------------
               age1 |   1.083136   .0045395    19.05   0.000     1.074275     1.09207
               age2 |   .9733818   .0097707    -2.69   0.007     .9544187    .9927216
               age3 |   1.149454    .027265     5.87   0.000     1.097238    1.204154
             1.male |   1.388504   .0108977    41.82   0.000     1.367308    1.410029
                    |
          obese4cat |
 Obese I (30-34.9)  |   .8378257   .0099951   -14.83   0.000     .8184629    .8576465
Obese II (35-39.9)  |   1.036311   .0194621     1.90   0.058     .9988599    1.075167
   Obese III (40+)  |   1.490775    .038376    15.51   0.000     1.417425     1.56792
                    |
              _cons |   .0000147   2.12e-06   -76.94   0.000     .0000111    .0000195
-------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
(note: file ./output/models/an_noncovid_2019_agesex_obese4cat.ster not found)
file ./output/models/an_noncovid_2019_agesex_obese4cat.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 13,580,679
                                                LR chi2(9)        =  150022.47
                                                Prob > chi2       =     0.0000
Log likelihood = -311165.29                     Pseudo R2         =     0.1942

---------------------------------------------------------------------------------------
                   _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
----------------------+----------------------------------------------------------------
                 age1 |   1.099217    .005992    17.35   0.000     1.087535    1.111024
                 age2 |   .9492412   .0119313    -4.14   0.000     .9261419    .9729166
                 age3 |   1.201356   .0351573     6.27   0.000     1.134387    1.272277
               1.male |   1.556184   .0131914    52.17   0.000     1.530543    1.582255
                      |
               bmicat |
  Normal (18.5-24.9)  |   .4172821   .0068415   -53.31   0.000     .4040861    .4309091
Overweight (25-29.9)  |   .2844234   .0048689   -73.45   0.000     .2750389    .2941281
   Obese I (30-34.9)  |   .3092667   .0058714   -61.81   0.000     .2979704    .3209913
  Obese II (35-39.9)  |    .383648   .0091689   -40.09   0.000     .3660918    .4020462
     Obese III (40+)  |   .5516601    .016393   -20.02   0.000     .5204482    .5847438
                      |
                _cons |   .0000222   4.26e-06   -55.81   0.000     .0000152    .0000323
---------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
(note: file ./output/models/an_noncovid_2019_agesex_bmicat.ster not found)
file ./output/models/an_noncovid_2019_agesex_bmicat.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,337,512
                                                LR chi2(5)        =  178500.56
                                                Prob > chi2       =     0.0000
Log likelihood = -358820.47                     Pseudo R2         =     0.1992

------------------------------------------------------------------------------------
                _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------------+----------------------------------------------------------------
              age1 |   1.083603   .0045462    19.14   0.000      1.07473    1.092551
              age2 |    .970263   .0097442    -3.01   0.003     .9513515    .9895504
              age3 |   1.160332   .0275257     6.27   0.000     1.107617    1.215555
            1.male |   1.377348    .010786    40.88   0.000     1.356369    1.398651
1.organ_transplant |   4.026408   .2510352    22.34   0.000     3.563262    4.549753
             _cons |   .0000145   2.10e-06   -76.92   0.000     .0000109    .0000193
------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
(note: file ./output/models/an_noncovid_2019_agesex_organ_transplant.ster not found)
file ./output/models/an_noncovid_2019_agesex_organ_transplant.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,337,512
                                                LR chi2(5)        =  178267.05
                                                Prob > chi2       =     0.0000
Log likelihood = -358937.23                     Pseudo R2         =     0.1989

-------------------------------------------------------------------------------------------
                       _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
--------------------------+----------------------------------------------------------------
                     age1 |   1.083399    .004544    19.10   0.000     1.074529    1.092341
                     age2 |   .9712025   .0097512    -2.91   0.004     .9522773    .9905038
                     age3 |   1.157074   .0274422     6.15   0.000      1.10452     1.21213
                   1.male |   1.378024     .01079    40.95   0.000     1.357038    1.399336
1.other_immunosuppression |   2.102607     .13509    11.57   0.000     1.853828    2.384772
                    _cons |   .0000146   2.11e-06   -76.91   0.000      .000011    .0000194
-------------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
(note: file ./output/models/an_noncovid_2019_agesex_other_immunosuppression.ster not found)
file ./output/models/an_noncovid_2019_agesex_other_immunosuppression.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,337,512
                                                LR chi2(5)        =  180380.55
                                                Prob > chi2       =     0.0000
Log likelihood = -357880.48                     Pseudo R2         =     0.2013

-------------------------------------------------------------------------------
           _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
--------------+----------------------------------------------------------------
         age1 |   1.085359   .0045663    19.47   0.000     1.076446    1.094346
         age2 |   .9643387    .009705    -3.61   0.000     .9455036     .983549
         age3 |   1.177874    .027994     6.89   0.000     1.124265    1.234039
       1.male |   1.366342   .0107046    39.84   0.000     1.345521    1.387484
1.other_neuro |   2.573054   .0457645    53.14   0.000     2.484903    2.664333
        _cons |   .0000139   2.01e-06   -76.99   0.000     .0000104    .0000184
-------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
(note: file ./output/models/an_noncovid_2019_agesex_other_neuro.ster not found)
file ./output/models/an_noncovid_2019_agesex_other_neuro.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,337,512
                                                LR chi2(5)        =  178378.03
                                                Prob > chi2       =     0.0000
Log likelihood = -358881.74                     Pseudo R2         =     0.1991

------------------------------------------------------------------------------------
                _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------------+----------------------------------------------------------------
              age1 |   1.083973   .0045523    19.20   0.000     1.075088    1.092932
              age2 |   .9686542   .0097354    -3.17   0.002     .9497598    .9879244
              age3 |   1.165421   .0276655     6.45   0.000     1.112439    1.220925
            1.male |   1.381844   .0108214    41.30   0.000     1.360796    1.403217
1.ra_sle_psoriasis |   1.237473   .0173469    15.20   0.000     1.203936    1.271943
             _cons |   .0000143   2.07e-06   -76.94   0.000     .0000107     .000019
------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
(note: file ./output/models/an_noncovid_2019_agesex_ra_sle_psoriasis.ster not found)
file ./output/models/an_noncovid_2019_agesex_ra_sle_psoriasis.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 16,625,414
                                                LR chi2(6)        =  178815.10
                                                Prob > chi2       =     0.0000
Log likelihood = -353183.09                     Pseudo R2         =     0.2020

------------------------------------------------------------------------------
          _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        age1 |   1.083314   .0050014    17.33   0.000     1.073556    1.093161
        age2 |   .9734403   .0105635    -2.48   0.013     .9529549     .994366
        age3 |   1.157944   .0294539     5.77   0.000     1.101631    1.217136
      1.male |   1.294597    .010347    32.31   0.000     1.274475    1.315036
             |
       smoke |
     Former  |   1.395148   .0123836    37.52   0.000     1.371086    1.419632
    Current  |   2.693657   .0347626    76.78   0.000     2.626378     2.76266
             |
       _cons |   .0000102   1.64e-06   -71.52   0.000     7.45e-06     .000014
------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
(note: file ./output/models/an_noncovid_2019_agesex_smoke.ster not found)
file ./output/models/an_noncovid_2019_agesex_smoke.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,337,512
                                                LR chi2(6)        =  183708.31
                                                Prob > chi2       =     0.0000
Log likelihood =  -356216.6                     Pseudo R2         =     0.2050

------------------------------------------------------------------------------
          _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        age1 |   1.076894   .0045994    17.35   0.000     1.067917    1.085946
        age2 |   .9867306   .0100677    -1.31   0.190     .9671942    1.006662
        age3 |   1.122047   .0270055     4.78   0.000     1.070346    1.176245
      1.male |   1.286131   .0102315    31.63   0.000     1.266233    1.306341
             |
smoke_nomiss |
     Former  |   1.404127    .012371    38.52   0.000     1.380089    1.428585
    Current  |   2.704435   .0347497    77.43   0.000     2.637177    2.773408
             |
       _cons |   .0000126   1.85e-06   -76.51   0.000     9.42e-06    .0000168
------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
(note: file ./output/models/an_noncovid_2019_agesex_smoke_nomiss.ster not found)
file ./output/models/an_noncovid_2019_agesex_smoke_nomiss.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,337,512
                                                LR chi2(5)        =  178314.56
                                                Prob > chi2       =     0.0000
Log likelihood = -358913.48                     Pseudo R2         =     0.1990

------------------------------------------------------------------------------
          _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        age1 |   1.083731   .0045473    19.16   0.000     1.074855    1.092681
        age2 |   .9702134   .0097444    -3.01   0.003     .9513015    .9895012
        age3 |    1.15998   .0275189     6.26   0.000     1.107279     1.21519
      1.male |   1.377922   .0107891    40.94   0.000     1.356937    1.399232
    1.spleen |   2.177983   .1218242    13.92   0.000     1.951835    2.430334
       _cons |   .0000145   2.10e-06   -76.93   0.000     .0000109    .0000192
------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
(note: file ./output/models/an_noncovid_2019_agesex_spleen.ster not found)
file ./output/models/an_noncovid_2019_agesex_spleen.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,337,512
                                                LR chi2(5)        =  182692.07
                                                Prob > chi2       =     0.0000
Log likelihood = -356724.72                     Pseudo R2         =     0.2039

-----------------------------------------------------------------------------------
               _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
             age1 |   1.082238   .0045319    18.87   0.000     1.073392    1.091157
             age2 |   .9748996   .0097817    -2.53   0.011     .9559151    .9942611
             age3 |   1.135322   .0269217     5.35   0.000     1.083764    1.189333
           1.male |   1.357086   .0106465    38.92   0.000     1.336379    1.378114
1.stroke_dementia |   2.085055   .0213782    71.67   0.000     2.043572    2.127379
            _cons |   .0000152   2.19e-06   -76.78   0.000     .0000114    .0000202
-----------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
(note: file ./output/models/an_noncovid_2019_agesex_stroke_dementia.ster not found)
file ./output/models/an_noncovid_2019_agesex_stroke_dementia.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,337,512
                                                LR chi2(4)        =  178159.40
                                                Prob > chi2       =     0.0000
Log likelihood = -358991.05                     Pseudo R2         =     0.1988

------------------------------------------------------------------------------
          _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        age1 |   1.083705   .0045467    19.16   0.000      1.07483    1.092653
        age2 |   .9705173   .0097467    -2.98   0.003     .9516009    .9898097
        age3 |   1.158872   .0274906     6.22   0.000     1.106225    1.214025
      1.male |   1.378761    .010795    41.02   0.000     1.357765    1.400082
       _cons |   .0000145   2.10e-06   -76.93   0.000     .0000109    .0000193
------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
(note: file ./output/models/an_noncovid_2019_agesex_SEX.ster not found)
file ./output/models/an_noncovid_2019_agesex_SEX.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,337,512
                                                LR chi2(6)        =  161355.00
                                                Prob > chi2       =     0.0000
Log likelihood = -367393.25                     Pseudo R2         =     0.1801

------------------------------------------------------------------------------
          _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
    agegroup |
     40-<50  |   2.960911   .1165245    27.58   0.000     2.741113    3.198333
     50-<60  |   6.692734   .2294905    55.44   0.000     6.257722    7.157986
     60-<70  |    16.3982   .5315482    86.29   0.000     15.38879    17.47383
     70-<80  |   41.51995   1.300604   118.95   0.000     39.04749    44.14897
        80+  |   178.7936   5.487266   168.98   0.000     168.3558    189.8785
             |
      1.male |   1.268576   .0098196    30.73   0.000     1.249476    1.287969
       _cons |   .0001654   5.06e-06  -284.80   0.000     .0001558    .0001756
------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
(note: file ./output/models/an_noncovid_2019_agesex_AGEGROUP.ster not found)
file ./output/models/an_noncovid_2019_agesex_AGEGROUP.ster saved
(covid vs noncovid ()2020))

                id:  patient_id
     failure event:  primarycaredeath != 0 & primarycaredeath < .
obs. time interval:  (stime_primarycaredeath[_n-1], stime_primarycaredeath]
 enter on or after:  time enter_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time enter_date

------------------------------------------------------------------------------
   17362187  total observations
     18,708  observations end on or before enter()
------------------------------------------------------------------------------
   17343479  observations remaining, representing
   17343479  subjects
     82,924  failures in single-failure-per-subject data
 3.0447e+09  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =       176

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,343,479
                                                LR chi2(6)        =  223952.23
                                                Prob > chi2       =     0.0000
Log likelihood = -413816.18                     Pseudo R2         =     0.2130

-------------------------------------------------------------------------------
           _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
--------------+----------------------------------------------------------------
         age1 |   1.099815   .0046894    22.31   0.000     1.090663    1.109045
         age2 |   .9457908   .0096731    -5.45   0.000     .9270205    .9649411
         age3 |   1.240788   .0306053     8.75   0.000      1.18223    1.302247
       1.male |   1.407175   .0100741    47.71   0.000     1.387568    1.427059
              |
    asthmacat |
 Yes, no OCS  |     1.0418   .0119691     3.56   0.000     1.018603    1.065525
Yes with OCS  |    1.27892   .0287293    10.95   0.000     1.223833    1.336486
              |
        _cons |   9.31e-06   1.38e-06   -78.35   0.000     6.97e-06    .0000124
-------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_noncovid_2020_agesex_asthmacat.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,343,479
                                                LR chi2(7)        =  241672.73
                                                Prob > chi2       =     0.0000
Log likelihood = -404955.94                     Pseudo R2         =     0.2298

-----------------------------------------------------------------------------------
               _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
             age1 |    1.11259   .0048441    24.50   0.000     1.103136    1.122125
             age2 |    .901065   .0093709   -10.02   0.000     .8828844      .91962
             age3 |   1.411689    .035348    13.77   0.000     1.344081    1.482698
           1.male |    1.32664   .0095506    39.26   0.000     1.308053    1.345492
                  |
cancer_exhaem_cat |
       Last year  |   8.630721   .1327458   140.13   0.000     8.374426    8.894859
   2-5 years ago  |   3.034765   .0410589    82.05   0.000     2.955348    3.116315
        5+ years  |   1.476678   .0161966    35.54   0.000     1.445272    1.508767
                  |
            _cons |   6.96e-06   1.05e-06   -78.53   0.000     5.17e-06    9.36e-06
-----------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_noncovid_2020_agesex_cancer_exhaem_cat.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,343,479
                                                LR chi2(7)        =  225609.76
                                                Prob > chi2       =     0.0000
Log likelihood = -412987.42                     Pseudo R2         =     0.2145

---------------------------------------------------------------------------------
             _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
----------------+----------------------------------------------------------------
           age1 |   1.101116   .0047046    22.54   0.000     1.091934    1.110376
           age2 |   .9413338    .009643    -5.90   0.000     .9226224    .9604248
           age3 |   1.255954   .0310231     9.23   0.000     1.196598    1.318254
         1.male |    1.39258   .0099669    46.27   0.000     1.373182    1.412253
                |
cancer_haem_cat |
     Last year  |   5.205196   .2547932    33.70   0.000     4.729018    5.729321
 2-5 years ago  |   2.824905   .0983146    29.84   0.000     2.638637    3.024322
      5+ years  |   1.796089   .0517257    20.33   0.000     1.697516    1.900385
                |
          _cons |   9.14e-06   1.35e-06   -78.32   0.000     6.83e-06    .0000122
---------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_noncovid_2020_agesex_cancer_haem_cat.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,343,479
                                                LR chi2(5)        =  228538.73
                                                Prob > chi2       =     0.0000
Log likelihood = -411522.93                     Pseudo R2         =     0.2173

-------------------------------------------------------------------------------------------
                       _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
--------------------------+----------------------------------------------------------------
                     age1 |   1.102397    .004719    22.77   0.000     1.093186    1.111685
                     age2 |     .93554   .0096008    -6.49   0.000     .9169108    .9545477
                     age3 |   1.265053   .0313003     9.50   0.000     1.205169    1.327912
                   1.male |   1.316522   .0095079    38.08   0.000     1.298018     1.33529
1.chronic_cardiac_disease |   1.733619   .0135713    70.28   0.000     1.707223    1.760423
                    _cons |   9.11e-06   1.35e-06   -78.18   0.000     6.81e-06    .0000122
-------------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_noncovid_2020_agesex_chronic_cardiac_disease.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,343,479
                                                LR chi2(6)        =  229037.44
                                                Prob > chi2       =     0.0000
Log likelihood = -411273.58                     Pseudo R2         =     0.2178

-----------------------------------------------------------------------------------------------
                           _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------------+----------------------------------------------------------------
                         age1 |   1.093192   .0046166    21.10   0.000     1.084181    1.102278
                         age2 |   .9675321   .0098342    -3.25   0.001     .9484483        .987
                         age3 |   1.148997   .0282175     5.66   0.000     1.095002    1.205655
                       1.male |   1.389758   .0099571    45.94   0.000     1.370379    1.409412
                              |
  reduced_kidney_function_cat |
Stage 3a/3b egfr 30-60        |   1.322074   .0112908    32.69   0.000     1.300129     1.34439
           Stage 4/5 egfr<30  |   3.276384   .0499906    77.78   0.000     3.179854    3.375843
                              |
                        _cons |   .0000112   1.64e-06   -77.94   0.000     8.44e-06     .000015
-----------------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_noncovid_2020_agesex_reduced_kidney_function_cat.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,343,479
                                                LR chi2(5)        =  225534.29
                                                Prob > chi2       =     0.0000
Log likelihood = -413025.16                     Pseudo R2         =     0.2145

------------------------------------------------------------------------------
          _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        age1 |    1.09995   .0046919    22.33   0.000     1.090793    1.109185
        age2 |    .944444   .0096627    -5.59   0.000     .9256941    .9635737
        age3 |   1.246366   .0307527     8.93   0.000     1.187526    1.308122
      1.male |   1.395647   .0099886    46.58   0.000     1.376206    1.415362
  1.dialysis |   6.311637    .226577    51.32   0.000     5.882817    6.771715
       _cons |   9.40e-06   1.39e-06   -78.28   0.000     7.03e-06    .0000126
------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_noncovid_2020_agesex_dialysis.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,343,479
                                                LR chi2(5)        =  226712.11
                                                Prob > chi2       =     0.0000
Log likelihood = -412436.24                     Pseudo R2         =     0.2156

-----------------------------------------------------------------------------------------
                     _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------+----------------------------------------------------------------
                   age1 |   1.099912    .004694    22.31   0.000      1.09075     1.10915
                   age2 |   .9423724   .0096449    -5.80   0.000      .923657    .9614671
                   age3 |   1.256557   .0310141     9.25   0.000     1.197218    1.318838
                 1.male |   1.400128   .0100214    47.02   0.000     1.380623    1.419908
1.chronic_liver_disease |   4.282955    .096631    64.47   0.000     4.097688    4.476598
                  _cons |   9.37e-06   1.39e-06   -78.26   0.000     7.01e-06    .0000125
-----------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_noncovid_2020_agesex_chronic_liver_disease.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,343,479
                                                LR chi2(5)        =  230994.52
                                                Prob > chi2       =     0.0000
Log likelihood = -410295.04                     Pseudo R2         =     0.2197

-----------------------------------------------------------------------------------------------
                           _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------------+----------------------------------------------------------------
                         age1 |   1.109885   .0048076    24.07   0.000     1.100502    1.119348
                         age2 |   .9116699   .0094422    -8.93   0.000     .8933501    .9303653
                         age3 |   1.366566   .0340891    12.52   0.000      1.30136     1.43504
                       1.male |    1.35893   .0097379    42.80   0.000     1.339978    1.378151
1.chronic_respiratory_disease |   2.238171   .0198559    90.81   0.000     2.199591    2.277428
                        _cons |   7.38e-06   1.11e-06   -78.58   0.000     5.49e-06    9.90e-06
-----------------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_noncovid_2020_agesex_chronic_respiratory_disease.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,343,479
                                                LR chi2(7)        =  227788.92
                                                Prob > chi2       =     0.0000
Log likelihood = -411897.84                     Pseudo R2         =     0.2166

---------------------------------------------------------------------------------------------
                         _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
----------------------------+----------------------------------------------------------------
                       age1 |   1.102501   .0047249    22.77   0.000     1.093279    1.111801
                       age2 |   .9302649   .0095586    -7.04   0.000     .9117177    .9491893
                       age3 |    1.29942   .0321961    10.57   0.000     1.237824     1.36408
                     1.male |   1.367669   .0098148    43.63   0.000     1.348567    1.387042
                            |
                    diabcat |
       Controlled diabetes  |   1.363721   .0128875    32.83   0.000     1.338695    1.389216
     Uncontrolled diabetes  |   1.945908   .0251363    51.54   0.000      1.89726    1.995803
Diabetes, no hba1c measure  |   2.148338   .0419075    39.20   0.000     2.067751    2.232065
                            |
                      _cons |   8.83e-06   1.31e-06   -78.30   0.000     6.60e-06    .0000118
---------------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_noncovid_2020_agesex_diabcat.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 12,773,694
                                                LR chi2(8)        =  160772.38
                                                Prob > chi2       =     0.0000
Log likelihood = -298370.71                     Pseudo R2         =     0.2122

-----------------------------------------------------------------------------------------
                     _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------+----------------------------------------------------------------
                   age1 |   1.109564    .005925    19.47   0.000     1.098012    1.121238
                   age2 |   .9217585   .0115928    -6.48   0.000     .8993147    .9447624
                   age3 |   1.328621   .0400132     9.43   0.000     1.252466    1.409407
                 1.male |   1.429698   .0120619    42.37   0.000     1.406252    1.453536
                        |
              ethnicity |
                 Mixed  |   .8803685   .0586201    -1.91   0.056     .7726565    1.003096
Asian or Asian British  |   .9188821   .0210356    -3.70   0.000     .8785644      .96105
                 Black  |   .9801348   .0363576    -0.54   0.589     .9114039    1.054049
                 Other  |   .7159813   .0370913    -6.45   0.000     .6468525    .7924978
                        |
                  _cons |   7.16e-06   1.34e-06   -63.45   0.000     4.96e-06    .0000103
-----------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_noncovid_2020_agesex_ethnicity.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,343,479
                                                LR chi2(5)        =  223894.39
                                                Prob > chi2       =     0.0000
Log likelihood = -413845.11                     Pseudo R2         =     0.2129

------------------------------------------------------------------------------------
                _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------------+----------------------------------------------------------------
              age1 |    1.09985   .0046921    22.31   0.000     1.090692    1.109085
              age2 |   .9430788   .0096592    -5.72   0.000     .9243359    .9622017
              age3 |   1.250442    .030895     9.05   0.000     1.191332    1.312486
            1.male |   1.404113   .0100437    47.45   0.000     1.384565    1.423937
1.htdiag_or_highbp |   1.067484   .0088242     7.90   0.000     1.050329     1.08492
             _cons |   9.36e-06   1.38e-06   -78.29   0.000     7.01e-06    .0000125
------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_noncovid_2020_agesex_htdiag_or_highbp.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 15,621,083
                                                LR chi2(7)        =  217154.71
                                                Prob > chi2       =     0.0000
Log likelihood = -405985.31                     Pseudo R2         =     0.2110

---------------------------------------------------------------------------------
             _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
----------------+----------------------------------------------------------------
           age1 |   1.104169   .0052934    20.67   0.000     1.093843    1.114593
           age2 |   .9535312   .0107059    -4.24   0.000     .9327772     .974747
           age3 |   1.198998   .0321659     6.76   0.000     1.137583    1.263729
         1.male |   1.408376   .0101087    47.71   0.000     1.388702    1.428328
                |
          bpcat |
      Elevated  |   .5909781   .0067661   -45.94   0.000     .5778644    .6043893
 High, stage I  |    .475447   .0046909   -75.36   0.000     .4663413    .4847305
High, stage II  |   .4476396   .0044342   -81.14   0.000     .4390325    .4564154
                |
          _cons |   .0000129   2.16e-06   -66.96   0.000     9.25e-06    .0000179
---------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_noncovid_2020_agesex_bpcat.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,343,479
                                                LR chi2(5)        =  224685.01
                                                Prob > chi2       =     0.0000
Log likelihood = -413449.79                     Pseudo R2         =     0.2137

--------------------------------------------------------------------------------
            _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
---------------+----------------------------------------------------------------
          age1 |   1.102618   .0047228    22.81   0.000       1.0934    1.111913
          age2 |   .9314963   .0095718    -6.91   0.000     .9129235    .9504469
          age3 |   1.289127   .0319388    10.25   0.000     1.228024    1.353271
        1.male |   1.406932   .0100686    47.71   0.000     1.387336    1.426805
1.hypertension |   1.253235   .0097602    28.98   0.000     1.234251    1.272512
         _cons |   8.74e-06   1.30e-06   -78.41   0.000     6.53e-06    .0000117
--------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_noncovid_2020_agesex_hypertension.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,343,479
                                                LR chi2(8)        =  227446.58
                                                Prob > chi2       =     0.0000
Log likelihood = -412069.01                     Pseudo R2         =     0.2163

----------------------------------------------------------------------------------
              _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-----------------+----------------------------------------------------------------
            age1 |   1.099625   .0046956    22.24   0.000      1.09046    1.108867
            age2 |   .9523055   .0097588    -4.77   0.000     .9333693    .9716257
            age3 |   1.215851   .0300515     7.91   0.000     1.158355    1.276201
          1.male |   1.411186   .0101057    48.10   0.000     1.391518    1.431133
                 |
             imd |
              2  |   1.133447    .012883    11.02   0.000     1.108475     1.15898
              3  |   1.263912   .0142421    20.79   0.000     1.236304    1.292137
              4  |   1.494385   .0168947    35.53   0.000     1.461636    1.527868
5 most deprived  |   1.865261   .0212125    54.82   0.000     1.824145    1.907303
                 |
           _cons |   6.77e-06   1.00e-06   -80.32   0.000     5.06e-06    9.05e-06
----------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_noncovid_2020_agesex_imd.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,343,479
                                                LR chi2(7)        =  224508.80
                                                Prob > chi2       =     0.0000
Log likelihood =  -413537.9                     Pseudo R2         =     0.2135

-------------------------------------------------------------------------------------
                 _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
--------------------+----------------------------------------------------------------
               age1 |   1.098844   .0046801    22.13   0.000     1.089709    1.108055
               age2 |   .9483558   .0096941    -5.19   0.000     .9295448    .9675474
               age3 |   1.233169   .0304121     8.50   0.000      1.17498     1.29424
             1.male |   1.417738   .0101652    48.68   0.000     1.397953    1.437802
                    |
          obese4cat |
 Obese I (30-34.9)  |   .8746973   .0092894   -12.61   0.000     .8566785    .8930951
Obese II (35-39.9)  |   1.152265   .0187767     8.70   0.000     1.116045    1.189661
   Obese III (40+)  |   1.618877   .0367515    21.22   0.000     1.548425    1.692535
                    |
              _cons |   9.54e-06   1.41e-06   -78.31   0.000     7.14e-06    .0000127
-------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_noncovid_2020_agesex_obese4cat.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 13,604,128
                                                LR chi2(9)        =  191634.33
                                                Prob > chi2       =     0.0000
Log likelihood = -364353.11                     Pseudo R2         =     0.2082

---------------------------------------------------------------------------------------
                   _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
----------------------+----------------------------------------------------------------
                 age1 |   1.114818   .0059469    20.38   0.000     1.103223    1.126535
                 age2 |   .9226669   .0114553    -6.48   0.000     .9004859    .9453943
                 age3 |   1.299865   .0384542     8.87   0.000      1.22664    1.377462
               1.male |   1.583728   .0121735    59.82   0.000     1.560048    1.607769
                      |
               bmicat |
  Normal (18.5-24.9)  |   .3736406   .0058023   -63.39   0.000     .3624396    .3851877
Overweight (25-29.9)  |   .2548269   .0040966   -85.04   0.000     .2469229     .262984
   Obese I (30-34.9)  |   .2835847   .0049894   -71.63   0.000     .2739723    .2935344
  Obese II (35-39.9)  |   .3744045   .0080471   -45.71   0.000       .35896    .3905135
     Obese III (40+)  |   .5253959   .0140238   -24.11   0.000     .4986163    .5536138
                      |
                _cons |   .0000171   3.21e-06   -58.44   0.000     .0000118    .0000247
---------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_noncovid_2020_agesex_bmicat.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,343,479
                                                LR chi2(5)        =  224244.18
                                                Prob > chi2       =     0.0000
Log likelihood = -413670.21                     Pseudo R2         =     0.2132

------------------------------------------------------------------------------------
                _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------------+----------------------------------------------------------------
              age1 |   1.099442   .0046855    22.25   0.000     1.090297    1.108664
              age2 |   .9463863   .0096757    -5.39   0.000      .927611    .9655417
              age3 |   1.239255   .0305575     8.70   0.000     1.180788    1.300617
            1.male |   1.401503   .0100244    47.19   0.000     1.381993    1.421289
1.organ_transplant |    4.11666   .2372167    24.56   0.000     3.677017    4.608868
             _cons |   9.51e-06   1.40e-06   -78.28   0.000     7.12e-06    .0000127
------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_noncovid_2020_agesex_organ_transplant.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,343,479
                                                LR chi2(5)        =  224191.68
                                                Prob > chi2       =     0.0000
Log likelihood = -413696.46                     Pseudo R2         =     0.2132

-------------------------------------------------------------------------------------------
                       _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
--------------------------+----------------------------------------------------------------
                     age1 |   1.098923   .0046802    22.15   0.000     1.089788    1.108134
                     age2 |   .9480138   .0096872    -5.22   0.000      .929216    .9671917
                     age3 |   1.233558   .0304025     8.52   0.000     1.175387    1.294608
                   1.male |    1.40183    .010026    47.23   0.000     1.382317    1.421619
1.other_immunosuppression |   3.088969   .1572239    22.16   0.000     2.795688    3.413017
                    _cons |   9.61e-06   1.42e-06   -78.26   0.000     7.20e-06    .0000128
-------------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_noncovid_2020_agesex_other_immunosuppression.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,343,479
                                                LR chi2(5)        =  227302.47
                                                Prob > chi2       =     0.0000
Log likelihood = -412141.07                     Pseudo R2         =     0.2162

-------------------------------------------------------------------------------
           _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
--------------+----------------------------------------------------------------
         age1 |   1.101681   .0047116    22.64   0.000     1.092485    1.110954
         age2 |   .9390399   .0096267    -6.14   0.000     .9203602    .9580988
         age3 |   1.264211   .0312487     9.48   0.000     1.204425    1.326965
       1.male |   1.390134   .0099498    46.02   0.000     1.370769    1.409772
1.other_neuro |   2.952448   .0475805    67.18   0.000     2.860649    3.047193
        _cons |   8.96e-06   1.33e-06   -78.37   0.000     6.70e-06     .000012
-------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_noncovid_2020_agesex_other_neuro.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,343,479
                                                LR chi2(5)        =  224125.03
                                                Prob > chi2       =     0.0000
Log likelihood = -413729.79                     Pseudo R2         =     0.2131

------------------------------------------------------------------------------------
                _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------------+----------------------------------------------------------------
              age1 |   1.099862   .0046924    22.31   0.000     1.090703    1.109097
              age2 |   .9446439   .0096661    -5.57   0.000     .9258875    .9637803
              age3 |   1.245438   .0307333     8.89   0.000     1.186635    1.307154
            1.male |   1.406165   .0100577    47.66   0.000     1.386589    1.426016
1.ra_sle_psoriasis |   1.252413   .0159884    17.63   0.000     1.221465    1.284145
             _cons |   9.34e-06   1.38e-06   -78.30   0.000     6.99e-06    .0000125
------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_noncovid_2020_agesex_ra_sle_psoriasis.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 16,619,865
                                                LR chi2(6)        =  222526.46
                                                Prob > chi2       =     0.0000
Log likelihood = -408103.85                     Pseudo R2         =     0.2142

------------------------------------------------------------------------------
          _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        age1 |   1.098884   .0050757    20.41   0.000      1.08898    1.108877
        age2 |   .9477545   .0103533    -4.91   0.000     .9276782    .9682654
        age3 |   1.242568   .0325317     8.30   0.000     1.180415    1.307993
      1.male |   1.323697   .0096581    38.43   0.000     1.304902    1.342762
             |
       smoke |
     Former  |    1.37876   .0110448    40.09   0.000     1.357281    1.400578
    Current  |   2.364723   .0286802    70.96   0.000     2.309174    2.421609
             |
       _cons |   7.21e-06   1.16e-06   -73.50   0.000     5.25e-06    9.88e-06
------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_noncovid_2020_agesex_smoke.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,343,479
                                                LR chi2(6)        =  228850.92
                                                Prob > chi2       =     0.0000
Log likelihood = -411366.84                     Pseudo R2         =     0.2176

------------------------------------------------------------------------------
          _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        age1 |   1.094128   .0047346    20.79   0.000     1.084888    1.103447
        age2 |   .9583867   .0099326    -4.10   0.000     .9391155    .9780534
        age3 |   1.208926   .0301835     7.60   0.000     1.151192    1.269556
      1.male |   1.314824   .0095514    37.68   0.000     1.296236    1.333678
             |
smoke_nomiss |
     Former  |   1.388153   .0110439    41.22   0.000     1.366675    1.409968
    Current  |    2.37935   .0287458    71.75   0.000     2.323671    2.436363
             |
       _cons |   8.29e-06   1.24e-06   -77.98   0.000     6.18e-06    .0000111
------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_noncovid_2020_agesex_smoke_nomiss.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,343,479
                                                LR chi2(5)        =  223979.57
                                                Prob > chi2       =     0.0000
Log likelihood = -413802.52                     Pseudo R2         =     0.2130

------------------------------------------------------------------------------
          _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        age1 |   1.099572   .0046866    22.27   0.000     1.090425    1.108796
        age2 |   .9463746   .0096762    -5.39   0.000     .9275983     .965531
        age3 |   1.238686   .0305449     8.68   0.000     1.180243    1.300024
      1.male |   1.402244   .0100282    47.27   0.000     1.382726    1.422038
    1.spleen |     2.0557   .1099892    13.47   0.000     1.851044    2.282984
       _cons |   9.48e-06   1.40e-06   -78.29   0.000     7.10e-06    .0000127
------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_noncovid_2020_agesex_spleen.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,343,479
                                                LR chi2(5)        =  230076.88
                                                Prob > chi2       =     0.0000
Log likelihood = -410753.86                     Pseudo R2         =     0.2188

-----------------------------------------------------------------------------------
               _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
             age1 |   1.098089   .0046709    22.00   0.000     1.088973    1.107283
             age2 |   .9506426   .0097096    -4.96   0.000     .9318014    .9698649
             age3 |   1.212352   .0298792     7.81   0.000     1.155182    1.272351
           1.male |   1.379568    .009891    44.88   0.000     1.360318    1.399091
1.stroke_dementia |   2.234713   .0212245    84.66   0.000     2.193499    2.276702
            _cons |   9.94e-06   1.47e-06   -78.14   0.000     7.45e-06    .0000133
-----------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_noncovid_2020_agesex_stroke_dementia.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,343,479
                                                LR chi2(4)        =  223831.48
                                                Prob > chi2       =     0.0000
Log likelihood = -413876.56                     Pseudo R2         =     0.2129

------------------------------------------------------------------------------
          _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        age1 |    1.09954    .004686    22.27   0.000     1.090393    1.108762
        age2 |    .946662   .0096784    -5.36   0.000     .9278815    .9658226
        age3 |   1.237517   .0305138     8.64   0.000     1.179133    1.298792
      1.male |   1.402962   .0100328    47.35   0.000     1.383435    1.422764
       _cons |   9.49e-06   1.40e-06   -78.28   0.000     7.11e-06    .0000127
------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_noncovid_2020_agesex_SEX.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,343,479
                                                LR chi2(6)        =  204144.51
                                                Prob > chi2       =     0.0000
Log likelihood = -423720.04                     Pseudo R2         =     0.1941

------------------------------------------------------------------------------
          _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
    agegroup |
     40-<50  |   3.379428   .1263543    32.57   0.000     3.140634    3.636378
     50-<60  |   7.583748   .2501525    61.42   0.000     7.108971    8.090234
     60-<70  |   19.81172   .6187066    95.62   0.000     18.63544    21.06224
     70-<80  |   52.36158   1.586494   130.64   0.000     49.34263    55.56523
        80+  |   228.3758   6.808768   182.16   0.000     215.4133    242.1184
             |
      1.male |   1.294191   .0091432    36.50   0.000     1.276394    1.312236
       _cons |    .000169   5.02e-06  -292.36   0.000     .0001595    .0001791
------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_noncovid_2020_agesex_AGEGROUP.ster saved

. 
end of do-file

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  e:\analyses\covid-vs-noncovid-deaths-research\analysis\output/an_noncovid_agesex.log
  log type:  text
 opened on:  10 Sep 2020, 15:13:35

. 
.         cap prog drop baselogistic 

.         prog define baselogistic
  1.                 syntax , age(string) addvariable(string)
  2. 
.                 cap logistic _d `age'                   ///
>                                         i.male                          ///
>                                         i.`addvariable'                 
  3.         end                     

. 
. foreach year of numlist 2019 /*2020*/{
  2.         if `year'==2019 use cr_create_analysis_dataset_2019, clear
  3.         else if `year'==2020 use cr_create_analysis_dataset, clear
  4.         
.         stset stime_primarycaredeath, fail(primarycaredeath) id(patient_id) enter(enter_date) origin(enter_date)
  5. /*
>         foreach addvariable of any asthmacat    ///
>                         cancer_exhaem_cat                                       ///
>                         cancer_haem_cat                                         ///
>                         chronic_cardiac_disease                         ///
>                         reduced_kidney_function_cat                     ///
>                         dialysis                                                        ///
>                         chronic_liver_disease                           ///
>                         chronic_respiratory_disease             ///
>                         diabcat                                                         ///
>                         ethnicity                                                       ///
>                         htdiag_or_highbp                                        ///
>                          bpcat                                                          ///
>                          hypertension                                           ///
>                         imd                                                             ///
>                         obese4cat                                                       ///
>                          bmicat                                                         ///
>                         organ_transplant                                        ///
>                         other_immunosuppression                         ///
>                         other_neuro                                             ///
>                         ra_sle_psoriasis                                        ///  
>                         smoke                                                           ///
>                         smoke_nomiss                                            ///
>                         spleen                                                          ///
>                         stroke_dementia {
>                                 baselogistic, age("age1 age2 age3")  addvariable("i.`addvariable'") 
>                                 if _rc==0{
>                                 estimates
>                                 estimates save ./output/models/an_noncovid_`year'_agesex_`addvariable', replace
>                                 }
>                         else di "MODEL DID NOT FIT (adding `addvariable')"
>          }
> 
>          cap logistic _d age1 age2 age3 i.male
>                                 if _rc==0{
>                                 estimates
>                                 estimates save ./output/models/an_noncovid_`year'_agesex_SEX, replace
>                         }
>                         */
.          cap logistic _d i.agegroup i.male
  6.                                 if _rc==0{
  7.                                 estimates
  8.                                 estimates save ./output/models/an_noncovid_`year'_agesex_AGEGROUP, replace
  9.                         }
 10.          
. }
(covid vs non covid 2019)

                id:  patient_id
     failure event:  primarycaredeath != 0 & primarycaredeath < .
obs. time interval:  (stime_primarycaredeath[_n-1], stime_primarycaredeath]
 enter on or after:  time enter_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time enter_date

------------------------------------------------------------------------------
   17357709  total observations
     20,197  observations end on or before enter()
------------------------------------------------------------------------------
   17337512  observations remaining, representing
   17337512  subjects
     68,616  failures in single-failure-per-subject data
 3.0453e+09  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =       176

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
active results
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,337,512
                                                LR chi2(6)        =  161355.00
                                                Prob > chi2       =     0.0000
Log likelihood = -367393.25                     Pseudo R2         =     0.1801

------------------------------------------------------------------------------
          _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
    agegroup |
     40-<50  |   2.960911   .1165245    27.58   0.000     2.741113    3.198333
     50-<60  |   6.692734   .2294905    55.44   0.000     6.257722    7.157986
     60-<70  |    16.3982   .5315482    86.29   0.000     15.38879    17.47383
     70-<80  |   41.51995   1.300604   118.95   0.000     39.04749    44.14897
        80+  |   178.7936   5.487266   168.98   0.000     168.3558    189.8785
             |
      1.male |   1.268576   .0098196    30.73   0.000     1.249476    1.287969
       _cons |   .0001654   5.06e-06  -284.80   0.000     .0001558    .0001756
------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_noncovid_2019_agesex_AGEGROUP.ster saved

. 
end of do-file

. do "E:\STATATMP\STD8e50_000000.tmp"

.          cap logistic _d ib3.agegroup i.male

.                                 if _rc==0{
.                                 estimates

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
active results
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,337,512
                                                LR chi2(6)        =  161355.00
                                                Prob > chi2       =     0.0000
Log likelihood = -367393.25                     Pseudo R2         =     0.1801

------------------------------------------------------------------------------
          _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
    agegroup |
     18-<40  |   .1494158   .0051234   -55.44   0.000     .1397041    .1598025
     40-<50  |   .4424068   .0132305   -27.27   0.000     .4172208    .4691131
     60-<70  |    2.45015    .048777    45.02   0.000      2.35639    2.547641
     70-<80  |   6.203735   .1121515   100.96   0.000     5.987771    6.427489
        80+  |   26.71458   .4529196   193.77   0.000     25.84147     27.6172
             |
      1.male |   1.268576   .0098196    30.73   0.000     1.249476    1.287969
       _cons |    .001107   .0000185  -406.77   0.000     .0010713    .0011439
------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
.                                 estimates save ./output/models/an_noncovid_2019_agesex_AGEGROUP, replace
file ./output/models/an_noncovid_2019_agesex_AGEGROUP.ster saved
.                         }

. 
end of do-file

. do "E:\analyses\covid-vs-noncovid-deaths-research\analysis\an_table_covidvsnoncovid_agesex.do"

. 
. 
. *Coding: Krishnan Bhaskaran
. *
. *Date drafted: 10/9/2020
. *************************************************************************
. 
. 
. ***********************************************************************************************************************
. *Generic code to ouput the HRs across outcomes for all levels of a particular variables, in the right shape for table
. cap prog drop outputHRsforvar

. prog define outputHRsforvar
  1. syntax, variable(string) min(real) max(real) 
  2. forvalues i=`min'/`max'{
  3. local endwith "_tab"
  4. 
.         *put the varname and condition to left so that alignment can be checked vs shell
.         file write tablecontents ("`variable'") _tab ("`i'") _tab
  5.         
.         foreach failn of numlist 1 2 3 {
  6.         
.                 if `failn'==1 local outcome "COV"
  7.                 else if `failn'==2 local outcome "NONCOV"
  8.                 else if `failn'==3 local outcome "NONCOV_2019"
  9.                 
.                 local noestimatesflag 0 /*reset*/
 10. 
. *CHANGE THE OUTCOME BELOW TO LAST IF BRINGING IN MORE COLS
.                 if `failn'==2 local endwith "_n"
 11. 
.                 ***********************
.                 *1) GET THE RIGHT ESTIMATES INTO MEMORY
. 
.                 
. 
.                 *FOR AGEGROUP - need to use the separate univariate/multivariate model fitted with age group rather than spline
.                 *FOR ETHNICITY - use the separate complete case multivariate model
.                 *FOR REST - use the "main" multivariate model
.                 if `failn'==3{
 12.                                 if "`variable'"=="agegroup" {
 13.                                 cap estimates use ./output/models/an_noncovid_2019_agesex_AGEGROUP
 14.                                 if _rc!=0 local noestimatesflag 1
 15.                                 }
 16.                                 else {
 17.                                 cap estimates use ./output/models/an_noncovid_2019_agesex_`variable'
 18.                                 if _rc!=0 local noestimatesflag 1
 19.                                 }
 20.                 
.                 }
 21.                 else{
 22.                                 if "`variable'"=="agegroup" {
 23.                                 cap estimates use ./output/models/an_covidvsnoncovid_agesex_fail`failn'_AGEGROUP
 24.                                 if _rc!=0 local noestimatesflag 1
 25.                                 }       
 26.                                 else {
 27.                                 cap estimates use ./output/models/an_covidvsnoncovid_agesex_fail`failn'_`variable'
 28.                                 if _rc!=0 local noestimatesflag 1
 29.                                 }
 30.                 }
 31.                 ***********************
.                 *2) WRITE THE HRs TO THE OUTPUT FILE
.                 
.                 if `noestimatesflag'==0{
 32.                         cap lincom `i'.`variable', eform
 33.                         if _rc==0 file write tablecontents %4.2f (r(estimate)) (" (") %4.2f (r(lb)) ("-") %4.2f (r(ub)) (")") `endwith'
 34.                                 else file write tablecontents %4.2f ("ERR IN MODEL") `endwith'
 35.                         }
 36.                         else file write tablecontents %4.2f ("DID NOT FIT") `endwith' 
 37.                         
.                 *3) Save the estimates for plotting
.                 if `noestimatesflag'==0{
 38.                                 local hr = r(estimate)
 39.                                 local lb = r(lb)
 40.                                 local ub = r(ub)
 41.                                 cap gen `variable'=.
 42.                                 testparm i.`variable'
 43.                                 post HRestimates ("`outcome'") ("`variable'") (`i') (`hr') (`lb') (`ub') (r(p))
 44.                                 drop `variable'
 45.                                 }       
 46.                 } /*failn 1 2 */
 47.                 
. } /*variable levels*/
 48. 
. end

. ***********************************************************************************************************************
. *Generic code to write a full row of "ref category" to the output file
. cap prog drop refline

. prog define refline
  1. file write tablecontents _tab _tab ("1.00 (ref)") _tab ("1.00 (ref)")  _n
  2. *post HRestimates ("`outcome'") ("`variable'") (`refcat') (1) (1) (1) (.)
. end

. ***********************************************************************************************************************
. 
. *MAIN CODE TO PRODUCE TABLE CONTENTS
. 
. cap file close tablecontents

. file open tablecontents using ./output/an_table_covidvsnoncovid_agesex.txt, t w replace 

. 
. tempfile HRestimates

. cap postutil clear

. postfile HRestimates str11 outcome str27 variable level hr lci uci pval using `HRestimates'

. 
. *Age group
. outputHRsforvar, variable("agegroup") min(1) max(2) 

 ( 1)  [_d]1.agegroup = 0
 ( 2)  [_d]2.agegroup = 0
 ( 3)  [_d]4.agegroup = 0
 ( 4)  [_d]5.agegroup = 0
 ( 5)  [_d]6.agegroup = 0

           chi2(  5) =24315.89
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.agegroup = 0
 ( 2)  [_d]2.agegroup = 0
 ( 3)  [_d]4.agegroup = 0
 ( 4)  [_d]5.agegroup = 0
 ( 5)  [_d]6.agegroup = 0

           chi2(  5) = 1.3e+05
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.agegroup = 0
 ( 2)  [_d]2.agegroup = 0
 ( 3)  [_d]4.agegroup = 0
 ( 4)  [_d]5.agegroup = 0
 ( 5)  [_d]6.agegroup = 0

           chi2(  5) = 1.1e+05
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.agegroup = 0
 ( 2)  [_d]2.agegroup = 0
 ( 3)  [_d]4.agegroup = 0
 ( 4)  [_d]5.agegroup = 0
 ( 5)  [_d]6.agegroup = 0

           chi2(  5) =24315.89
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.agegroup = 0
 ( 2)  [_d]2.agegroup = 0
 ( 3)  [_d]4.agegroup = 0
 ( 4)  [_d]5.agegroup = 0
 ( 5)  [_d]6.agegroup = 0

           chi2(  5) = 1.3e+05
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.agegroup = 0
 ( 2)  [_d]2.agegroup = 0
 ( 3)  [_d]4.agegroup = 0
 ( 4)  [_d]5.agegroup = 0
 ( 5)  [_d]6.agegroup = 0

           chi2(  5) = 1.1e+05
         Prob > chi2 =    0.0000

. refline

. outputHRsforvar, variable("agegroup") min(4) max(6) 

 ( 1)  [_d]1.agegroup = 0
 ( 2)  [_d]2.agegroup = 0
 ( 3)  [_d]4.agegroup = 0
 ( 4)  [_d]5.agegroup = 0
 ( 5)  [_d]6.agegroup = 0

           chi2(  5) =24315.89
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.agegroup = 0
 ( 2)  [_d]2.agegroup = 0
 ( 3)  [_d]4.agegroup = 0
 ( 4)  [_d]5.agegroup = 0
 ( 5)  [_d]6.agegroup = 0

           chi2(  5) = 1.3e+05
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.agegroup = 0
 ( 2)  [_d]2.agegroup = 0
 ( 3)  [_d]4.agegroup = 0
 ( 4)  [_d]5.agegroup = 0
 ( 5)  [_d]6.agegroup = 0

           chi2(  5) = 1.1e+05
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.agegroup = 0
 ( 2)  [_d]2.agegroup = 0
 ( 3)  [_d]4.agegroup = 0
 ( 4)  [_d]5.agegroup = 0
 ( 5)  [_d]6.agegroup = 0

           chi2(  5) =24315.89
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.agegroup = 0
 ( 2)  [_d]2.agegroup = 0
 ( 3)  [_d]4.agegroup = 0
 ( 4)  [_d]5.agegroup = 0
 ( 5)  [_d]6.agegroup = 0

           chi2(  5) = 1.3e+05
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.agegroup = 0
 ( 2)  [_d]2.agegroup = 0
 ( 3)  [_d]4.agegroup = 0
 ( 4)  [_d]5.agegroup = 0
 ( 5)  [_d]6.agegroup = 0

           chi2(  5) = 1.1e+05
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.agegroup = 0
 ( 2)  [_d]2.agegroup = 0
 ( 3)  [_d]4.agegroup = 0
 ( 4)  [_d]5.agegroup = 0
 ( 5)  [_d]6.agegroup = 0

           chi2(  5) =24315.89
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.agegroup = 0
 ( 2)  [_d]2.agegroup = 0
 ( 3)  [_d]4.agegroup = 0
 ( 4)  [_d]5.agegroup = 0
 ( 5)  [_d]6.agegroup = 0

           chi2(  5) = 1.3e+05
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.agegroup = 0
 ( 2)  [_d]2.agegroup = 0
 ( 3)  [_d]4.agegroup = 0
 ( 4)  [_d]5.agegroup = 0
 ( 5)  [_d]6.agegroup = 0

           chi2(  5) = 1.1e+05
         Prob > chi2 =    0.0000

. file write tablecontents _n 

. 
. *Sex 
. refline

. outputHRsforvar, variable("male") min(1) max(1) 

. file write tablecontents _n

. 
. *BMI
. refline

. outputHRsforvar, variable("obese4cat") min(2) max(4) 

 ( 1)  [_d]2.obese4cat = 0
 ( 2)  [_d]3.obese4cat = 0
 ( 3)  [_d]4.obese4cat = 0

           chi2(  3) =  661.61
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.obese4cat = 0
 ( 2)  [_d]3.obese4cat = 0
 ( 3)  [_d]4.obese4cat = 0

           chi2(  3) =  663.68
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.obese4cat = 0
 ( 2)  [_d]3.obese4cat = 0
 ( 3)  [_d]4.obese4cat = 0

           chi2(  3) =  503.75
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.obese4cat = 0
 ( 2)  [_d]3.obese4cat = 0
 ( 3)  [_d]4.obese4cat = 0

           chi2(  3) =  661.61
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.obese4cat = 0
 ( 2)  [_d]3.obese4cat = 0
 ( 3)  [_d]4.obese4cat = 0

           chi2(  3) =  663.68
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.obese4cat = 0
 ( 2)  [_d]3.obese4cat = 0
 ( 3)  [_d]4.obese4cat = 0

           chi2(  3) =  503.75
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.obese4cat = 0
 ( 2)  [_d]3.obese4cat = 0
 ( 3)  [_d]4.obese4cat = 0

           chi2(  3) =  661.61
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.obese4cat = 0
 ( 2)  [_d]3.obese4cat = 0
 ( 3)  [_d]4.obese4cat = 0

           chi2(  3) =  663.68
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.obese4cat = 0
 ( 2)  [_d]3.obese4cat = 0
 ( 3)  [_d]4.obese4cat = 0

           chi2(  3) =  503.75
         Prob > chi2 =    0.0000

. file write tablecontents _n

. 
. *Smoking
. refline

. outputHRsforvar, variable("smoke_nomiss") min(2) max(3) 

 ( 1)  [_d]2.smoke_nomiss = 0
 ( 2)  [_d]3.smoke_nomiss = 0

           chi2(  2) =  333.21
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.smoke_nomiss = 0
 ( 2)  [_d]3.smoke_nomiss = 0

           chi2(  2) = 6361.00
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.smoke_nomiss = 0
 ( 2)  [_d]3.smoke_nomiss = 0

           chi2(  2) = 6036.48
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.smoke_nomiss = 0
 ( 2)  [_d]3.smoke_nomiss = 0

           chi2(  2) =  333.21
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.smoke_nomiss = 0
 ( 2)  [_d]3.smoke_nomiss = 0

           chi2(  2) = 6361.00
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.smoke_nomiss = 0
 ( 2)  [_d]3.smoke_nomiss = 0

           chi2(  2) = 6036.48
         Prob > chi2 =    0.0000

. file write tablecontents _n

. 
. *Ethnicity
. refline

. outputHRsforvar, variable("ethnicity") min(2) max(5) 

 ( 1)  [_d]2.ethnicity = 0
 ( 2)  [_d]3.ethnicity = 0
 ( 3)  [_d]4.ethnicity = 0
 ( 4)  [_d]5.ethnicity = 0

           chi2(  4) =  558.17
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.ethnicity = 0
 ( 2)  [_d]3.ethnicity = 0
 ( 3)  [_d]4.ethnicity = 0
 ( 4)  [_d]5.ethnicity = 0

           chi2(  4) =  176.55
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.ethnicity = 0
 ( 2)  [_d]3.ethnicity = 0
 ( 3)  [_d]4.ethnicity = 0
 ( 4)  [_d]5.ethnicity = 0

           chi2(  4) =  220.85
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.ethnicity = 0
 ( 2)  [_d]3.ethnicity = 0
 ( 3)  [_d]4.ethnicity = 0
 ( 4)  [_d]5.ethnicity = 0

           chi2(  4) =  558.17
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.ethnicity = 0
 ( 2)  [_d]3.ethnicity = 0
 ( 3)  [_d]4.ethnicity = 0
 ( 4)  [_d]5.ethnicity = 0

           chi2(  4) =  176.55
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.ethnicity = 0
 ( 2)  [_d]3.ethnicity = 0
 ( 3)  [_d]4.ethnicity = 0
 ( 4)  [_d]5.ethnicity = 0

           chi2(  4) =  220.85
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.ethnicity = 0
 ( 2)  [_d]3.ethnicity = 0
 ( 3)  [_d]4.ethnicity = 0
 ( 4)  [_d]5.ethnicity = 0

           chi2(  4) =  558.17
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.ethnicity = 0
 ( 2)  [_d]3.ethnicity = 0
 ( 3)  [_d]4.ethnicity = 0
 ( 4)  [_d]5.ethnicity = 0

           chi2(  4) =  176.55
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.ethnicity = 0
 ( 2)  [_d]3.ethnicity = 0
 ( 3)  [_d]4.ethnicity = 0
 ( 4)  [_d]5.ethnicity = 0

           chi2(  4) =  220.85
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.ethnicity = 0
 ( 2)  [_d]3.ethnicity = 0
 ( 3)  [_d]4.ethnicity = 0
 ( 4)  [_d]5.ethnicity = 0

           chi2(  4) =  558.17
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.ethnicity = 0
 ( 2)  [_d]3.ethnicity = 0
 ( 3)  [_d]4.ethnicity = 0
 ( 4)  [_d]5.ethnicity = 0

           chi2(  4) =  176.55
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.ethnicity = 0
 ( 2)  [_d]3.ethnicity = 0
 ( 3)  [_d]4.ethnicity = 0
 ( 4)  [_d]5.ethnicity = 0

           chi2(  4) =  220.85
         Prob > chi2 =    0.0000

. file write tablecontents _n

. 
. *IMD
. refline

. outputHRsforvar, variable("imd") min(2) max(5) 

 ( 1)  [_d]2.imd = 0
 ( 2)  [_d]3.imd = 0
 ( 3)  [_d]4.imd = 0
 ( 4)  [_d]5.imd = 0

           chi2(  4) = 1296.09
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.imd = 0
 ( 2)  [_d]3.imd = 0
 ( 3)  [_d]4.imd = 0
 ( 4)  [_d]5.imd = 0

           chi2(  4) = 2911.68
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.imd = 0
 ( 2)  [_d]3.imd = 0
 ( 3)  [_d]4.imd = 0
 ( 4)  [_d]5.imd = 0

           chi2(  4) = 2277.08
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.imd = 0
 ( 2)  [_d]3.imd = 0
 ( 3)  [_d]4.imd = 0
 ( 4)  [_d]5.imd = 0

           chi2(  4) = 1296.09
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.imd = 0
 ( 2)  [_d]3.imd = 0
 ( 3)  [_d]4.imd = 0
 ( 4)  [_d]5.imd = 0

           chi2(  4) = 2911.68
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.imd = 0
 ( 2)  [_d]3.imd = 0
 ( 3)  [_d]4.imd = 0
 ( 4)  [_d]5.imd = 0

           chi2(  4) = 2277.08
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.imd = 0
 ( 2)  [_d]3.imd = 0
 ( 3)  [_d]4.imd = 0
 ( 4)  [_d]5.imd = 0

           chi2(  4) = 1296.09
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.imd = 0
 ( 2)  [_d]3.imd = 0
 ( 3)  [_d]4.imd = 0
 ( 4)  [_d]5.imd = 0

           chi2(  4) = 2911.68
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.imd = 0
 ( 2)  [_d]3.imd = 0
 ( 3)  [_d]4.imd = 0
 ( 4)  [_d]5.imd = 0

           chi2(  4) = 2277.08
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.imd = 0
 ( 2)  [_d]3.imd = 0
 ( 3)  [_d]4.imd = 0
 ( 4)  [_d]5.imd = 0

           chi2(  4) = 1296.09
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.imd = 0
 ( 2)  [_d]3.imd = 0
 ( 3)  [_d]4.imd = 0
 ( 4)  [_d]5.imd = 0

           chi2(  4) = 2911.68
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.imd = 0
 ( 2)  [_d]3.imd = 0
 ( 3)  [_d]4.imd = 0
 ( 4)  [_d]5.imd = 0

           chi2(  4) = 2277.08
         Prob > chi2 =    0.0000

. file write tablecontents _n 

. 
. *BP/hypertension
. refline

. outputHRsforvar, variable("htdiag_or_highbp") min(1) max(1) 

 ( 1)  [_d]1.htdiag_or_highbp = 0

           chi2(  1) =   19.82
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.htdiag_or_highbp = 0

           chi2(  1) =   55.39
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.htdiag_or_highbp = 0

           chi2(  1) =    2.33
         Prob > chi2 =    0.1270

. file write tablecontents _n

. outputHRsforvar, variable("chronic_respiratory_disease") min(1) max(1) 

 ( 1)  [_d]1.chronic_respiratory_disease = 0

           chi2(  1) = 1101.69
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.chronic_respiratory_disease = 0

           chi2(  1) = 8717.58
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.chronic_respiratory_disease = 0

           chi2(  1) = 9622.29
         Prob > chi2 =    0.0000

. file write tablecontents _n                     

. outputHRsforvar, variable("asthmacat") min(2) max(3)                    

 ( 1)  [_d]2.asthmacat = 0
 ( 2)  [_d]3.asthmacat = 0

           chi2(  2) =   99.99
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.asthmacat = 0
 ( 2)  [_d]3.asthmacat = 0

           chi2(  2) =   91.32
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.asthmacat = 0
 ( 2)  [_d]3.asthmacat = 0

           chi2(  2) =   30.36
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.asthmacat = 0
 ( 2)  [_d]3.asthmacat = 0

           chi2(  2) =   99.99
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.asthmacat = 0
 ( 2)  [_d]3.asthmacat = 0

           chi2(  2) =   91.32
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.asthmacat = 0
 ( 2)  [_d]3.asthmacat = 0

           chi2(  2) =   30.36
         Prob > chi2 =    0.0000

. outputHRsforvar, variable("chronic_cardiac_disease") min(1) max(1) 

 ( 1)  [_d]1.chronic_cardiac_disease = 0

           chi2(  1) =  692.43
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.chronic_cardiac_disease = 0

           chi2(  1) = 5020.05
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.chronic_cardiac_disease = 0

           chi2(  1) = 5562.85
         Prob > chi2 =    0.0000

. file write tablecontents _n     

. outputHRsforvar, variable("diabcat") min(2) max(4) 

 ( 1)  [_d]2.diabcat = 0
 ( 2)  [_d]3.diabcat = 0
 ( 3)  [_d]4.diabcat = 0

           chi2(  3) = 1799.52
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.diabcat = 0
 ( 2)  [_d]3.diabcat = 0
 ( 3)  [_d]4.diabcat = 0

           chi2(  3) = 3361.90
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.diabcat = 0
 ( 2)  [_d]3.diabcat = 0
 ( 3)  [_d]4.diabcat = 0

           chi2(  3) =23093.62
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.diabcat = 0
 ( 2)  [_d]3.diabcat = 0
 ( 3)  [_d]4.diabcat = 0

           chi2(  3) = 1799.52
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.diabcat = 0
 ( 2)  [_d]3.diabcat = 0
 ( 3)  [_d]4.diabcat = 0

           chi2(  3) = 3361.90
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.diabcat = 0
 ( 2)  [_d]3.diabcat = 0
 ( 3)  [_d]4.diabcat = 0

           chi2(  3) =23093.62
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.diabcat = 0
 ( 2)  [_d]3.diabcat = 0
 ( 3)  [_d]4.diabcat = 0

           chi2(  3) = 1799.52
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.diabcat = 0
 ( 2)  [_d]3.diabcat = 0
 ( 3)  [_d]4.diabcat = 0

           chi2(  3) = 3361.90
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.diabcat = 0
 ( 2)  [_d]3.diabcat = 0
 ( 3)  [_d]4.diabcat = 0

           chi2(  3) =23093.62
         Prob > chi2 =    0.0000

. file write tablecontents _n             

. outputHRsforvar, variable("cancer_exhaem_cat") min(2) max(4) 

 ( 1)  [_d]2.cancer_exhaem_cat = 0
 ( 2)  [_d]3.cancer_exhaem_cat = 0
 ( 3)  [_d]4.cancer_exhaem_cat = 0

           chi2(  3) =  125.21
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.cancer_exhaem_cat = 0
 ( 2)  [_d]3.cancer_exhaem_cat = 0
 ( 3)  [_d]4.cancer_exhaem_cat = 0

           chi2(  3) =34591.81
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.cancer_exhaem_cat = 0
 ( 2)  [_d]3.cancer_exhaem_cat = 0
 ( 3)  [_d]4.cancer_exhaem_cat = 0

           chi2(  3) =33601.09
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.cancer_exhaem_cat = 0
 ( 2)  [_d]3.cancer_exhaem_cat = 0
 ( 3)  [_d]4.cancer_exhaem_cat = 0

           chi2(  3) =  125.21
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.cancer_exhaem_cat = 0
 ( 2)  [_d]3.cancer_exhaem_cat = 0
 ( 3)  [_d]4.cancer_exhaem_cat = 0

           chi2(  3) =34591.81
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.cancer_exhaem_cat = 0
 ( 2)  [_d]3.cancer_exhaem_cat = 0
 ( 3)  [_d]4.cancer_exhaem_cat = 0

           chi2(  3) =33601.09
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.cancer_exhaem_cat = 0
 ( 2)  [_d]3.cancer_exhaem_cat = 0
 ( 3)  [_d]4.cancer_exhaem_cat = 0

           chi2(  3) =  125.21
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.cancer_exhaem_cat = 0
 ( 2)  [_d]3.cancer_exhaem_cat = 0
 ( 3)  [_d]4.cancer_exhaem_cat = 0

           chi2(  3) =34591.81
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.cancer_exhaem_cat = 0
 ( 2)  [_d]3.cancer_exhaem_cat = 0
 ( 3)  [_d]4.cancer_exhaem_cat = 0

           chi2(  3) =33601.09
         Prob > chi2 =    0.0000

. file write tablecontents _n             

. outputHRsforvar, variable("cancer_haem_cat") min(2) max(4)              

 ( 1)  [_d]2.cancer_haem_cat = 0
 ( 2)  [_d]3.cancer_haem_cat = 0
 ( 3)  [_d]4.cancer_haem_cat = 0

           chi2(  3) =  255.16
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.cancer_haem_cat = 0
 ( 2)  [_d]3.cancer_haem_cat = 0
 ( 3)  [_d]4.cancer_haem_cat = 0

           chi2(  3) = 2839.60
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.cancer_haem_cat = 0
 ( 2)  [_d]3.cancer_haem_cat = 0
 ( 3)  [_d]4.cancer_haem_cat = 0

           chi2(  3) = 2638.41
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.cancer_haem_cat = 0
 ( 2)  [_d]3.cancer_haem_cat = 0
 ( 3)  [_d]4.cancer_haem_cat = 0

           chi2(  3) =  255.16
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.cancer_haem_cat = 0
 ( 2)  [_d]3.cancer_haem_cat = 0
 ( 3)  [_d]4.cancer_haem_cat = 0

           chi2(  3) = 2839.60
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.cancer_haem_cat = 0
 ( 2)  [_d]3.cancer_haem_cat = 0
 ( 3)  [_d]4.cancer_haem_cat = 0

           chi2(  3) = 2638.41
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.cancer_haem_cat = 0
 ( 2)  [_d]3.cancer_haem_cat = 0
 ( 3)  [_d]4.cancer_haem_cat = 0

           chi2(  3) =  255.16
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.cancer_haem_cat = 0
 ( 2)  [_d]3.cancer_haem_cat = 0
 ( 3)  [_d]4.cancer_haem_cat = 0

           chi2(  3) = 2839.60
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.cancer_haem_cat = 0
 ( 2)  [_d]3.cancer_haem_cat = 0
 ( 3)  [_d]4.cancer_haem_cat = 0

           chi2(  3) = 2638.41
         Prob > chi2 =    0.0000

. file write tablecontents _n

. outputHRsforvar, variable("reduced_kidney_function_cat") min(2) max(3)          

 ( 1)  [_d]2.reduced_kidney_function_cat = 0
 ( 2)  [_d]3.reduced_kidney_function_cat = 0

           chi2(  2) = 1349.97
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.reduced_kidney_function_cat = 0
 ( 2)  [_d]3.reduced_kidney_function_cat = 0

           chi2(  2) = 6224.47
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.reduced_kidney_function_cat = 0
 ( 2)  [_d]3.reduced_kidney_function_cat = 0

           chi2(  2) = 6029.34
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.reduced_kidney_function_cat = 0
 ( 2)  [_d]3.reduced_kidney_function_cat = 0

           chi2(  2) = 1349.97
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.reduced_kidney_function_cat = 0
 ( 2)  [_d]3.reduced_kidney_function_cat = 0

           chi2(  2) = 6224.47
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.reduced_kidney_function_cat = 0
 ( 2)  [_d]3.reduced_kidney_function_cat = 0

           chi2(  2) = 6029.34
         Prob > chi2 =    0.0000

. outputHRsforvar, variable("chronic_liver_disease") min(1) max(1)                        

 ( 1)  [_d]1.chronic_liver_disease = 0

           chi2(  1) =  237.81
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.chronic_liver_disease = 0

           chi2(  1) = 4530.61
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.chronic_liver_disease = 0

           chi2(  1) = 4640.34
         Prob > chi2 =    0.0000

. outputHRsforvar, variable("stroke_dementia") min(1) max(1)      

 ( 1)  [_d]1.stroke_dementia = 0

           chi2(  1) = 2159.47
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.stroke_dementia = 0

           chi2(  1) = 6277.31
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.stroke_dementia = 0

           chi2(  1) = 5136.00
         Prob > chi2 =    0.0000

. outputHRsforvar, variable("other_neuro") min(1) max(1)          

 ( 1)  [_d]1.other_neuro = 0

           chi2(  1) = 1233.56
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.other_neuro = 0

           chi2(  1) = 3795.22
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.other_neuro = 0

           chi2(  1) = 2823.52
         Prob > chi2 =    0.0000

. outputHRsforvar, variable("organ_transplant") min(1) max(1)                     

 ( 1)  [_d]1.organ_transplant = 0

           chi2(  1) =  238.93
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.organ_transplant = 0

           chi2(  1) =  478.46
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.organ_transplant = 0

           chi2(  1) =  499.10
         Prob > chi2 =    0.0000

. outputHRsforvar, variable("spleen") min(1) max(1) 

 ( 1)  [_d]1.spleen = 0

           chi2(  1) =    6.27
         Prob > chi2 =    0.0123

 ( 1)  [_d]1.spleen = 0

           chi2(  1) =  214.14
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.spleen = 0

           chi2(  1) =  193.66
         Prob > chi2 =    0.0000

. outputHRsforvar, variable("ra_sle_psoriasis") min(1) max(1) 

 ( 1)  [_d]1.ra_sle_psoriasis = 0

           chi2(  1) =   88.85
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.ra_sle_psoriasis = 0

           chi2(  1) =  273.14
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.ra_sle_psoriasis = 0

           chi2(  1) =  231.03
         Prob > chi2 =    0.0000

. outputHRsforvar, variable("other_immunosuppression") min(1) max(1) 

 ( 1)  [_d]1.other_immunosuppression = 0

           chi2(  1) =   77.48
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.other_immunosuppression = 0

           chi2(  1) =  527.14
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.other_immunosuppression = 0

           chi2(  1) =  133.80
         Prob > chi2 =    0.0000

. 
. 
. file close tablecontents

. 
. postclose HRestimates

. 
. use `HRestimates', clear

. 
. gen varorder = 1 

. local i=2

. foreach var of any male obese4cat smoke_nomiss ethnicity imd  diabcat ///
>         cancer_exhaem_cat cancer_haem_cat reduced_kidney_function_cat asthmacat chronic_respiratory_disease ///
>         chronic_cardiac_disease htdiag_or_highbp chronic_liver_disease ///
>         stroke_dementia other_neuro organ_transplant ///
>         spleen ra_sle_psoriasis other_immunosuppression {
  2. replace varorder = `i' if variable=="`var'"
  3. local i=`i'+1
  4. }
(0 real changes made)
(9 real changes made)
(6 real changes made)
(12 real changes made)
(12 real changes made)
(9 real changes made)
(9 real changes made)
(9 real changes made)
(6 real changes made)
(6 real changes made)
(3 real changes made)
(3 real changes made)
(3 real changes made)
(3 real changes made)
(3 real changes made)
(3 real changes made)
(3 real changes made)
(3 real changes made)
(3 real changes made)
(3 real changes made)

. sort varorder outcome level

. drop varorder

. 
. gen obsorder=_n

. expand 2 if variable!=variable[_n-1] | outcome!=outcome[_n-1], gen(expanded)
(60 observations created)

. for var hr lci uci: replace X = 1 if expanded==1

->  replace hr = 1 if expanded==1
(60 real changes made)

->  replace lci = 1 if expanded==1
(60 real changes made)

->  replace uci = 1 if expanded==1
(60 real changes made)

. 
. sort obsorder

. drop obsorder

. replace level = 0 if expanded == 1
(60 real changes made)

. replace level = 1 if expanded == 1 & (variable=="obese4cat"|variable=="smoke_nomiss"|variable=="ethnicity"|variable=="imd"|variable=="asthmacat"|variable=="diabcat"|substr(variable,1,6)=="cancer"|variab
> le=="reduced_kidney_function_cat"|variable=="agegroup")
(30 real changes made)

. replace level = 3 if expanded == 1 & variable=="agegroup"
(3 real changes made)

. 
. gen varorder = 1 if variable!=variable[_n-1]
(163 missing values generated)

. replace varorder = sum(varorder)
(182 real changes made)

. sort varorder outcome level

. 
. 
. drop expanded

. expand 2 if variable!=variable[_n-1] | outcome!=outcome[_n-1], gen(expanded)
(60 observations created)

. replace level = -1 if expanded==1
(60 real changes made)

. drop expanded

. *expand 3 if variable=="htdiag_or_highbp" & level==-1, gen(expanded)
. *replace level = -99 if variable=="htdiag_or_highbp" & expanded==1
. expand 2 if level == -1, gen(expanded)
(60 observations created)

. replace level = -99 if expanded==1
(60 real changes made)

. 
. for var hr lci uci pval : replace X=. if level<0

->  replace hr=. if level<0
(120 real changes made, 120 to missing)

->  replace lci=. if level<0
(120 real changes made, 120 to missing)

->  replace uci=. if level<0
(120 real changes made, 120 to missing)

->  replace pval=. if level<0
(120 real changes made, 120 to missing)

. sort varorder outcome  level

. 
. gen varx = 0.07

. gen levelx = 0.071

. gen lowerlimit = 0.15

. 
. *Names
. gen Name = variable if (level==-1&!(level[_n+1]==0&variable!="male"))|(level==1&level[_n-1]==0&variable!="male")
(243 missing values generated)

. replace Name = subinstr(Name, "_", " ", 10)
(39 real changes made)

. replace Name = upper(substr(Name,1,1)) + substr(Name,2,.)
(60 real changes made)

. replace Name = "Age group" if Name=="Agegroup"
(3 real changes made)

. replace Name = "Sex" if Name=="Male"
(0 real changes made)

. replace Name = "Obesity" if Name=="Obese4cat"
(3 real changes made)

. replace Name = "Smoking status" if Name=="Smoke nomiss"
(3 real changes made)

. replace Name = "Deprivation (IMD) quintile" if Name=="Imd"
(3 real changes made)

. replace Name = "Hypertension/high bp" if Name=="Htdiag or highbp"
(3 real changes made)

. replace Name = "Asthma" if Name=="Asthmacat"
(3 real changes made)

. replace Name = "Diabetes" if Name=="Diabcat"
(3 real changes made)

. replace Name = "Cancer (non-haematological)" if Name=="Cancer exhaem cat"
(3 real changes made)

. replace Name = "Haematological malignancy" if Name=="Cancer haem cat"
(3 real changes made)

. replace Name = "Stroke or dementia" if Name=="Stroke dementia"
(3 real changes made)

. replace Name = "Other neurological" if Name=="Other neuro"
(3 real changes made)

. replace Name = "Rheumatoid arthritis/Lupus/Psoriasis" if Name=="Ra sle psoriasis"
variable Name was str27 now str36
(3 real changes made)

. replace Name = "Reduced kidney function" if Name=="Reduced kidney function cat"
(3 real changes made)

. replace Name = "Asplenia" if Name=="Spleen"
(3 real changes made)

. 
. *Levels
. gen leveldesc = ""
(303 missing values generated)

. replace leveldesc = "18-39" if variable=="agegroup" & level==1
variable leveldesc was str1 now str5
(3 real changes made)

. replace leveldesc = "40-49" if variable=="agegroup" & level==2
(3 real changes made)

. replace leveldesc = "50-59 (ref)" if variable=="agegroup" & level==3
variable leveldesc was str5 now str11
(3 real changes made)

. replace leveldesc = "60-69" if variable=="agegroup" & level==4
(3 real changes made)

. replace leveldesc = "70-79" if variable=="agegroup" & level==5
(3 real changes made)

. replace leveldesc = "80+" if variable=="agegroup" & level==6
(3 real changes made)

. 
. replace leveldesc = "Female (ref)" if variable=="male" & level==0
(0 real changes made)

. replace leveldesc = "Male" if variable=="male" & level==1
(0 real changes made)

. 
. replace leveldesc = "Not obese (ref)" if variable=="obese4cat" & level==1
variable leveldesc was str11 now str15
(3 real changes made)

. replace leveldesc = "Obese class I" if variable=="obese4cat" & level==2
(3 real changes made)

. replace leveldesc = "Obese class II" if variable=="obese4cat" & level==3
(3 real changes made)

. replace leveldesc = "Obese class III" if variable=="obese4cat" & level==4
(3 real changes made)

. 
. replace leveldesc = "Never (ref)" if variable=="smoke_nomiss" & level==1
(3 real changes made)

. replace leveldesc = "Ex-smoker" if variable=="smoke_nomiss" & level==2
(3 real changes made)

. replace leveldesc = "Current" if variable=="smoke_nomiss" & level==3
(3 real changes made)

. 
. replace leveldesc = "White (ref)" if variable=="ethnicity" & level==1
(3 real changes made)

. replace leveldesc = "Mixed" if variable=="ethnicity" & level==2
(3 real changes made)

. replace leveldesc = "Asian/Asian British" if variable=="ethnicity" & level==3
variable leveldesc was str15 now str19
(3 real changes made)

. replace leveldesc = "Black" if variable=="ethnicity" & level==4
(3 real changes made)

. replace leveldesc = "Other" if variable=="ethnicity" & level==5
(3 real changes made)

. 
. replace leveldesc = "1 (least deprived, ref)" if variable=="imd" & level==1
variable leveldesc was str19 now str23
(3 real changes made)

. replace leveldesc = "2" if variable=="imd" & level==2
(3 real changes made)

. replace leveldesc = "3" if variable=="imd" & level==3
(3 real changes made)

. replace leveldesc = "4" if variable=="imd" & level==4
(3 real changes made)

. replace leveldesc = "5 (most deprived)" if variable=="imd" & level==5
(3 real changes made)

. 
. replace leveldesc = "No diabetes (ref)" if variable=="diabcat" & level==1
(3 real changes made)

. replace leveldesc = "Controlled (HbA1c <58mmol/mol)" if variable=="diabcat" & level==2
variable leveldesc was str23 now str30
(3 real changes made)

. replace leveldesc = "Uncontrolled (HbA1c >=58mmol/mol) " if variable=="diabcat" & level==3
variable leveldesc was str30 now str34
(3 real changes made)

. replace leveldesc = "Unknown HbA1c" if variable=="diabcat" & level==4
(3 real changes made)

. 
. replace leveldesc = "No asthma (ref)" if variable=="asthmacat" & level==1
(3 real changes made)

. replace leveldesc = "With no recent OCS use" if variable=="asthmacat" & level==2
(3 real changes made)

. replace leveldesc = "With recent OCS use" if variable=="asthmacat" & level==3
(3 real changes made)

. 
. replace leveldesc = "Never (ref)" if substr(variable,1,6)=="cancer" & level==1
(6 real changes made)

. replace leveldesc = "<1 year ago" if substr(variable,1,6)=="cancer" & level==2
(6 real changes made)

. replace leveldesc = "1-4.9 years ago" if substr(variable,1,6)=="cancer" & level==3
(6 real changes made)

. replace leveldesc = "5+ years ago" if substr(variable,1,6)=="cancer" & level==4
(6 real changes made)

. 
. replace leveldesc = "None (ref)" if variable=="reduced_kidney_function_cat" & level==1
(3 real changes made)

. replace leveldesc = "eGFR 30-60 ml/min/1.73m2" if variable=="reduced_kidney_function_cat" & level==2
(3 real changes made)

. replace leveldesc = "eGFR <30 ml/min/1.73m2" if variable=="reduced_kidney_function_cat" & level==3
(3 real changes made)

. 
. 
. *replace leveldesc = "Absent" if level==0
. *replace leveldesc = "Present" if level==1 & leveldesc==""
. drop if level==0 & variable!="male"
(30 observations deleted)

. 
. 
. gen obsorder=_n

. gsort -obsorder

. gen graphorder = _n

. sort obsorder

. 
. *merge 1:1 variable level using c:\statatemp\tptemp, update replace
. 
. gen displayhrci = "<<< HR = " + string(hr, "%3.2f") + " (" + string(lci, "%3.2f") + "-" + string(uci, "%3.2f") + ")" if lci<0.15
(270 missing values generated)

. 
. qui summ obsorder if outcome=="NONCOV_2019" & variable=="imd" & level ==5

. local endofdemog = r(mean)

. foreach graphtype of any demogs comorbs{
  2. if "`graphtype'"=="demogs" local if "if _n<=`endofdemog'"
  3. if "`graphtype'"=="comorbs" local if "if _n>`endofdemog'"
  4. scatter graphorder hr if lci>=.15 & outcome=="COV", mcol(red)   msize(small)            ///                                                                             ///
>         || rcap lci uci graphorder if lci>=.15 & outcome=="COV", hor mcol(red)  lcol(red)                       ///
>         || scatter graphorder hr if lci>=.15 & outcome=="NONCOV", mcol(black)   msize(small)            ///                                                                             ///
>         || rcap lci uci graphorder if lci>=.15 & outcome=="NONCOV", hor mcol(black)     lcol(black)                     ///
>         || scatter graphorder hr if lci>=.15 & outcome=="NONCOV_2019", mcol(blue)       msize(small)            ///                                                                             ///
>         || rcap lci uci graphorder if lci>=.15 & outcome=="NONCOV_2019", hor mcol(blue) lcol(black)                     ///
>         || scatter graphorder lowerlimit, m(i) mlab(displayhrci) mlabcol(black) mlabsize(tiny) ///
>         || scatter graphorder varx if outcome=="COV", m(i) mlab(Name) mlabsize(tiny) mlabcol(black)     ///
>         || scatter graphorder levelx if outcome=="COV", m(i) mlab(leveldesc) mlabsize(tiny) mlabcol(gs8)        ///
>                 xline(1,lp(dash))                                                                                                                       ///
>                 xscale(log) xlab(0.25 0.5 1 2 5 10 20) xtitle("Odds Ratio & 95% CI") ylab(none) ytitle("")                                              /// 
>                  ysize(12)   legend(order(1 3 5) label(1 "COVID deaths") label(3 "Non-COVID deaths")  label(5 "Deaths 2019")) ///
>                 || `if' , name(`graphtype', replace)
  5. }

. graph combine demogs comorbs, rows(1) ysize(6) iscale(*.7)

. graph export ./output/an_table_covidvsnoncovid_agesex.svg, as(svg) replace
(file ./output/an_table_covidvsnoncovid_agesex.svg written in SVG format)

. 
end of do-file

