----------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  e:\analyses\covid-vs-noncovid-deaths-research\analysis\output/an_covidvsnoncovid_agesex.log
  log type:  text
 opened on:  10 Sep 2020, 01:11:14

. 
.         cap prog drop baselogistic 

.         prog define baselogistic
  1.                 syntax , age(string) addvariable(string)
  2. 
.         cap logistic _d `age'                   ///
>                                 i.male                          ///
>                                 i.`addvariable'                 
  3.         end                     

.         
.         
. foreach failindicator of numlist 1 2 {
  2. 
.         use cr_create_analysis_dataset, clear
  3.         stset stime_onsdeath, fail(onsdeath==`failindicator') id(patient_id) enter(enter_date) origin(enter_date)
  4. 
.         foreach addvariable of any asthmacat    ///
>                 cancer_exhaem_cat                                       ///
>                 cancer_haem_cat                                         ///
>                 chronic_cardiac_disease                         ///
>                 reduced_kidney_function_cat                     ///
>                 dialysis                                                        ///
>                 chronic_liver_disease                           ///
>                 chronic_respiratory_disease             ///
>                 diabcat                                                         ///
>                 ethnicity                                                       ///
>                 htdiag_or_highbp                                        ///
>                  bpcat                                                          ///
>                  hypertension                                           ///
>                 imd                                                             ///
>                 obese4cat                                                       ///
>                  bmicat                                                         ///
>                 organ_transplant                                        ///
>                 other_immunosuppression                         ///
>                 other_neuro                                             ///
>                 ra_sle_psoriasis                                        ///  
>                 smoke                                                           ///
>                 smoke_nomiss                                            ///
>                 spleen                                                          ///
>                 stroke_dementia {
  5.                         baselogistic, age("age1 age2 age3")  addvariable("i.`addvariable'") 
  6.                         if _rc==0{
  7.                         estimates
  8.                         estimates save ./output/models/an_covidvsnoncovid_agesex_fail`failindicator'_`addvariable', replace
  9.                         }
 10.                 else di "MODEL DID NOT FIT (adding `addvariable')"
 11.          }
 12. 
.          cap logistic _d age1 age2 age3 i.male
 13.                         if _rc==0{
 14.                         estimates
 15.                         estimates save ./output/models/an_covidvsnoncovid_agesex_fail`failindicator'_SEX, replace
 16.                         }
 17.          cap logistic _d i.agegroup i.male
 18.                         if _rc==0{
 19.                         estimates
 20.                         estimates save ./output/models/an_covidvsnoncovid_agesex_fail`failindicator'_AGEGROUP, replace
 21.                         }
 22.          
. }
(covid vs noncovid ()2020))

                id:  patient_id
     failure event:  onsdeath == 1
obs. time interval:  (stime_onsdeath[_n-1], stime_onsdeath]
 enter on or after:  time enter_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time enter_date

------------------------------------------------------------------------------
   17362187  total observations
      4,578  observations end on or before enter()
------------------------------------------------------------------------------
   17357609  observations remaining, representing
   17357609  subjects
     15,513  failures in single-failure-per-subject data
 3.0458e+09  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =       176

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(6)        =   47338.20
                                                Prob > chi2       =     0.0000
Log likelihood =  -100739.9                     Pseudo R2         =     0.1903

-------------------------------------------------------------------------------
           _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
--------------+----------------------------------------------------------------
         age1 |   1.165361   .0210193     8.48   0.000     1.124884    1.207295
         age2 |   .9051892    .035543    -2.54   0.011     .8381394    .9776028
         age3 |   1.288591   .1171139     2.79   0.005     1.078335    1.539845
       1.male |   1.679945   .0275231    31.66   0.000     1.626858    1.734765
              |
    asthmacat |
 Yes, no OCS  |   1.122665     .02902     4.48   0.000     1.067204    1.181009
Yes with OCS  |   1.543907   .0728177     9.21   0.000     1.407585    1.693431
              |
        _cons |   7.75e-08   5.08e-08   -25.00   0.000     2.15e-08    2.80e-07
-------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail1_asthmacat.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(7)        =   47356.53
                                                Prob > chi2       =     0.0000
Log likelihood = -100730.73                     Pseudo R2         =     0.1903

-----------------------------------------------------------------------------------
               _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
             age1 |   1.166731   .0211003     8.53   0.000       1.1261    1.208829
             age2 |   .9010633   .0354685    -2.65   0.008     .8341603    .9733322
             age3 |   1.303552   .1187484     2.91   0.004     1.090403    1.558365
           1.male |   1.655285   .0271475    30.73   0.000     1.602923    1.709358
                  |
cancer_exhaem_cat |
       Last year  |   1.776472   .1009037    10.12   0.000     1.589316    1.985669
   2-5 years ago  |   1.227027   .0494147     5.08   0.000       1.1339    1.327803
        5+ years  |   1.001426   .0264245     0.05   0.957     .9509517     1.05458
                  |
            _cons |   7.75e-08   5.09e-08   -24.94   0.000     2.14e-08    2.81e-07
-----------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail1_cancer_exhaem_cat.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(7)        =   47447.13
                                                Prob > chi2       =     0.0000
Log likelihood = -100685.44                     Pseudo R2         =     0.1907

---------------------------------------------------------------------------------
             _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
----------------+----------------------------------------------------------------
           age1 |   1.166264   .0210735     8.51   0.000     1.125683    1.208307
           age2 |   .9024869   .0354912    -2.61   0.009     .8355386    .9747995
           age3 |   1.297876   .1181219     2.86   0.004     1.085835    1.551324
         1.male |   1.659038   .0271641    30.92   0.000     1.606642    1.713142
                |
cancer_haem_cat |
     Last year  |   3.158409   .3915283     9.28   0.000     2.477138    4.027045
 2-5 years ago  |   2.359585    .189897    10.67   0.000     2.015264    2.762737
      5+ years  |   1.655005    .107431     7.76   0.000     1.457288    1.879547
                |
          _cons |   7.83e-08   5.14e-08   -24.94   0.000     2.16e-08    2.83e-07
---------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail1_cancer_haem_cat.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(5)        =   47912.65
                                                Prob > chi2       =     0.0000
Log likelihood = -100452.67                     Pseudo R2         =     0.1926

-------------------------------------------------------------------------------------------
                       _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
--------------------------+----------------------------------------------------------------
                     age1 |   1.168573   .0211899     8.59   0.000     1.127771    1.210852
                     age2 |   .8953978   .0353236    -2.80   0.005     .8287737    .9673777
                     age3 |    1.31449   .1199856     3.00   0.003     1.099158    1.572006
                   1.male |   1.580237   .0260993    27.70   0.000     1.529902    1.632227
1.chronic_cardiac_disease |   1.587219    .027866    26.31   0.000     1.533532    1.642786
                    _cons |   7.58e-08   4.99e-08   -24.90   0.000     2.09e-08    2.76e-07
-------------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail1_chronic_cardiac_disease.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(6)        =   48416.77
                                                Prob > chi2       =     0.0000
Log likelihood = -100200.62                     Pseudo R2         =     0.1946

-----------------------------------------------------------------------------------------------
                           _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------------+----------------------------------------------------------------
                         age1 |   1.152441    .020376     8.02   0.000     1.113188    1.193077
                         age2 |   .9384709   .0362517    -1.64   0.100      .870042    1.012282
                         age3 |   1.150331   .1030543     1.56   0.118     .9650867    1.371131
                       1.male |   1.650687   .0270217    30.62   0.000     1.598566    1.704508
                              |
  reduced_kidney_function_cat |
Stage 3a/3b egfr 30-60        |   1.463143   .0277661    20.06   0.000     1.409723    1.518589
           Stage 4/5 egfr<30  |   3.192426   .1040876    35.60   0.000       2.9948    3.403093
                              |
                        _cons |   1.13e-07   7.24e-08   -24.95   0.000     3.21e-08    3.96e-07
-----------------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail1_reduced_kidney_function_cat.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(5)        =   47832.95
                                                Prob > chi2       =     0.0000
Log likelihood = -100492.52                     Pseudo R2         =     0.1922

------------------------------------------------------------------------------
          _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        age1 |   1.165392   .0210336     8.48   0.000     1.124888    1.207355
        age2 |   .9037166   .0355054    -2.58   0.010     .8367392    .9760553
        age3 |   1.295157   .1177725     2.84   0.004     1.083727    1.547835
      1.male |   1.655607   .0271185    30.78   0.000     1.603299     1.70962
  1.dialysis |   8.099011   .5337357    31.74   0.000     7.117651    9.215679
       _cons |   8.00e-08   5.24e-08   -24.94   0.000     2.22e-08    2.89e-07
------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail1_dialysis.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(5)        =   47427.78
                                                Prob > chi2       =     0.0000
Log likelihood = -100695.11                     Pseudo R2         =     0.1906

-----------------------------------------------------------------------------------------
                     _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------+----------------------------------------------------------------
                   age1 |    1.16465   .0209975     8.45   0.000     1.124214     1.20654
                   age2 |   .9052271   .0355322    -2.54   0.011     .8381968    .9776178
                   age3 |   1.290254    .117228     2.80   0.005     1.079787    1.541745
                 1.male |   1.667625    .027297    31.24   0.000     1.614973    1.721993
1.chronic_liver_disease |   2.601478   .1612873    15.42   0.000     2.303812    2.937604
                  _cons |   8.13e-08   5.32e-08   -24.94   0.000     2.25e-08    2.93e-07
-----------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail1_chronic_liver_disease.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(5)        =   48214.33
                                                Prob > chi2       =     0.0000
Log likelihood = -100301.84                     Pseudo R2         =     0.1938

-----------------------------------------------------------------------------------------------
                           _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------------+----------------------------------------------------------------
                         age1 |   1.179143   .0217513     8.93   0.000     1.137273    1.222555
                         age2 |   .8698955   .0348262    -3.48   0.000     .8042468    .9409029
                         age3 |   1.425575   .1318961     3.83   0.000     1.189147    1.709009
                       1.male |   1.621813   .0265751    29.51   0.000     1.570554    1.674744
1.chronic_respiratory_disease |   1.956647   .0395691    33.19   0.000      1.88061    2.035758
                        _cons |   5.66e-08   3.79e-08   -24.89   0.000     1.52e-08    2.11e-07
-----------------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail1_chronic_respiratory_disease.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(7)        =   48846.61
                                                Prob > chi2       =     0.0000
Log likelihood = -99985.692                     Pseudo R2         =     0.1963

---------------------------------------------------------------------------------------------
                         _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
----------------------------+----------------------------------------------------------------
                       age1 |   1.174886   .0215584     8.78   0.000     1.133383    1.217909
                       age2 |   .8718947   .0347573    -3.44   0.001      .806365    .9427497
                       age3 |   1.425204   .1313745     3.84   0.000     1.189635     1.70742
                     1.male |   1.601725   .0263095    28.68   0.000      1.55098    1.654129
                            |
                    diabcat |
       Controlled diabetes  |   1.639846   .0334906    24.22   0.000     1.575502    1.706818
     Uncontrolled diabetes  |   2.550687    .067588    35.34   0.000     2.421598    2.686657
Diabetes, no hba1c measure  |   2.363105   .0994295    20.44   0.000     2.176046    2.566244
                            |
                      _cons |   6.28e-08   4.19e-08   -24.87   0.000     1.70e-08    2.32e-07
---------------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail1_diabcat.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 12,783,591
                                                LR chi2(8)        =   35898.26
                                                Prob > chi2       =     0.0000
Log likelihood =  -74755.49                     Pseudo R2         =     0.1936

-----------------------------------------------------------------------------------------
                     _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------+----------------------------------------------------------------
                   age1 |   1.158981   .0239182     7.15   0.000     1.113038    1.206821
                   age2 |   .9200059   .0413257    -1.86   0.063      .842472    1.004675
                   age3 |   1.244461   .1293407     2.10   0.035      1.01511     1.52563
                 1.male |   1.641205   .0310433    26.19   0.000     1.581476    1.703191
                        |
              ethnicity |
                 Mixed  |   1.807985   .2081984     5.14   0.000     1.442696    2.265765
Asian or Asian British  |   2.020251   .0766887    18.53   0.000     1.875399    2.176291
                 Black  |   2.316339   .1361699    14.29   0.000     2.064252     2.59921
                 Other  |   1.551769   .1348472     5.06   0.000     1.308755    1.839906
                        |
                  _cons |   8.80e-08   6.59e-08   -21.70   0.000     2.03e-08    3.82e-07
-----------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail1_ethnicity.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(5)        =   47268.07
                                                Prob > chi2       =     0.0000
Log likelihood = -100774.96                     Pseudo R2         =     0.1900

------------------------------------------------------------------------------------
                _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------------+----------------------------------------------------------------
              age1 |   1.165352   .0210416     8.47   0.000     1.124832    1.207331
              age2 |   .9018663   .0354648    -2.63   0.009     .8349677    .9741249
              age3 |   1.301394   .1184678     2.89   0.004     1.088736    1.555589
            1.male |   1.671914   .0273748    31.39   0.000     1.619112    1.726438
1.htdiag_or_highbp |   1.088178   .0206575     4.45   0.000     1.048434    1.129429
             _cons |   7.93e-08   5.20e-08   -24.94   0.000     2.19e-08    2.86e-07
------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail1_htdiag_or_highbp.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 15,635,073
                                                LR chi2(7)        =   45604.57
                                                Prob > chi2       =     0.0000
Log likelihood =  -99659.56                     Pseudo R2         =     0.1862

---------------------------------------------------------------------------------
             _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
----------------+----------------------------------------------------------------
           age1 |   1.154666   .0220559     7.53   0.000     1.112236    1.198714
           age2 |   .9361914   .0386348    -1.60   0.110     .8634501    1.015061
           age3 |   1.176113   .1119653     1.70   0.088     .9759219    1.417369
         1.male |   1.658523   .0271733    30.88   0.000      1.60611    1.712646
                |
          bpcat |
      Elevated  |   .6484695   .0166864   -16.83   0.000     .6165758     .682013
 High, stage I  |   .5147172   .0115729   -29.54   0.000     .4925273    .5379068
High, stage II  |   .4672657   .0105637   -33.66   0.000     .4470132    .4884357
                |
          _cons |   1.73e-07   1.21e-07   -22.37   0.000     4.43e-08    6.78e-07
---------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail1_bpcat.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(5)        =   47488.90
                                                Prob > chi2       =     0.0000
Log likelihood = -100664.55                     Pseudo R2         =     0.1909

--------------------------------------------------------------------------------
            _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
---------------+----------------------------------------------------------------
          age1 |   1.171436   .0213473     8.68   0.000     1.130334    1.214032
          age2 |   .8837213   .0350296    -3.12   0.002     .8176638    .9551154
          age3 |   1.368153   .1254535     3.42   0.001     1.143098    1.637518
        1.male |   1.677224    .027476    31.57   0.000     1.624227    1.731949
1.hypertension |    1.31371   .0233874    15.33   0.000     1.268662    1.360357
         _cons |   6.78e-08   4.49e-08   -24.94   0.000     1.85e-08    2.48e-07
--------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail1_hypertension.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(8)        =   48493.69
                                                Prob > chi2       =     0.0000
Log likelihood = -100162.15                     Pseudo R2         =     0.1949

----------------------------------------------------------------------------------
              _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-----------------+----------------------------------------------------------------
            age1 |   1.162815   .0209018     8.39   0.000     1.122562    1.204512
            age2 |   .9182981   .0359812    -2.18   0.030     .8504162    .9915985
            age3 |   1.237697   .1123095     2.35   0.019     1.036038    1.478608
          1.male |   1.684154   .0275942    31.81   0.000      1.63093    1.739116
                 |
             imd |
              2  |   1.150937   .0307387     5.26   0.000      1.09224    1.212789
              3  |     1.2646   .0335773     8.84   0.000     1.200472    1.332152
              4  |   1.693064   .0438276    20.34   0.000     1.609306    1.781181
5 most deprived  |   2.228078   .0572941    31.16   0.000     2.118566     2.34325
                 |
           _cons |   5.56e-08   3.63e-08   -25.60   0.000     1.55e-08    2.00e-07
----------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail1_imd.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(7)        =   47805.98
                                                Prob > chi2       =     0.0000
Log likelihood = -100506.01                     Pseudo R2         =     0.1921

-------------------------------------------------------------------------------------
                 _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
--------------------+----------------------------------------------------------------
               age1 |   1.163781   .0210264     8.39   0.000     1.123291     1.20573
               age2 |   .9008028   .0354273    -2.66   0.008     .8339752    .9729853
               age3 |    1.31962   .1201293     3.05   0.002      1.10398    1.577381
             1.male |    1.71396   .0281449    32.81   0.000     1.659675     1.77002
                    |
          obese4cat |
 Obese I (30-34.9)  |   1.173178   .0265014     7.07   0.000     1.122369    1.226287
Obese II (35-39.9)  |    1.73906   .0575032    16.73   0.000      1.62993    1.855496
   Obese III (40+)  |   2.566452   .1175181    20.58   0.000     2.346154    2.807435
                    |
              _cons |   7.67e-08   5.03e-08   -24.98   0.000     2.12e-08    2.77e-07
-------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail1_obese4cat.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 13,616,543
                                                LR chi2(9)        =   40540.44
                                                Prob > chi2       =     0.0000
Log likelihood = -90509.953                     Pseudo R2         =     0.1830

---------------------------------------------------------------------------------------
                   _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
----------------------+----------------------------------------------------------------
                 age1 |   1.150264    .023558     6.84   0.000     1.105005    1.197376
                 age2 |   .9240666   .0409267    -1.78   0.075     .8472347    1.007866
                 age3 |    1.24013   .1267501     2.11   0.035     1.015006    1.515187
               1.male |   1.850506   .0322585    35.31   0.000     1.788349    1.914824
                      |
               bmicat |
  Normal (18.5-24.9)  |    .493421   .0189359   -18.41   0.000     .4576689    .5319661
Overweight (25-29.9)  |   .3912462   .0153844   -23.87   0.000      .362226    .4225913
   Obese I (30-34.9)  |   .5269661   .0219847   -15.36   0.000     .4855914    .5718661
  Obese II (35-39.9)  |   .7832439   .0377769    -5.07   0.000     .7125945    .8608977
     Obese III (40+)  |   1.156813   .0668412     2.52   0.012     1.032952    1.295525
                      |
                _cons |   2.58e-07   1.92e-07   -20.32   0.000     5.97e-08    1.11e-06
---------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail1_bmicat.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(5)        =   47396.33
                                                Prob > chi2       =     0.0000
Log likelihood = -100710.84                     Pseudo R2         =     0.1905

------------------------------------------------------------------------------------
                _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------------+----------------------------------------------------------------
              age1 |   1.163908   .0209525     8.43   0.000     1.123558    1.205708
              age2 |   .9076377   .0355817    -2.47   0.013     .8405107    .9801257
              age3 |   1.280628   .1162188     2.73   0.006     1.071951    1.529927
            1.male |   1.666731   .0272831    31.21   0.000     1.614106    1.721072
1.organ_transplant |   5.548099   .6150051    15.46   0.000     4.464663     6.89445
             _cons |   8.30e-08   5.42e-08   -24.95   0.000     2.31e-08    2.99e-07
------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail1_organ_transplant.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(5)        =   47304.80
                                                Prob > chi2       =     0.0000
Log likelihood =  -100756.6                     Pseudo R2         =     0.1901

-------------------------------------------------------------------------------------------
                       _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
--------------------------+----------------------------------------------------------------
                     age1 |   1.163412   .0209305     8.41   0.000     1.123103    1.205167
                     age2 |   .9092886   .0356254    -2.43   0.015     .8420777     .981864
                     age3 |   1.274017   .1155538     2.67   0.008     1.066525    1.521877
                   1.male |   1.667983   .0272994    31.26   0.000     1.615326    1.722356
1.other_immunosuppression |   2.852415   .3396576     8.80   0.000     2.258677     3.60223
                    _cons |   8.38e-08   5.48e-08   -24.95   0.000     2.33e-08    3.02e-07
-------------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail1_other_immunosuppression.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(5)        =   48154.19
                                                Prob > chi2       =     0.0000
Log likelihood = -100331.91                     Pseudo R2         =     0.1935

-------------------------------------------------------------------------------
           _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
--------------+----------------------------------------------------------------
         age1 |   1.168952   .0212174     8.60   0.000     1.128097    1.211286
         age2 |   .8954091   .0353469    -2.80   0.005     .8287426    .9674383
         age3 |   1.324153   .1209328     3.07   0.002     1.107132    1.583716
       1.male |   1.648677   .0269937    30.54   0.000      1.59661    1.702442
1.other_neuro |   3.217402   .1070488    35.12   0.000     3.014285    3.434206
        _cons |   7.26e-08   4.79e-08   -24.94   0.000     2.00e-08    2.64e-07
-------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail1_other_neuro.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(5)        =   47330.72
                                                Prob > chi2       =     0.0000
Log likelihood = -100743.64                     Pseudo R2         =     0.1902

------------------------------------------------------------------------------------
                _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------------+----------------------------------------------------------------
              age1 |   1.165233   .0210338     8.47   0.000     1.124728    1.207196
              age2 |   .9042384   .0355305    -2.56   0.010      .837214    .9766286
              age3 |   1.292843   .1175759     2.82   0.005     1.081768    1.545102
            1.male |   1.673684    .027395    31.47   0.000     1.620843    1.728248
1.ra_sle_psoriasis |   1.307314   .0371655     9.43   0.000     1.236463    1.382224
             _cons |   7.94e-08   5.20e-08   -24.95   0.000     2.20e-08    2.87e-07
------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail1_ra_sle_psoriasis.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 16,633,846
                                                LR chi2(6)        =   46178.10
                                                Prob > chi2       =     0.0000
Log likelihood = -99828.256                     Pseudo R2         =     0.1878

------------------------------------------------------------------------------
          _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        age1 |   1.166264   .0221524     8.10   0.000     1.123644      1.2105
        age2 |   .8949361   .0367945    -2.70   0.007     .8256493    .9700373
        age3 |   1.332196   .1263984     3.02   0.003      1.10613    1.604463
      1.male |   1.583501   .0264855    27.48   0.000     1.532432    1.636272
             |
       smoke |
     Former  |   1.376816   .0245912    17.90   0.000     1.329452    1.425867
    Current  |    1.22775    .042636     5.91   0.000     1.146965    1.314224
             |
       _cons |   7.35e-08   5.08e-08   -23.77   0.000     1.90e-08    2.85e-07
------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail1_smoke.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(6)        =   47589.33
                                                Prob > chi2       =     0.0000
Log likelihood = -100614.34                     Pseudo R2         =     0.1913

------------------------------------------------------------------------------
          _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        age1 |   1.167506   .0213876     8.45   0.000     1.126331    1.210187
        age2 |   .8950105   .0356216    -2.79   0.005     .8278471    .9676227
        age3 |   1.329154   .1223079     3.09   0.002     1.109809    1.591851
      1.male |   1.572898   .0261774    27.21   0.000     1.522419    1.625051
             |
smoke_nomiss |
     Former  |   1.381784   .0244805    18.25   0.000     1.334627    1.430608
    Current  |   1.233654   .0427368     6.06   0.000     1.152672    1.320326
             |
       _cons |   6.91e-08   4.60e-08   -24.77   0.000     1.87e-08    2.55e-07
------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail1_smoke_nomiss.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(5)        =   47253.62
                                                Prob > chi2       =     0.0000
Log likelihood = -100782.19                     Pseudo R2         =     0.1899

------------------------------------------------------------------------------
          _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        age1 |    1.16422   .0209657     8.44   0.000     1.123844    1.206045
        age2 |   .9076338   .0355912    -2.47   0.013     .8404897    .9801419
        age3 |   1.279444   .1161384     2.71   0.007     1.070916    1.528576
      1.male |     1.6688   .0273114    31.29   0.000      1.61612    1.723197
    1.spleen |   1.423547   .2007173     2.50   0.012     1.079827    1.876677
       _cons |   8.24e-08   5.39e-08   -24.95   0.000     2.29e-08    2.97e-07
------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail1_spleen.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(5)        =   49092.84
                                                Prob > chi2       =     0.0000
Log likelihood = -99862.581                     Pseudo R2         =     0.1973

-----------------------------------------------------------------------------------
               _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
             age1 |   1.160983   .0208064     8.33   0.000     1.120911    1.202487
             age2 |   .9151698    .035748    -2.27   0.023     .8477199    .9879865
             age3 |   1.237411   .1119518     2.35   0.019     1.036343     1.47749
           1.male |   1.633892   .0267852    29.95   0.000     1.582229    1.687243
1.stroke_dementia |   2.529452   .0505129    46.47   0.000     2.432361    2.630418
            _cons |   9.07e-08   5.90e-08   -24.93   0.000     2.54e-08    3.25e-07
-----------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail1_stroke_dementia.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(4)        =   47248.01
                                                Prob > chi2       =     0.0000
Log likelihood = -100784.99                     Pseudo R2         =     0.1899

------------------------------------------------------------------------------
          _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        age1 |   1.164191   .0209638     8.44   0.000     1.123819    1.206013
        age2 |   .9077716   .0355945    -2.47   0.014      .840621    .9802863
        age3 |   1.278873   .1160803     2.71   0.007     1.070449    1.527879
      1.male |   1.669169   .0273168    31.31   0.000     1.616479    1.723577
       _cons |   8.25e-08   5.39e-08   -24.95   0.000     2.29e-08    2.97e-07
------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail1_SEX.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(6)        =   43788.10
                                                Prob > chi2       =     0.0000
Log likelihood = -102514.95                     Pseudo R2         =     0.1760

------------------------------------------------------------------------------
          _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
    agegroup |
     40-<50  |   5.818094   .7985835    12.83   0.000      4.44576    7.614046
     50-<60  |   18.44281   2.285078    23.52   0.000     14.46647    23.51211
     60-<70  |   51.33461   6.194914    32.64   0.000     40.52189    65.03255
     70-<80  |   153.0277   18.21693    42.26   0.000     121.1826    193.2413
        80+  |    727.874   86.11642    55.70   0.000     577.2296    917.8332
             |
      1.male |   1.530878   .0248286    26.26   0.000     1.482981    1.580323
       _cons |   9.53e-06   1.13e-06   -97.75   0.000     7.56e-06     .000012
------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail1_AGEGROUP.ster saved
(covid vs noncovid ()2020))

                id:  patient_id
     failure event:  onsdeath == 2
obs. time interval:  (stime_onsdeath[_n-1], stime_onsdeath]
 enter on or after:  time enter_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time enter_date

------------------------------------------------------------------------------
   17362187  total observations
      4,578  observations end on or before enter()
------------------------------------------------------------------------------
   17357609  observations remaining, representing
   17357609  subjects
     83,067  failures in single-failure-per-subject data
 3.0458e+09  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =       176

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(6)        =  233727.18
                                                Prob > chi2       =     0.0000
Log likelihood = -409759.77                     Pseudo R2         =     0.2219

-------------------------------------------------------------------------------
           _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
--------------+----------------------------------------------------------------
         age1 |   1.160534   .0069214    24.96   0.000     1.147047     1.17418
         age2 |   .8653376   .0115991   -10.79   0.000     .8428998    .8883728
         age3 |   1.487564   .0468264    12.62   0.000      1.39856    1.582233
       1.male |   1.315109   .0094117    38.27   0.000     1.296791    1.333685
              |
    asthmacat |
 Yes, no OCS  |   1.013999   .0117812     1.20   0.231     .9911693    1.037355
Yes with OCS  |   1.240736   .0280737     9.53   0.000     1.186915    1.296998
              |
        _cons |   1.05e-06   2.24e-07   -64.50   0.000     6.92e-07    1.60e-06
-------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail2_asthmacat.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(7)        =  258511.44
                                                Prob > chi2       =     0.0000
Log likelihood = -397367.64                     Pseudo R2         =     0.2454

-----------------------------------------------------------------------------------
               _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
             age1 |   1.183991   .0073348    27.26   0.000     1.169702    1.198455
             age2 |   .8040531   .0111343   -15.75   0.000     .7825237    .8261748
             age3 |   1.802982   .0584862    18.17   0.000     1.691919    1.921336
           1.male |   1.224282    .008837    28.03   0.000     1.207083    1.241725
                  |
cancer_exhaem_cat |
       Last year  |   10.99619   .1577486   167.13   0.000     10.69131    11.30975
   2-5 years ago  |   3.555428   .0459988    98.05   0.000     3.466405    3.646736
        5+ years  |   1.583491   .0171021    42.56   0.000     1.550324    1.617367
                  |
            _cons |   5.95e-07   1.32e-07   -64.53   0.000     3.85e-07    9.20e-07
-----------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail2_cancer_exhaem_cat.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(7)        =  235712.90
                                                Prob > chi2       =     0.0000
Log likelihood = -408766.91                     Pseudo R2         =     0.2238

---------------------------------------------------------------------------------
             _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
----------------+----------------------------------------------------------------
           age1 |   1.162786   .0069599    25.20   0.000     1.149224    1.176507
           age2 |    .859627   .0115577   -11.25   0.000     .8372703    .8825807
           age3 |   1.512745   .0477513    13.11   0.000      1.42199    1.609291
         1.male |   1.301622   .0093143    36.84   0.000     1.283493    1.320006
                |
cancer_haem_cat |
     Last year  |   5.994127   .2757497    38.93   0.000     5.477317    6.559701
 2-5 years ago  |   2.850275   .0984376    30.33   0.000     2.663726    3.049888
      5+ years  |   1.838892   .0521794    21.47   0.000     1.739414    1.944059
                |
          _cons |   1.00e-06   2.14e-07   -64.50   0.000     6.58e-07    1.52e-06
---------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail2_cancer_haem_cat.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(5)        =  238426.64
                                                Prob > chi2       =     0.0000
Log likelihood = -407410.04                     Pseudo R2         =     0.2264

-------------------------------------------------------------------------------------------
                       _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
--------------------------+----------------------------------------------------------------
                     age1 |   1.164322   .0069846    25.36   0.000     1.150712    1.178092
                     age2 |   .8542689   .0115098   -11.69   0.000     .8320053    .8771281
                     age3 |    1.52359   .0481896    13.31   0.000     1.432008    1.621029
                   1.male |   1.230208    .008884    28.69   0.000     1.212918    1.247744
1.chronic_cardiac_disease |   1.736022   .0135152    70.85   0.000     1.709734    1.762714
                    _cons |   9.91e-07   2.13e-07   -64.39   0.000     6.51e-07    1.51e-06
-------------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail2_chronic_cardiac_disease.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(6)        =  238838.43
                                                Prob > chi2       =     0.0000
Log likelihood = -407204.14                     Pseudo R2         =     0.2268

-----------------------------------------------------------------------------------------------
                           _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------------+----------------------------------------------------------------
                         age1 |   1.151491   .0067739    23.98   0.000     1.138291    1.164845
                         age2 |   .8887319   .0117873    -8.89   0.000      .865927    .9121374
                         age3 |   1.366547   .0426401    10.01   0.000     1.285478    1.452728
                       1.male |   1.298765   .0093033    36.49   0.000     1.280658    1.317128
                              |
  reduced_kidney_function_cat |
Stage 3a/3b egfr 30-60        |    1.27738   .0108565    28.80   0.000     1.256277    1.298836
           Stage 4/5 egfr<30  |   3.254571   .0488615    78.60   0.000       3.1602    3.351761
                              |
                        _cons |   1.35e-06   2.83e-07   -64.30   0.000     8.91e-07    2.03e-06
-----------------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail2_reduced_kidney_function_cat.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(5)        =  235077.89
                                                Prob > chi2       =     0.0000
Log likelihood = -409084.41                     Pseudo R2         =     0.2232

------------------------------------------------------------------------------
          _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        age1 |   1.160861    .006928    24.99   0.000     1.147361    1.174519
        age2 |   .8639795   .0115877   -10.90   0.000     .8415639    .8869922
        age3 |   1.494496   .0470704    12.76   0.000      1.40503    1.589659
      1.male |   1.305984   .0093432    37.32   0.000     1.287799    1.324425
  1.dialysis |   5.691543    .211882    46.71   0.000      5.29105     6.12235
       _cons |   1.05e-06   2.24e-07   -64.48   0.000     6.91e-07    1.60e-06
------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail2_dialysis.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(5)        =  236761.44
                                                Prob > chi2       =     0.0000
Log likelihood = -408242.63                     Pseudo R2         =     0.2248

-----------------------------------------------------------------------------------------
                     _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------+----------------------------------------------------------------
                   age1 |   1.161069   .0069368    25.00   0.000     1.147552    1.174745
                   age2 |    .861335   .0115629   -11.12   0.000     .8389676    .8842987
                   age3 |   1.510474   .0476144    13.08   0.000     1.419976     1.60674
                 1.male |   1.309439     .00937    37.68   0.000     1.291203    1.327933
1.chronic_liver_disease |   4.460532   .0990894    67.31   0.000     4.270488    4.659034
                  _cons |   1.04e-06   2.22e-07   -64.45   0.000     6.83e-07    1.58e-06
-----------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail2_chronic_liver_disease.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(5)        =  241204.97
                                                Prob > chi2       =     0.0000
Log likelihood = -406020.87                     Pseudo R2         =     0.2290

-----------------------------------------------------------------------------------------------
                           _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------------+----------------------------------------------------------------
                         age1 |   1.175742   .0071823    26.50   0.000     1.161749    1.189904
                         age2 |   .8263003   .0113048   -13.95   0.000     .8044378     .848757
                         age3 |   1.675628   .0537459    16.09   0.000     1.573531     1.78435
                       1.male |   1.269212   .0090943    33.27   0.000     1.251512    1.287162
1.chronic_respiratory_disease |    2.27291   .0199876    93.37   0.000     2.234071    2.312424
                        _cons |   7.25e-07   1.59e-07   -64.60   0.000     4.72e-07    1.11e-06
-----------------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail2_chronic_respiratory_disease.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(7)        =  236686.41
                                                Prob > chi2       =     0.0000
Log likelihood = -408280.15                     Pseudo R2         =     0.2247

---------------------------------------------------------------------------------------------
                         _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
----------------------------+----------------------------------------------------------------
                       age1 |   1.163991   .0069867    25.30   0.000     1.150378    1.177766
                       age2 |   .8516862   .0114838   -11.91   0.000     .8294732     .874494
                       age3 |    1.55334   .0491752    13.91   0.000     1.459887    1.652774
                     1.male |   1.283932   .0092092    34.84   0.000     1.266008    1.302109
                            |
                    diabcat |
       Controlled diabetes  |   1.308186   .0123978    28.35   0.000     1.284111    1.332713
     Uncontrolled diabetes  |   1.774431   .0235674    43.18   0.000     1.728835    1.821228
Diabetes, no hba1c measure  |   2.045311   .0401347    36.47   0.000     1.968142    2.125506
                            |
                      _cons |   9.70e-07   2.08e-07   -64.46   0.000     6.37e-07    1.48e-06
---------------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail2_diabcat.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 12,783,591
                                                LR chi2(8)        =  165835.02
                                                Prob > chi2       =     0.0000
Log likelihood = -292394.41                     Pseudo R2         =     0.2209

-----------------------------------------------------------------------------------------
                     _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------+----------------------------------------------------------------
                   age1 |     1.1788   .0089132    21.76   0.000     1.161459      1.1964
                   age2 |   .8298139   .0138991   -11.14   0.000     .8030144    .8575077
                   age3 |   1.654537   .0646645    12.88   0.000     1.532529    1.786257
                 1.male |   1.340381   .0113737    34.52   0.000     1.318273    1.362859
                        |
              ethnicity |
                 Mixed  |   .7488203   .0550143    -3.94   0.000     .6483979    .8647959
Asian or Asian British  |   .7950557   .0197184    -9.25   0.000     .7573327    .8346578
                 Black  |     .84604   .0340505    -4.15   0.000     .7818666    .9154806
                 Other  |   .6383142   .0356228    -8.04   0.000     .5721778    .7120952
                        |
                  _cons |   6.39e-07   1.74e-07   -52.41   0.000     3.75e-07    1.09e-06
-----------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail2_ethnicity.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(5)        =  233697.07
                                                Prob > chi2       =     0.0000
Log likelihood = -409774.82                     Pseudo R2         =     0.2219

------------------------------------------------------------------------------------
                _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------------+----------------------------------------------------------------
              age1 |   1.160857   .0069302    24.99   0.000     1.147354     1.17452
              age2 |   .8625559     .01158   -11.01   0.000     .8401554    .8855536
              age3 |   1.500283   .0473092    12.86   0.000     1.410366    1.595933
            1.male |   1.313471   .0093923    38.13   0.000     1.295191    1.332009
1.htdiag_or_highbp |   1.063451   .0087904     7.44   0.000     1.046361    1.080821
             _cons |   1.04e-06   2.23e-07   -64.48   0.000     6.86e-07    1.59e-06
------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail2_htdiag_or_highbp.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 15,635,073
                                                LR chi2(7)        =  227304.13
                                                Prob > chi2       =     0.0000
Log likelihood =  -402252.3                     Pseudo R2         =     0.2203

---------------------------------------------------------------------------------
             _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
----------------+----------------------------------------------------------------
           age1 |   1.159764   .0075149    22.87   0.000     1.145129    1.174587
           age2 |   .8828523   .0126941    -8.67   0.000     .8583196    .9080861
           age3 |   1.396404   .0468947     9.94   0.000     1.307452    1.491408
         1.male |   1.314625   .0094323    38.13   0.000     1.296267    1.333242
                |
          bpcat |
      Elevated  |   .5540105   .0063184   -51.78   0.000      .541764    .5665338
 High, stage I  |   .4449884    .004359   -82.66   0.000     .4365264    .4536145
High, stage II  |   .4234922   .0041454   -87.78   0.000     .4154449    .4316955
                |
          _cons |   1.76e-06   4.10e-07   -56.82   0.000     1.11e-06    2.78e-06
---------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail2_bpcat.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(5)        =  234438.17
                                                Prob > chi2       =     0.0000
Log likelihood = -409404.27                     Pseudo R2         =     0.2226

--------------------------------------------------------------------------------
            _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
---------------+----------------------------------------------------------------
          age1 |   1.164612   .0069918    25.38   0.000     1.150989    1.178397
          age2 |   .8507397   .0114764   -11.98   0.000      .828541    .8735331
          age3 |   1.551813   .0491442    13.88   0.000     1.458421    1.651186
        1.male |   1.316134   .0094154    38.40   0.000     1.297809    1.334718
1.hypertension |     1.2428   .0096445    28.01   0.000      1.22404    1.261848
         _cons |   9.49e-07   2.04e-07   -64.54   0.000     6.23e-07    1.45e-06
--------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail2_hypertension.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(8)        =  236483.03
                                                Prob > chi2       =     0.0000
Log likelihood = -408381.84                     Pseudo R2         =     0.2245

----------------------------------------------------------------------------------
              _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-----------------+----------------------------------------------------------------
            age1 |   1.160357   .0069224    24.93   0.000     1.146869    1.174004
            age2 |   .8707305   .0116812   -10.32   0.000     .8481342    .8939288
            age3 |   1.460421   .0460187    12.02   0.000     1.372955    1.553459
          1.male |   1.319175   .0094414    38.70   0.000     1.300799     1.33781
                 |
             imd |
              2  |   1.116642   .0125319     9.83   0.000     1.092349    1.141477
              3  |   1.231463   .0137368    18.66   0.000     1.204831    1.258683
              4  |   1.425719   .0160399    31.53   0.000     1.394625    1.457506
5 most deprived  |   1.741957   .0198288    48.76   0.000     1.703523    1.781257
                 |
           _cons |   7.91e-07   1.69e-07   -65.80   0.000     5.20e-07    1.20e-06
----------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail2_imd.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(7)        =  234286.22
                                                Prob > chi2       =     0.0000
Log likelihood = -409480.25                     Pseudo R2         =     0.2224

-------------------------------------------------------------------------------------
                 _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
--------------------+----------------------------------------------------------------
               age1 |    1.15925   .0068964    24.84   0.000     1.145812    1.172846
               age2 |   .8695544   .0116341   -10.45   0.000     .8470484    .8926584
               age3 |   1.467688   .0461333    12.21   0.000     1.379997    1.560951
             1.male |   1.322041   .0094738    38.96   0.000     1.303603    1.340741
                    |
          obese4cat |
 Obese I (30-34.9)  |   .8242069   .0089095   -17.89   0.000     .8069283    .8418555
Obese II (35-39.9)  |   1.048279   .0176857     2.79   0.005     1.014182    1.083522
   Obese III (40+)  |   1.483847    .034838    16.81   0.000     1.417113    1.553724
                    |
              _cons |   1.09e-06   2.33e-07   -64.51   0.000     7.20e-07    1.66e-06
-------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail2_obese4cat.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 13,616,543
                                                LR chi2(9)        =  199049.88
                                                Prob > chi2       =     0.0000
Log likelihood = -359900.48                     Pseudo R2         =     0.2166

---------------------------------------------------------------------------------------
                   _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
----------------------+----------------------------------------------------------------
                 age1 |   1.173966   .0085149    22.11   0.000     1.157395    1.190774
                 age2 |    .850246   .0135984   -10.14   0.000     .8240071    .8773205
                 age3 |   1.526997   .0568784    11.36   0.000      1.41949    1.642647
               1.male |   1.485482   .0114345    51.41   0.000     1.463239    1.508063
                      |
               bmicat |
  Normal (18.5-24.9)  |   .3627215    .005479   -67.14   0.000     .3521403    .3736206
Overweight (25-29.9)  |   .2394669   .0037623   -90.98   0.000     .2322054    .2469555
   Obese I (30-34.9)  |   .2586036   .0044898   -77.90   0.000     .2499518    .2675548
  Obese II (35-39.9)  |   .3295779   .0071362   -51.26   0.000     .3158837    .3438657
     Obese III (40+)  |    .465695    .012635   -28.17   0.000     .4415777    .4911294
                      |
                _cons |   2.15e-06   5.63e-07   -49.82   0.000     1.29e-06    3.59e-06
---------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail2_bmicat.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(5)        =  233975.85
                                                Prob > chi2       =     0.0000
Log likelihood = -409635.43                     Pseudo R2         =     0.2221

------------------------------------------------------------------------------------
                _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------------+----------------------------------------------------------------
              age1 |   1.160174   .0069155    24.92   0.000     1.146699    1.173808
              age2 |    .865919   .0116019   -10.74   0.000     .8434756    .8889596
              age3 |   1.485485   .0467427    12.58   0.000     1.396639    1.579983
            1.male |   1.311118   .0093745    37.89   0.000     1.292872    1.329621
1.organ_transplant |   3.746057   .2261818    21.87   0.000     3.327974    4.216662
             _cons |   1.07e-06   2.28e-07   -64.48   0.000     7.03e-07    1.62e-06
------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail2_organ_transplant.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(5)        =  234025.57
                                                Prob > chi2       =     0.0000
Log likelihood = -409610.57                     Pseudo R2         =     0.2222

-------------------------------------------------------------------------------------------
                       _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
--------------------------+----------------------------------------------------------------
                     age1 |   1.159469   .0069055    24.84   0.000     1.146013    1.173083
                     age2 |   .8676247   .0116162   -10.61   0.000     .8451535    .8906934
                     age3 |   1.477944   .0464735    12.42   0.000     1.389607    1.571896
                   1.male |   1.311243   .0093751    37.90   0.000     1.292997    1.329748
1.other_immunosuppression |    3.19027   .1611993    22.96   0.000     2.889466    3.522389
                    _cons |   1.08e-06   2.31e-07   -64.47   0.000     7.14e-07    1.65e-06
-------------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail2_other_immunosuppression.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(5)        =  236601.16
                                                Prob > chi2       =     0.0000
Log likelihood = -408322.78                     Pseudo R2         =     0.2246

-------------------------------------------------------------------------------
           _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
--------------+----------------------------------------------------------------
         age1 |   1.163116   .0069662    25.23   0.000     1.149542     1.17685
         age2 |   .8584671   .0115479   -11.34   0.000     .8361293    .8814016
         age3 |   1.518171   .0479451    13.22   0.000     1.427049    1.615111
       1.male |   1.301016   .0093082    36.78   0.000       1.2829    1.319388
1.other_neuro |   2.755894   .0453494    61.61   0.000     2.668429    2.846226
        _cons |   9.87e-07   2.12e-07   -64.52   0.000     6.49e-07    1.50e-06
-------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail2_other_neuro.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(5)        =  233900.10
                                                Prob > chi2       =     0.0000
Log likelihood = -409673.31                     Pseudo R2         =     0.2221

------------------------------------------------------------------------------------
                _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------------+----------------------------------------------------------------
              age1 |    1.16085   .0069302    24.98   0.000     1.147346    1.174513
              age2 |   .8639548   .0115906   -10.90   0.000     .8415336    .8869733
              age3 |   1.494398   .0470792    12.75   0.000     1.404915     1.58958
            1.male |   1.315146   .0094035    38.31   0.000     1.296844    1.333706
1.ra_sle_psoriasis |   1.235398   .0158018    16.53   0.000     1.204812     1.26676
             _cons |   1.04e-06   2.22e-07   -64.49   0.000     6.85e-07    1.58e-06
------------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail2_ra_sle_psoriasis.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 16,633,846
                                                LR chi2(6)        =  232931.83
                                                Prob > chi2       =     0.0000
Log likelihood = -403792.41                     Pseudo R2         =     0.2239

------------------------------------------------------------------------------
          _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        age1 |   1.164561   .0074872    23.70   0.000     1.149978    1.179329
        age2 |   .8606611   .0123098   -10.49   0.000     .8368694    .8851292
        age3 |   1.515159   .0506413    12.43   0.000     1.419085    1.617737
      1.male |   1.238616   .0090398    29.32   0.000     1.221025    1.256461
             |
       smoke |
     Former  |    1.36328   .0109267    38.66   0.000     1.342032    1.384865
    Current  |   2.568252   .0307904    78.68   0.000     2.508608    2.629315
             |
       _cons |   6.68e-07   1.54e-07   -61.56   0.000     4.24e-07    1.05e-06
------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail2_smoke.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(6)        =  239484.75
                                                Prob > chi2       =     0.0000
Log likelihood = -406880.98                     Pseudo R2         =     0.2274

------------------------------------------------------------------------------
          _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        age1 |   1.156044   .0069857    24.00   0.000     1.142433    1.169817
        age2 |   .8755569    .011882    -9.79   0.000     .8525757    .8991577
        age3 |   1.454556   .0463242    11.77   0.000     1.366538    1.548244
      1.male |   1.230449   .0089416    28.54   0.000     1.213048      1.2481
             |
smoke_nomiss |
     Former  |   1.371351   .0109167    39.67   0.000     1.350121    1.392915
    Current  |   2.580214   .0308205    79.35   0.000     2.520509    2.641334
             |
       _cons |   8.61e-07   1.86e-07   -64.59   0.000     5.63e-07    1.32e-06
------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail2_smoke_nomiss.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(5)        =  233814.18
                                                Prob > chi2       =     0.0000
Log likelihood = -409716.27                     Pseudo R2         =     0.2220

------------------------------------------------------------------------------
          _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        age1 |   1.160351   .0069182    24.94   0.000     1.146871     1.17399
        age2 |   .8657659   .0116019   -10.76   0.000     .8433226    .8888065
        age3 |   1.485547   .0467517    12.58   0.000     1.396684    1.580064
      1.male |   1.311611    .009377    37.94   0.000     1.293361    1.330119
    1.spleen |    2.15219   .1127292    14.63   0.000     1.942207    2.384874
       _cons |   1.06e-06   2.27e-07   -64.48   0.000     7.00e-07    1.61e-06
------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail2_spleen.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(5)        =  239149.12
                                                Prob > chi2       =     0.0000
Log likelihood =  -407048.8                     Pseudo R2         =     0.2271

-----------------------------------------------------------------------------------
               _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------+----------------------------------------------------------------
             age1 |   1.158262   .0068849    24.72   0.000     1.144846    1.171835
             age2 |   .8706697   .0116421   -10.36   0.000     .8481481    .8937893
             age3 |   1.450884   .0455822    11.85   0.000      1.36424    1.543032
           1.male |   1.291601   .0092553    35.71   0.000     1.273587    1.309869
1.stroke_dementia |   2.127433   .0202707    79.23   0.000     2.088071    2.167536
            _cons |   1.13e-06   2.41e-07   -64.40   0.000     7.46e-07    1.72e-06
-----------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail2_stroke_dementia.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(4)        =  233641.25
                                                Prob > chi2       =     0.0000
Log likelihood = -409802.73                     Pseudo R2         =     0.2218

------------------------------------------------------------------------------
          _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
        age1 |   1.160286   .0069167    24.94   0.000     1.146809    1.173922
        age2 |   .8661012   .0116048   -10.73   0.000     .8436523    .8891475
        age3 |   1.483821   .0466913    12.54   0.000     1.395072    1.578215
      1.male |   1.312352   .0093817    38.02   0.000     1.294093    1.330869
       _cons |   1.07e-06   2.27e-07   -64.49   0.000     7.01e-07    1.62e-06
------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail2_SEX.ster saved

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(6)        =  212100.28
                                                Prob > chi2       =     0.0000
Log likelihood = -420573.21                     Pseudo R2         =     0.2014

------------------------------------------------------------------------------
          _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
    agegroup |
     40-<50  |   4.946778   .2287441    34.57   0.000     4.518164    5.416053
     50-<60  |   12.75146   .5312559    61.10   0.000      11.7516     13.8364
     60-<70  |   34.83525    1.39954    88.38   0.000     32.19742    37.68919
     70-<80  |   90.69129   3.579971   114.19   0.000     83.93924    97.98647
        80+  |   399.9565   15.63725   153.24   0.000     370.4529    431.8098
             |
      1.male |   1.207324   .0085243    26.68   0.000     1.190731    1.224147
       _cons |   .0001011   3.94e-06  -235.83   0.000     .0000936    .0001091
------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail2_AGEGROUP.ster saved

. 
end of do-file

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  e:\analyses\covid-vs-noncovid-deaths-research\analysis\output/an_covidvsnoncovid_agesex.log
  log type:  text
 opened on:  10 Sep 2020, 13:41:53

. 
.         cap prog drop baselogistic 

.         prog define baselogistic
  1.                 syntax , age(string) addvariable(string)
  2. 
.         cap logistic _d `age'                   ///
>                                 i.male                          ///
>                                 i.`addvariable'                 
  3.         end                     

.         
.         
. foreach failindicator of numlist 1 2 {
  2. 
.         use cr_create_analysis_dataset, clear
  3.         stset stime_onsdeath, fail(onsdeath==`failindicator') id(patient_id) enter(enter_date) origin(enter_date)
  4. /*
>         foreach addvariable of any asthmacat    ///
>                 cancer_exhaem_cat                                       ///
>                 cancer_haem_cat                                         ///
>                 chronic_cardiac_disease                         ///
>                 reduced_kidney_function_cat                     ///
>                 dialysis                                                        ///
>                 chronic_liver_disease                           ///
>                 chronic_respiratory_disease             ///
>                 diabcat                                                         ///
>                 ethnicity                                                       ///
>                 htdiag_or_highbp                                        ///
>                  bpcat                                                          ///
>                  hypertension                                           ///
>                 imd                                                             ///
>                 obese4cat                                                       ///
>                  bmicat                                                         ///
>                 organ_transplant                                        ///
>                 other_immunosuppression                         ///
>                 other_neuro                                             ///
>                 ra_sle_psoriasis                                        ///  
>                 smoke                                                           ///
>                 smoke_nomiss                                            ///
>                 spleen                                                          ///
>                 stroke_dementia {
>                         baselogistic, age("age1 age2 age3")  addvariable("i.`addvariable'") 
>                         if _rc==0{
>                         estimates
>                         estimates save ./output/models/an_covidvsnoncovid_agesex_fail`failindicator'_`addvariable', replace
>                         }
>                 else di "MODEL DID NOT FIT (adding `addvariable')"
>          }
> 
>          cap logistic _d age1 age2 age3 i.male
>                         if _rc==0{
>                         estimates
>                         estimates save ./output/models/an_covidvsnoncovid_agesex_fail`failindicator'_SEX, replace
>                         }
>         */
.          cap logistic _d ib3.agegroup i.male
  5.                         if _rc==0{
  6.                         estimates
  7.                         estimates save ./output/models/an_covidvsnoncovid_agesex_fail`failindicator'_AGEGROUP, replace
  8.                         }
  9.          
. }
(covid vs noncovid ()2020))

                id:  patient_id
     failure event:  onsdeath == 1
obs. time interval:  (stime_onsdeath[_n-1], stime_onsdeath]
 enter on or after:  time enter_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time enter_date

------------------------------------------------------------------------------
   17362187  total observations
      4,578  observations end on or before enter()
------------------------------------------------------------------------------
   17357609  observations remaining, representing
   17357609  subjects
     15,513  failures in single-failure-per-subject data
 3.0458e+09  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =       176

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
active results
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(6)        =   43788.10
                                                Prob > chi2       =     0.0000
Log likelihood = -102514.95                     Pseudo R2         =     0.1760

------------------------------------------------------------------------------
          _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
    agegroup |
     18-<40  |   .0542217   .0067181   -23.52   0.000     .0425313    .0691254
     40-<50  |   .3154668   .0252634   -14.41   0.000     .2696419    .3690795
     60-<70  |   2.783448   .1286483    22.15   0.000     2.542386    3.047368
     70-<80  |   8.297419   .3465588    50.66   0.000     7.645235    9.005238
        80+  |   39.46655   1.564186    92.74   0.000     36.51685    42.65451
             |
      1.male |   1.530878   .0248286    26.26   0.000     1.482981    1.580323
       _cons |   .0001757   6.94e-06  -218.85   0.000     .0001626    .0001899
------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail1_AGEGROUP.ster saved
(covid vs noncovid ()2020))

                id:  patient_id
     failure event:  onsdeath == 2
obs. time interval:  (stime_onsdeath[_n-1], stime_onsdeath]
 enter on or after:  time enter_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time enter_date

------------------------------------------------------------------------------
   17362187  total observations
      4,578  observations end on or before enter()
------------------------------------------------------------------------------
   17357609  observations remaining, representing
   17357609  subjects
     83,067  failures in single-failure-per-subject data
 3.0458e+09  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =       176

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
active results
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Logistic regression                             Number of obs     = 17,357,609
                                                LR chi2(6)        =  212100.28
                                                Prob > chi2       =     0.0000
Log likelihood = -420573.21                     Pseudo R2         =     0.2014

------------------------------------------------------------------------------
          _d | Odds Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
    agegroup |
     18-<40  |   .0784224   .0032673   -61.10   0.000     .0722731    .0850948
     40-<50  |    .387938   .0113875   -32.26   0.000     .3662489    .4109116
     60-<70  |   2.731863   .0501886    54.70   0.000     2.635245    2.832023
     70-<80  |   7.112225   .1193525   116.90   0.000     6.882104    7.350042
        80+  |   31.36553   .4978769   217.07   0.000     30.40474    32.35669
             |
      1.male |   1.207324   .0085243    26.68   0.000     1.190731    1.224147
       _cons |   .0012888   .0000202  -425.17   0.000     .0012499    .0013289
------------------------------------------------------------------------------
Note: _cons estimates baseline odds.
file ./output/models/an_covidvsnoncovid_agesex_fail2_AGEGROUP.ster saved

. 
end of do-file

. do "E:\analyses\covid-vs-noncovid-deaths-research\analysis\an_table_covidvsnoncovid_agesex.do"

. 
. 
. *Coding: Krishnan Bhaskaran
. *
. *Date drafted: 10/9/2020
. *************************************************************************
. 
. 
. ***********************************************************************************************************************
. *Generic code to ouput the HRs across outcomes for all levels of a particular variables, in the right shape for table
. cap prog drop outputHRsforvar

. prog define outputHRsforvar
  1. syntax, variable(string) min(real) max(real) 
  2. forvalues i=`min'/`max'{
  3. local endwith "_tab"
  4. 
.         *put the varname and condition to left so that alignment can be checked vs shell
.         file write tablecontents ("`variable'") _tab ("`i'") _tab
  5.         
.         foreach failn of numlist 1 2 3 {
  6.         
.                 if `failn'==1 local outcome "COV"
  7.                 else if `failn'==2 local outcome "NONCOV"
  8.                 else if `failn'==3 local outcome "NONCOV_2019"
  9.                 
.                 local noestimatesflag 0 /*reset*/
 10. 
. *CHANGE THE OUTCOME BELOW TO LAST IF BRINGING IN MORE COLS
.                 if `failn'==2 local endwith "_n"
 11. 
.                 ***********************
.                 *1) GET THE RIGHT ESTIMATES INTO MEMORY
. 
.                 
. 
.                 *FOR AGEGROUP - need to use the separate univariate/multivariate model fitted with age group rather than spline
.                 *FOR ETHNICITY - use the separate complete case multivariate model
.                 *FOR REST - use the "main" multivariate model
.                 if `failn'==3{
 12.                                 if "`variable'"=="agegroup" {
 13.                                 cap estimates use ./output/models/an_noncovid_2019_agesex_AGEGROUP
 14.                                 if _rc!=0 local noestimatesflag 1
 15.                                 }
 16.                                 else {
 17.                                 cap estimates use ./output/models/an_noncovid_2019_agesex_`variable'
 18.                                 if _rc!=0 local noestimatesflag 1
 19.                                 }
 20.                 
.                 }
 21.                 else{
 22.                                 if "`variable'"=="agegroup" {
 23.                                 cap estimates use ./output/models/an_covidvsnoncovid_agesex_fail`failn'_AGEGROUP
 24.                                 if _rc!=0 local noestimatesflag 1
 25.                                 }       
 26.                                 else {
 27.                                 cap estimates use ./output/models/an_covidvsnoncovid_agesex_fail`failn'_`variable'
 28.                                 if _rc!=0 local noestimatesflag 1
 29.                                 }
 30.                 }
 31.                 ***********************
.                 *2) WRITE THE HRs TO THE OUTPUT FILE
.                 
.                 if `noestimatesflag'==0{
 32.                         cap lincom `i'.`variable', eform
 33.                         if _rc==0 file write tablecontents %4.2f (r(estimate)) (" (") %4.2f (r(lb)) ("-") %4.2f (r(ub)) (")") `endwith'
 34.                                 else file write tablecontents %4.2f ("ERR IN MODEL") `endwith'
 35.                         }
 36.                         else file write tablecontents %4.2f ("DID NOT FIT") `endwith' 
 37.                         
.                 *3) Save the estimates for plotting
.                 if `noestimatesflag'==0{
 38.                                 local hr = r(estimate)
 39.                                 local lb = r(lb)
 40.                                 local ub = r(ub)
 41.                                 cap gen `variable'=.
 42.                                 testparm i.`variable'
 43.                                 post HRestimates ("`outcome'") ("`variable'") (`i') (`hr') (`lb') (`ub') (r(p))
 44.                                 drop `variable'
 45.                                 }       
 46.                 } /*failn 1 2 */
 47.                 
. } /*variable levels*/
 48. 
. end

. ***********************************************************************************************************************
. *Generic code to write a full row of "ref category" to the output file
. cap prog drop refline

. prog define refline
  1. file write tablecontents _tab _tab ("1.00 (ref)") _tab ("1.00 (ref)")  _n
  2. *post HRestimates ("`outcome'") ("`variable'") (`refcat') (1) (1) (1) (.)
. end

. ***********************************************************************************************************************
. 
. *MAIN CODE TO PRODUCE TABLE CONTENTS
. 
. cap file close tablecontents

. file open tablecontents using ./output/an_table_covidvsnoncovid_agesex.txt, t w replace 

. 
. tempfile HRestimates

. cap postutil clear

. postfile HRestimates str11 outcome str27 variable level hr lci uci pval using `HRestimates'

. 
. *Age group
. outputHRsforvar, variable("agegroup") min(1) max(2) 

 ( 1)  [_d]1.agegroup = 0
 ( 2)  [_d]2.agegroup = 0
 ( 3)  [_d]4.agegroup = 0
 ( 4)  [_d]5.agegroup = 0
 ( 5)  [_d]6.agegroup = 0

           chi2(  5) =24315.89
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.agegroup = 0
 ( 2)  [_d]2.agegroup = 0
 ( 3)  [_d]4.agegroup = 0
 ( 4)  [_d]5.agegroup = 0
 ( 5)  [_d]6.agegroup = 0

           chi2(  5) = 1.3e+05
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.agegroup = 0
 ( 2)  [_d]3.agegroup = 0
 ( 3)  [_d]4.agegroup = 0
 ( 4)  [_d]5.agegroup = 0
 ( 5)  [_d]6.agegroup = 0

           chi2(  5) = 1.1e+05
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.agegroup = 0
 ( 2)  [_d]2.agegroup = 0
 ( 3)  [_d]4.agegroup = 0
 ( 4)  [_d]5.agegroup = 0
 ( 5)  [_d]6.agegroup = 0

           chi2(  5) =24315.89
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.agegroup = 0
 ( 2)  [_d]2.agegroup = 0
 ( 3)  [_d]4.agegroup = 0
 ( 4)  [_d]5.agegroup = 0
 ( 5)  [_d]6.agegroup = 0

           chi2(  5) = 1.3e+05
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.agegroup = 0
 ( 2)  [_d]3.agegroup = 0
 ( 3)  [_d]4.agegroup = 0
 ( 4)  [_d]5.agegroup = 0
 ( 5)  [_d]6.agegroup = 0

           chi2(  5) = 1.1e+05
         Prob > chi2 =    0.0000

. refline

. outputHRsforvar, variable("agegroup") min(4) max(6) 

 ( 1)  [_d]1.agegroup = 0
 ( 2)  [_d]2.agegroup = 0
 ( 3)  [_d]4.agegroup = 0
 ( 4)  [_d]5.agegroup = 0
 ( 5)  [_d]6.agegroup = 0

           chi2(  5) =24315.89
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.agegroup = 0
 ( 2)  [_d]2.agegroup = 0
 ( 3)  [_d]4.agegroup = 0
 ( 4)  [_d]5.agegroup = 0
 ( 5)  [_d]6.agegroup = 0

           chi2(  5) = 1.3e+05
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.agegroup = 0
 ( 2)  [_d]3.agegroup = 0
 ( 3)  [_d]4.agegroup = 0
 ( 4)  [_d]5.agegroup = 0
 ( 5)  [_d]6.agegroup = 0

           chi2(  5) = 1.1e+05
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.agegroup = 0
 ( 2)  [_d]2.agegroup = 0
 ( 3)  [_d]4.agegroup = 0
 ( 4)  [_d]5.agegroup = 0
 ( 5)  [_d]6.agegroup = 0

           chi2(  5) =24315.89
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.agegroup = 0
 ( 2)  [_d]2.agegroup = 0
 ( 3)  [_d]4.agegroup = 0
 ( 4)  [_d]5.agegroup = 0
 ( 5)  [_d]6.agegroup = 0

           chi2(  5) = 1.3e+05
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.agegroup = 0
 ( 2)  [_d]3.agegroup = 0
 ( 3)  [_d]4.agegroup = 0
 ( 4)  [_d]5.agegroup = 0
 ( 5)  [_d]6.agegroup = 0

           chi2(  5) = 1.1e+05
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.agegroup = 0
 ( 2)  [_d]2.agegroup = 0
 ( 3)  [_d]4.agegroup = 0
 ( 4)  [_d]5.agegroup = 0
 ( 5)  [_d]6.agegroup = 0

           chi2(  5) =24315.89
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.agegroup = 0
 ( 2)  [_d]2.agegroup = 0
 ( 3)  [_d]4.agegroup = 0
 ( 4)  [_d]5.agegroup = 0
 ( 5)  [_d]6.agegroup = 0

           chi2(  5) = 1.3e+05
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.agegroup = 0
 ( 2)  [_d]3.agegroup = 0
 ( 3)  [_d]4.agegroup = 0
 ( 4)  [_d]5.agegroup = 0
 ( 5)  [_d]6.agegroup = 0

           chi2(  5) = 1.1e+05
         Prob > chi2 =    0.0000

. file write tablecontents _n 

. 
. *Sex 
. refline

. outputHRsforvar, variable("male") min(1) max(1) 

. file write tablecontents _n

. 
. *BMI
. refline

. outputHRsforvar, variable("obese4cat") min(2) max(4) 

 ( 1)  [_d]2.obese4cat = 0
 ( 2)  [_d]3.obese4cat = 0
 ( 3)  [_d]4.obese4cat = 0

           chi2(  3) =  661.61
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.obese4cat = 0
 ( 2)  [_d]3.obese4cat = 0
 ( 3)  [_d]4.obese4cat = 0

           chi2(  3) =  663.68
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.obese4cat = 0
 ( 2)  [_d]3.obese4cat = 0
 ( 3)  [_d]4.obese4cat = 0

           chi2(  3) =  503.75
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.obese4cat = 0
 ( 2)  [_d]3.obese4cat = 0
 ( 3)  [_d]4.obese4cat = 0

           chi2(  3) =  661.61
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.obese4cat = 0
 ( 2)  [_d]3.obese4cat = 0
 ( 3)  [_d]4.obese4cat = 0

           chi2(  3) =  663.68
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.obese4cat = 0
 ( 2)  [_d]3.obese4cat = 0
 ( 3)  [_d]4.obese4cat = 0

           chi2(  3) =  503.75
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.obese4cat = 0
 ( 2)  [_d]3.obese4cat = 0
 ( 3)  [_d]4.obese4cat = 0

           chi2(  3) =  661.61
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.obese4cat = 0
 ( 2)  [_d]3.obese4cat = 0
 ( 3)  [_d]4.obese4cat = 0

           chi2(  3) =  663.68
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.obese4cat = 0
 ( 2)  [_d]3.obese4cat = 0
 ( 3)  [_d]4.obese4cat = 0

           chi2(  3) =  503.75
         Prob > chi2 =    0.0000

. file write tablecontents _n

. 
. *Smoking
. refline

. outputHRsforvar, variable("smoke_nomiss") min(2) max(3) 

 ( 1)  [_d]2.smoke_nomiss = 0
 ( 2)  [_d]3.smoke_nomiss = 0

           chi2(  2) =  333.21
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.smoke_nomiss = 0
 ( 2)  [_d]3.smoke_nomiss = 0

           chi2(  2) = 6361.00
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.smoke_nomiss = 0
 ( 2)  [_d]3.smoke_nomiss = 0

           chi2(  2) = 6036.48
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.smoke_nomiss = 0
 ( 2)  [_d]3.smoke_nomiss = 0

           chi2(  2) =  333.21
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.smoke_nomiss = 0
 ( 2)  [_d]3.smoke_nomiss = 0

           chi2(  2) = 6361.00
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.smoke_nomiss = 0
 ( 2)  [_d]3.smoke_nomiss = 0

           chi2(  2) = 6036.48
         Prob > chi2 =    0.0000

. file write tablecontents _n

. 
. *Ethnicity
. refline

. outputHRsforvar, variable("ethnicity") min(2) max(5) 

 ( 1)  [_d]2.ethnicity = 0
 ( 2)  [_d]3.ethnicity = 0
 ( 3)  [_d]4.ethnicity = 0
 ( 4)  [_d]5.ethnicity = 0

           chi2(  4) =  558.17
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.ethnicity = 0
 ( 2)  [_d]3.ethnicity = 0
 ( 3)  [_d]4.ethnicity = 0
 ( 4)  [_d]5.ethnicity = 0

           chi2(  4) =  176.55
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.ethnicity = 0
 ( 2)  [_d]3.ethnicity = 0
 ( 3)  [_d]4.ethnicity = 0
 ( 4)  [_d]5.ethnicity = 0

           chi2(  4) =  220.85
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.ethnicity = 0
 ( 2)  [_d]3.ethnicity = 0
 ( 3)  [_d]4.ethnicity = 0
 ( 4)  [_d]5.ethnicity = 0

           chi2(  4) =  558.17
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.ethnicity = 0
 ( 2)  [_d]3.ethnicity = 0
 ( 3)  [_d]4.ethnicity = 0
 ( 4)  [_d]5.ethnicity = 0

           chi2(  4) =  176.55
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.ethnicity = 0
 ( 2)  [_d]3.ethnicity = 0
 ( 3)  [_d]4.ethnicity = 0
 ( 4)  [_d]5.ethnicity = 0

           chi2(  4) =  220.85
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.ethnicity = 0
 ( 2)  [_d]3.ethnicity = 0
 ( 3)  [_d]4.ethnicity = 0
 ( 4)  [_d]5.ethnicity = 0

           chi2(  4) =  558.17
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.ethnicity = 0
 ( 2)  [_d]3.ethnicity = 0
 ( 3)  [_d]4.ethnicity = 0
 ( 4)  [_d]5.ethnicity = 0

           chi2(  4) =  176.55
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.ethnicity = 0
 ( 2)  [_d]3.ethnicity = 0
 ( 3)  [_d]4.ethnicity = 0
 ( 4)  [_d]5.ethnicity = 0

           chi2(  4) =  220.85
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.ethnicity = 0
 ( 2)  [_d]3.ethnicity = 0
 ( 3)  [_d]4.ethnicity = 0
 ( 4)  [_d]5.ethnicity = 0

           chi2(  4) =  558.17
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.ethnicity = 0
 ( 2)  [_d]3.ethnicity = 0
 ( 3)  [_d]4.ethnicity = 0
 ( 4)  [_d]5.ethnicity = 0

           chi2(  4) =  176.55
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.ethnicity = 0
 ( 2)  [_d]3.ethnicity = 0
 ( 3)  [_d]4.ethnicity = 0
 ( 4)  [_d]5.ethnicity = 0

           chi2(  4) =  220.85
         Prob > chi2 =    0.0000

. file write tablecontents _n

. 
. *IMD
. refline

. outputHRsforvar, variable("imd") min(2) max(5) 

 ( 1)  [_d]2.imd = 0
 ( 2)  [_d]3.imd = 0
 ( 3)  [_d]4.imd = 0
 ( 4)  [_d]5.imd = 0

           chi2(  4) = 1296.09
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.imd = 0
 ( 2)  [_d]3.imd = 0
 ( 3)  [_d]4.imd = 0
 ( 4)  [_d]5.imd = 0

           chi2(  4) = 2911.68
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.imd = 0
 ( 2)  [_d]3.imd = 0
 ( 3)  [_d]4.imd = 0
 ( 4)  [_d]5.imd = 0

           chi2(  4) = 2277.08
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.imd = 0
 ( 2)  [_d]3.imd = 0
 ( 3)  [_d]4.imd = 0
 ( 4)  [_d]5.imd = 0

           chi2(  4) = 1296.09
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.imd = 0
 ( 2)  [_d]3.imd = 0
 ( 3)  [_d]4.imd = 0
 ( 4)  [_d]5.imd = 0

           chi2(  4) = 2911.68
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.imd = 0
 ( 2)  [_d]3.imd = 0
 ( 3)  [_d]4.imd = 0
 ( 4)  [_d]5.imd = 0

           chi2(  4) = 2277.08
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.imd = 0
 ( 2)  [_d]3.imd = 0
 ( 3)  [_d]4.imd = 0
 ( 4)  [_d]5.imd = 0

           chi2(  4) = 1296.09
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.imd = 0
 ( 2)  [_d]3.imd = 0
 ( 3)  [_d]4.imd = 0
 ( 4)  [_d]5.imd = 0

           chi2(  4) = 2911.68
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.imd = 0
 ( 2)  [_d]3.imd = 0
 ( 3)  [_d]4.imd = 0
 ( 4)  [_d]5.imd = 0

           chi2(  4) = 2277.08
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.imd = 0
 ( 2)  [_d]3.imd = 0
 ( 3)  [_d]4.imd = 0
 ( 4)  [_d]5.imd = 0

           chi2(  4) = 1296.09
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.imd = 0
 ( 2)  [_d]3.imd = 0
 ( 3)  [_d]4.imd = 0
 ( 4)  [_d]5.imd = 0

           chi2(  4) = 2911.68
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.imd = 0
 ( 2)  [_d]3.imd = 0
 ( 3)  [_d]4.imd = 0
 ( 4)  [_d]5.imd = 0

           chi2(  4) = 2277.08
         Prob > chi2 =    0.0000

. file write tablecontents _n 

. 
. *BP/hypertension
. refline

. outputHRsforvar, variable("htdiag_or_highbp") min(1) max(1) 

 ( 1)  [_d]1.htdiag_or_highbp = 0

           chi2(  1) =   19.82
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.htdiag_or_highbp = 0

           chi2(  1) =   55.39
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.htdiag_or_highbp = 0

           chi2(  1) =    2.33
         Prob > chi2 =    0.1270

. file write tablecontents _n

. outputHRsforvar, variable("chronic_respiratory_disease") min(1) max(1) 

 ( 1)  [_d]1.chronic_respiratory_disease = 0

           chi2(  1) = 1101.69
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.chronic_respiratory_disease = 0

           chi2(  1) = 8717.58
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.chronic_respiratory_disease = 0

           chi2(  1) = 9622.29
         Prob > chi2 =    0.0000

. file write tablecontents _n                     

. outputHRsforvar, variable("asthmacat") min(2) max(3)                    

 ( 1)  [_d]2.asthmacat = 0
 ( 2)  [_d]3.asthmacat = 0

           chi2(  2) =   99.99
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.asthmacat = 0
 ( 2)  [_d]3.asthmacat = 0

           chi2(  2) =   91.32
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.asthmacat = 0
 ( 2)  [_d]3.asthmacat = 0

           chi2(  2) =   30.36
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.asthmacat = 0
 ( 2)  [_d]3.asthmacat = 0

           chi2(  2) =   99.99
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.asthmacat = 0
 ( 2)  [_d]3.asthmacat = 0

           chi2(  2) =   91.32
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.asthmacat = 0
 ( 2)  [_d]3.asthmacat = 0

           chi2(  2) =   30.36
         Prob > chi2 =    0.0000

. outputHRsforvar, variable("chronic_cardiac_disease") min(1) max(1) 

 ( 1)  [_d]1.chronic_cardiac_disease = 0

           chi2(  1) =  692.43
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.chronic_cardiac_disease = 0

           chi2(  1) = 5020.05
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.chronic_cardiac_disease = 0

           chi2(  1) = 5562.85
         Prob > chi2 =    0.0000

. file write tablecontents _n     

. outputHRsforvar, variable("diabcat") min(2) max(4) 

 ( 1)  [_d]2.diabcat = 0
 ( 2)  [_d]3.diabcat = 0
 ( 3)  [_d]4.diabcat = 0

           chi2(  3) = 1799.52
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.diabcat = 0
 ( 2)  [_d]3.diabcat = 0
 ( 3)  [_d]4.diabcat = 0

           chi2(  3) = 3361.90
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.diabcat = 0
 ( 2)  [_d]3.diabcat = 0
 ( 3)  [_d]4.diabcat = 0

           chi2(  3) =23093.62
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.diabcat = 0
 ( 2)  [_d]3.diabcat = 0
 ( 3)  [_d]4.diabcat = 0

           chi2(  3) = 1799.52
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.diabcat = 0
 ( 2)  [_d]3.diabcat = 0
 ( 3)  [_d]4.diabcat = 0

           chi2(  3) = 3361.90
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.diabcat = 0
 ( 2)  [_d]3.diabcat = 0
 ( 3)  [_d]4.diabcat = 0

           chi2(  3) =23093.62
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.diabcat = 0
 ( 2)  [_d]3.diabcat = 0
 ( 3)  [_d]4.diabcat = 0

           chi2(  3) = 1799.52
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.diabcat = 0
 ( 2)  [_d]3.diabcat = 0
 ( 3)  [_d]4.diabcat = 0

           chi2(  3) = 3361.90
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.diabcat = 0
 ( 2)  [_d]3.diabcat = 0
 ( 3)  [_d]4.diabcat = 0

           chi2(  3) =23093.62
         Prob > chi2 =    0.0000

. file write tablecontents _n             

. outputHRsforvar, variable("cancer_exhaem_cat") min(2) max(4) 

 ( 1)  [_d]2.cancer_exhaem_cat = 0
 ( 2)  [_d]3.cancer_exhaem_cat = 0
 ( 3)  [_d]4.cancer_exhaem_cat = 0

           chi2(  3) =  125.21
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.cancer_exhaem_cat = 0
 ( 2)  [_d]3.cancer_exhaem_cat = 0
 ( 3)  [_d]4.cancer_exhaem_cat = 0

           chi2(  3) =34591.81
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.cancer_exhaem_cat = 0
 ( 2)  [_d]3.cancer_exhaem_cat = 0
 ( 3)  [_d]4.cancer_exhaem_cat = 0

           chi2(  3) =33601.09
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.cancer_exhaem_cat = 0
 ( 2)  [_d]3.cancer_exhaem_cat = 0
 ( 3)  [_d]4.cancer_exhaem_cat = 0

           chi2(  3) =  125.21
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.cancer_exhaem_cat = 0
 ( 2)  [_d]3.cancer_exhaem_cat = 0
 ( 3)  [_d]4.cancer_exhaem_cat = 0

           chi2(  3) =34591.81
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.cancer_exhaem_cat = 0
 ( 2)  [_d]3.cancer_exhaem_cat = 0
 ( 3)  [_d]4.cancer_exhaem_cat = 0

           chi2(  3) =33601.09
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.cancer_exhaem_cat = 0
 ( 2)  [_d]3.cancer_exhaem_cat = 0
 ( 3)  [_d]4.cancer_exhaem_cat = 0

           chi2(  3) =  125.21
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.cancer_exhaem_cat = 0
 ( 2)  [_d]3.cancer_exhaem_cat = 0
 ( 3)  [_d]4.cancer_exhaem_cat = 0

           chi2(  3) =34591.81
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.cancer_exhaem_cat = 0
 ( 2)  [_d]3.cancer_exhaem_cat = 0
 ( 3)  [_d]4.cancer_exhaem_cat = 0

           chi2(  3) =33601.09
         Prob > chi2 =    0.0000

. file write tablecontents _n             

. outputHRsforvar, variable("cancer_haem_cat") min(2) max(4)              

 ( 1)  [_d]2.cancer_haem_cat = 0
 ( 2)  [_d]3.cancer_haem_cat = 0
 ( 3)  [_d]4.cancer_haem_cat = 0

           chi2(  3) =  255.16
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.cancer_haem_cat = 0
 ( 2)  [_d]3.cancer_haem_cat = 0
 ( 3)  [_d]4.cancer_haem_cat = 0

           chi2(  3) = 2839.60
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.cancer_haem_cat = 0
 ( 2)  [_d]3.cancer_haem_cat = 0
 ( 3)  [_d]4.cancer_haem_cat = 0

           chi2(  3) = 2638.41
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.cancer_haem_cat = 0
 ( 2)  [_d]3.cancer_haem_cat = 0
 ( 3)  [_d]4.cancer_haem_cat = 0

           chi2(  3) =  255.16
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.cancer_haem_cat = 0
 ( 2)  [_d]3.cancer_haem_cat = 0
 ( 3)  [_d]4.cancer_haem_cat = 0

           chi2(  3) = 2839.60
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.cancer_haem_cat = 0
 ( 2)  [_d]3.cancer_haem_cat = 0
 ( 3)  [_d]4.cancer_haem_cat = 0

           chi2(  3) = 2638.41
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.cancer_haem_cat = 0
 ( 2)  [_d]3.cancer_haem_cat = 0
 ( 3)  [_d]4.cancer_haem_cat = 0

           chi2(  3) =  255.16
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.cancer_haem_cat = 0
 ( 2)  [_d]3.cancer_haem_cat = 0
 ( 3)  [_d]4.cancer_haem_cat = 0

           chi2(  3) = 2839.60
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.cancer_haem_cat = 0
 ( 2)  [_d]3.cancer_haem_cat = 0
 ( 3)  [_d]4.cancer_haem_cat = 0

           chi2(  3) = 2638.41
         Prob > chi2 =    0.0000

. file write tablecontents _n

. outputHRsforvar, variable("reduced_kidney_function_cat") min(2) max(3)          

 ( 1)  [_d]2.reduced_kidney_function_cat = 0
 ( 2)  [_d]3.reduced_kidney_function_cat = 0

           chi2(  2) = 1349.97
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.reduced_kidney_function_cat = 0
 ( 2)  [_d]3.reduced_kidney_function_cat = 0

           chi2(  2) = 6224.47
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.reduced_kidney_function_cat = 0
 ( 2)  [_d]3.reduced_kidney_function_cat = 0

           chi2(  2) = 6029.34
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.reduced_kidney_function_cat = 0
 ( 2)  [_d]3.reduced_kidney_function_cat = 0

           chi2(  2) = 1349.97
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.reduced_kidney_function_cat = 0
 ( 2)  [_d]3.reduced_kidney_function_cat = 0

           chi2(  2) = 6224.47
         Prob > chi2 =    0.0000

 ( 1)  [_d]2.reduced_kidney_function_cat = 0
 ( 2)  [_d]3.reduced_kidney_function_cat = 0

           chi2(  2) = 6029.34
         Prob > chi2 =    0.0000

. outputHRsforvar, variable("chronic_liver_disease") min(1) max(1)                        

 ( 1)  [_d]1.chronic_liver_disease = 0

           chi2(  1) =  237.81
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.chronic_liver_disease = 0

           chi2(  1) = 4530.61
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.chronic_liver_disease = 0

           chi2(  1) = 4640.34
         Prob > chi2 =    0.0000

. outputHRsforvar, variable("stroke_dementia") min(1) max(1)      

 ( 1)  [_d]1.stroke_dementia = 0

           chi2(  1) = 2159.47
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.stroke_dementia = 0

           chi2(  1) = 6277.31
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.stroke_dementia = 0

           chi2(  1) = 5136.00
         Prob > chi2 =    0.0000

. outputHRsforvar, variable("other_neuro") min(1) max(1)          

 ( 1)  [_d]1.other_neuro = 0

           chi2(  1) = 1233.56
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.other_neuro = 0

           chi2(  1) = 3795.22
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.other_neuro = 0

           chi2(  1) = 2823.52
         Prob > chi2 =    0.0000

. outputHRsforvar, variable("organ_transplant") min(1) max(1)                     

 ( 1)  [_d]1.organ_transplant = 0

           chi2(  1) =  238.93
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.organ_transplant = 0

           chi2(  1) =  478.46
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.organ_transplant = 0

           chi2(  1) =  499.10
         Prob > chi2 =    0.0000

. outputHRsforvar, variable("spleen") min(1) max(1) 

 ( 1)  [_d]1.spleen = 0

           chi2(  1) =    6.27
         Prob > chi2 =    0.0123

 ( 1)  [_d]1.spleen = 0

           chi2(  1) =  214.14
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.spleen = 0

           chi2(  1) =  193.66
         Prob > chi2 =    0.0000

. outputHRsforvar, variable("ra_sle_psoriasis") min(1) max(1) 

 ( 1)  [_d]1.ra_sle_psoriasis = 0

           chi2(  1) =   88.85
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.ra_sle_psoriasis = 0

           chi2(  1) =  273.14
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.ra_sle_psoriasis = 0

           chi2(  1) =  231.03
         Prob > chi2 =    0.0000

. outputHRsforvar, variable("other_immunosuppression") min(1) max(1) 

 ( 1)  [_d]1.other_immunosuppression = 0

           chi2(  1) =   77.48
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.other_immunosuppression = 0

           chi2(  1) =  527.14
         Prob > chi2 =    0.0000

 ( 1)  [_d]1.other_immunosuppression = 0

           chi2(  1) =  133.80
         Prob > chi2 =    0.0000

. 
. 
. file close tablecontents

. 
. postclose HRestimates

. 
. use `HRestimates', clear

. 
. gen varorder = 1 

. local i=2

. foreach var of any male obese4cat smoke_nomiss ethnicity imd  diabcat ///
>         cancer_exhaem_cat cancer_haem_cat reduced_kidney_function_cat asthmacat chronic_respiratory_disease ///
>         chronic_cardiac_disease htdiag_or_highbp chronic_liver_disease ///
>         stroke_dementia other_neuro organ_transplant ///
>         spleen ra_sle_psoriasis other_immunosuppression {
  2. replace varorder = `i' if variable=="`var'"
  3. local i=`i'+1
  4. }
(0 real changes made)
(9 real changes made)
(6 real changes made)
(12 real changes made)
(12 real changes made)
(9 real changes made)
(9 real changes made)
(9 real changes made)
(6 real changes made)
(6 real changes made)
(3 real changes made)
(3 real changes made)
(3 real changes made)
(3 real changes made)
(3 real changes made)
(3 real changes made)
(3 real changes made)
(3 real changes made)
(3 real changes made)
(3 real changes made)

. sort varorder outcome level

. drop varorder

. 
. gen obsorder=_n

. expand 2 if variable!=variable[_n-1] | outcome!=outcome[_n-1], gen(expanded)
(60 observations created)

. for var hr lci uci: replace X = 1 if expanded==1

->  replace hr = 1 if expanded==1
(59 real changes made)

->  replace lci = 1 if expanded==1
(60 real changes made)

->  replace uci = 1 if expanded==1
(60 real changes made)

. 
. sort obsorder

. drop obsorder

. replace level = 0 if expanded == 1
(60 real changes made)

. replace level = 1 if expanded == 1 & (variable=="obese4cat"|variable=="smoke_nomiss"|variable=="ethnicity"|variable=="imd"|variable=="asthmacat"|variable=="diabcat"|substr(variable,1,6)=="cancer"|variab
> le=="reduced_kidney_function_cat"|variable=="agegroup")
(30 real changes made)

. replace level = 3 if expanded == 1 & variable=="agegroup"
(3 real changes made)

. 
. gen varorder = 1 if variable!=variable[_n-1]
(163 missing values generated)

. replace varorder = sum(varorder)
(182 real changes made)

. sort varorder outcome level

. 
. 
. drop expanded

. expand 2 if variable!=variable[_n-1] | outcome!=outcome[_n-1], gen(expanded)
(60 observations created)

. replace level = -1 if expanded==1
(60 real changes made)

. drop expanded

. *expand 3 if variable=="htdiag_or_highbp" & level==-1, gen(expanded)
. *replace level = -99 if variable=="htdiag_or_highbp" & expanded==1
. expand 2 if level == -1, gen(expanded)
(60 observations created)

. replace level = -99 if expanded==1
(60 real changes made)

. 
. for var hr lci uci pval : replace X=. if level<0

->  replace hr=. if level<0
(120 real changes made, 120 to missing)

->  replace lci=. if level<0
(118 real changes made, 118 to missing)

->  replace uci=. if level<0
(118 real changes made, 118 to missing)

->  replace pval=. if level<0
(120 real changes made, 120 to missing)

. sort varorder outcome  level

. 
. gen varx = 0.07

. gen levelx = 0.071

. gen lowerlimit = 0.15

. 
. *Names
. gen Name = variable if (level==-1&!(level[_n+1]==0&variable!="male"))|(level==1&level[_n-1]==0&variable!="male")
(243 missing values generated)

. replace Name = subinstr(Name, "_", " ", 10)
(39 real changes made)

. replace Name = upper(substr(Name,1,1)) + substr(Name,2,.)
(60 real changes made)

. replace Name = "Age group" if Name=="Agegroup"
(3 real changes made)

. replace Name = "Sex" if Name=="Male"
(0 real changes made)

. replace Name = "Obesity" if Name=="Obese4cat"
(3 real changes made)

. replace Name = "Smoking status" if Name=="Smoke nomiss"
(3 real changes made)

. replace Name = "Deprivation (IMD) quintile" if Name=="Imd"
(3 real changes made)

. replace Name = "Hypertension/high bp" if Name=="Htdiag or highbp"
(3 real changes made)

. replace Name = "Asthma" if Name=="Asthmacat"
(3 real changes made)

. replace Name = "Diabetes" if Name=="Diabcat"
(3 real changes made)

. replace Name = "Cancer (non-haematological)" if Name=="Cancer exhaem cat"
(3 real changes made)

. replace Name = "Haematological malignancy" if Name=="Cancer haem cat"
(3 real changes made)

. replace Name = "Stroke or dementia" if Name=="Stroke dementia"
(3 real changes made)

. replace Name = "Other neurological" if Name=="Other neuro"
(3 real changes made)

. replace Name = "Rheumatoid arthritis/Lupus/Psoriasis" if Name=="Ra sle psoriasis"
variable Name was str27 now str36
(3 real changes made)

. replace Name = "Reduced kidney function" if Name=="Reduced kidney function cat"
(3 real changes made)

. replace Name = "Asplenia" if Name=="Spleen"
(3 real changes made)

. 
. *Levels
. gen leveldesc = ""
(303 missing values generated)

. replace leveldesc = "18-39" if variable=="agegroup" & level==1
variable leveldesc was str1 now str5
(3 real changes made)

. replace leveldesc = "40-49" if variable=="agegroup" & level==2
(3 real changes made)

. replace leveldesc = "50-59 (ref)" if variable=="agegroup" & level==3
variable leveldesc was str5 now str11
(3 real changes made)

. replace leveldesc = "60-69" if variable=="agegroup" & level==4
(3 real changes made)

. replace leveldesc = "70-79" if variable=="agegroup" & level==5
(3 real changes made)

. replace leveldesc = "80+" if variable=="agegroup" & level==6
(3 real changes made)

. 
. replace leveldesc = "Female (ref)" if variable=="male" & level==0
(0 real changes made)

. replace leveldesc = "Male" if variable=="male" & level==1
(0 real changes made)

. 
. replace leveldesc = "Not obese (ref)" if variable=="obese4cat" & level==1
variable leveldesc was str11 now str15
(3 real changes made)

. replace leveldesc = "Obese class I" if variable=="obese4cat" & level==2
(3 real changes made)

. replace leveldesc = "Obese class II" if variable=="obese4cat" & level==3
(3 real changes made)

. replace leveldesc = "Obese class III" if variable=="obese4cat" & level==4
(3 real changes made)

. 
. replace leveldesc = "Never (ref)" if variable=="smoke_nomiss" & level==1
(3 real changes made)

. replace leveldesc = "Ex-smoker" if variable=="smoke_nomiss" & level==2
(3 real changes made)

. replace leveldesc = "Current" if variable=="smoke_nomiss" & level==3
(3 real changes made)

. 
. replace leveldesc = "White (ref)" if variable=="ethnicity" & level==1
(3 real changes made)

. replace leveldesc = "Mixed" if variable=="ethnicity" & level==2
(3 real changes made)

. replace leveldesc = "Asian/Asian British" if variable=="ethnicity" & level==3
variable leveldesc was str15 now str19
(3 real changes made)

. replace leveldesc = "Black" if variable=="ethnicity" & level==4
(3 real changes made)

. replace leveldesc = "Other" if variable=="ethnicity" & level==5
(3 real changes made)

. 
. replace leveldesc = "1 (least deprived, ref)" if variable=="imd" & level==1
variable leveldesc was str19 now str23
(3 real changes made)

. replace leveldesc = "2" if variable=="imd" & level==2
(3 real changes made)

. replace leveldesc = "3" if variable=="imd" & level==3
(3 real changes made)

. replace leveldesc = "4" if variable=="imd" & level==4
(3 real changes made)

. replace leveldesc = "5 (most deprived)" if variable=="imd" & level==5
(3 real changes made)

. 
. replace leveldesc = "No diabetes (ref)" if variable=="diabcat" & level==1
(3 real changes made)

. replace leveldesc = "Controlled (HbA1c <58mmol/mol)" if variable=="diabcat" & level==2
variable leveldesc was str23 now str30
(3 real changes made)

. replace leveldesc = "Uncontrolled (HbA1c >=58mmol/mol) " if variable=="diabcat" & level==3
variable leveldesc was str30 now str34
(3 real changes made)

. replace leveldesc = "Unknown HbA1c" if variable=="diabcat" & level==4
(3 real changes made)

. 
. replace leveldesc = "No asthma (ref)" if variable=="asthmacat" & level==1
(3 real changes made)

. replace leveldesc = "With no recent OCS use" if variable=="asthmacat" & level==2
(3 real changes made)

. replace leveldesc = "With recent OCS use" if variable=="asthmacat" & level==3
(3 real changes made)

. 
. replace leveldesc = "Never (ref)" if substr(variable,1,6)=="cancer" & level==1
(6 real changes made)

. replace leveldesc = "<1 year ago" if substr(variable,1,6)=="cancer" & level==2
(6 real changes made)

. replace leveldesc = "1-4.9 years ago" if substr(variable,1,6)=="cancer" & level==3
(6 real changes made)

. replace leveldesc = "5+ years ago" if substr(variable,1,6)=="cancer" & level==4
(6 real changes made)

. 
. replace leveldesc = "None (ref)" if variable=="reduced_kidney_function_cat" & level==1
(3 real changes made)

. replace leveldesc = "eGFR 30-60 ml/min/1.73m2" if variable=="reduced_kidney_function_cat" & level==2
(3 real changes made)

. replace leveldesc = "eGFR <30 ml/min/1.73m2" if variable=="reduced_kidney_function_cat" & level==3
(3 real changes made)

. 
. 
. *replace leveldesc = "Absent" if level==0
. *replace leveldesc = "Present" if level==1 & leveldesc==""
. drop if level==0 & variable!="male"
(30 observations deleted)

. 
. 
. gen obsorder=_n

. gsort -obsorder

. gen graphorder = _n

. sort obsorder

. 
. *merge 1:1 variable level using c:\statatemp\tptemp, update replace
. 
. gen displayhrci = "<<< HR = " + string(hr, "%3.2f") + " (" + string(lci, "%3.2f") + "-" + string(uci, "%3.2f") + ")" if lci<0.15
(271 missing values generated)

. 
. qui summ obsorder if outcome=="NONCOV_2019" & variable=="imd" & level ==5

. local endofdemog = r(mean)

. foreach graphtype of any demogs comorbs{
  2. if "`graphtype'"=="demogs" local if "if _n<=`endofdemog'"
  3. if "`graphtype'"=="comorbs" local if "if _n>`endofdemog'"
  4. scatter graphorder hr if lci>=.15 & outcome=="COV", mcol(red)   msize(small)            ///                                                                             ///
>         || rcap lci uci graphorder if lci>=.15 & outcome=="COV", hor mcol(red)  lcol(red)                       ///
>         || scatter graphorder hr if lci>=.15 & outcome=="NONCOV", mcol(black)   msize(small)            ///                                                                             ///
>         || rcap lci uci graphorder if lci>=.15 & outcome=="NONCOV", hor mcol(black)     lcol(black)                     ///
>         || scatter graphorder hr if lci>=.15 & outcome=="NONCOV_2019", mcol(blue)       msize(small)            ///                                                                             ///
>         || rcap lci uci graphorder if lci>=.15 & outcome=="NONCOV_2019", hor mcol(blue) lcol(black)                     ///
>         || scatter graphorder lowerlimit, m(i) mlab(displayhrci) mlabcol(black) mlabsize(tiny) ///
>         || scatter graphorder varx if outcome=="COV", m(i) mlab(Name) mlabsize(tiny) mlabcol(black)     ///
>         || scatter graphorder levelx if outcome=="COV", m(i) mlab(leveldesc) mlabsize(tiny) mlabcol(gs8)        ///
>                 xline(1,lp(dash))                                                                                                                       ///
>                 xscale(log) xlab(0.25 0.5 1 2 5 10 20) xtitle("Odds Ratio & 95% CI") ylab(none) ytitle("")                                              /// 
>                  ysize(12)   legend(order(1 3 5) label(1 "COVID deaths") label(3 "Non-COVID deaths")  label(5 "Deaths 2019")) ///
>                 || `if' , name(`graphtype', replace)
  5. }

. graph combine demogs comorbs, rows(1) ysize(6) iscale(*.7)

. graph export ./output/an_table_covidvsnoncovid_agesex.svg, as(svg) replace
(file ./output/an_table_covidvsnoncovid_agesex.svg written in SVG format)

. 
end of do-file

. do "E:\STATATMP\STD8e50_000000.tmp"

. cap log close
