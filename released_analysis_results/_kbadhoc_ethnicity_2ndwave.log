--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  e:\analyses\covid-vs-noncovid-deaths-research\analysis/output/_kbadhoc_ethnicity_2ndwave.log
  log type:  text
 opened on:  21 Dec 2020, 11:55:36

. 
. use  ./analysis/cr_create_analysis_dataset_SEPT2020_STSET.dta, clear

. 
. gen coviddeath = died_ons_covid_flag_any==1 & died_date_ons<=d(9/11/2020)

. 
. tab coviddeath

 coviddeath |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 | 17,692,388       99.98       99.98
          1 |      2,686        0.02      100.00
------------+-----------------------------------
      Total | 17,695,074      100.00

. 
. stset stime_onsdeath, fail(coviddeath) id(patient_id) enter(enter_date) origin(enter_date)

                id:  patient_id
     failure event:  coviddeath != 0 & coviddeath < .
obs. time interval:  (stime_onsdeath[_n-1], stime_onsdeath]
 enter on or after:  time enter_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time enter_date

------------------------------------------------------------------------------
   17695074  total observations
          0  exclusions
------------------------------------------------------------------------------
   17695074  observations remaining, representing
   17695074  subjects
      2,686  failures in single-failure-per-subject data
 1.2199e+09  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =        69

. 
. strate ethnicity, output(./analysis/_kbadhoc_ethnicity_2ndwaveSTRATES, replace)

         failure _d:  coviddeath
   analysis time _t:  (stime_onsdeath-origin)
             origin:  time enter_date
  enter on or after:  time enter_date
                 id:  patient_id

Estimated failure rates
Number of records  =       13223154

  +-----------------------------------------------------------------------------+
  |              ethnicity      D         Y        Rate       Lower       Upper |
  |-----------------------------------------------------------------------------|
  |                  White   1771   7.8e+08   0.0000023   0.0000022   0.0000024 |
  |                  Mixed      8   1.2e+07   0.0000006   0.0000003   0.0000013 |
  | Asian or Asian British    224   7.3e+07   0.0000031   0.0000027   0.0000035 |
  |                  Black     27   2.5e+07   0.0000011   0.0000008   0.0000016 |
  |                  Other     16   2.3e+07   0.0000007   0.0000004   0.0000011 |
  +-----------------------------------------------------------------------------+
   Notes: Rate = D/Y = failures/person-time.
          Lower and Upper are bounds of 95% confidence intervals.


. 
. 
end of do-file

. do "E:\STATATMP\STD59a8_000000.tmp"

. strate ethnicity, per(365.25) output(./analysis/_kbadhoc_ethnicity_2ndwaveSTRATES, replace)

         failure _d:  coviddeath
   analysis time _t:  (stime_onsdeath-origin)
             origin:  time enter_date
  enter on or after:  time enter_date
                 id:  patient_id

Estimated failure rates
Number of records  =       13223154

  +-----------------------------------------------------------------------------+
  |              ethnicity      D         Y        Rate       Lower       Upper |
  |-----------------------------------------------------------------------------|
  |                  White   1771   2.1e+06   0.0008307   0.0007929   0.0008703 |
  |                  Mixed      8   3.4e+04   0.0002363   0.0001182   0.0004725 |
  | Asian or Asian British    224   2.0e+05   0.0011197   0.0009822   0.0012763 |
  |                  Black     27   6.7e+04   0.0004025   0.0002760   0.0005869 |
  |                  Other     16   6.3e+04   0.0002538   0.0001555   0.0004142 |
  +-----------------------------------------------------------------------------+
   Notes: Rate = D/Y = failures/person-time (per 365.25).
          Lower and Upper are bounds of 95% confidence intervals.


. 
. safetab ethnicity if coviddeath==1

             Ethnicity |      Freq.     Percent        Cum.
-----------------------+-----------------------------------
                 White |      1,771       86.56       86.56
                 Mixed |          8        0.39       86.95
Asian or Asian British |        224       10.95       97.90
                 Black |         27        1.32       99.22
                 Other |         16        0.78      100.00
-----------------------+-----------------------------------
                 Total |      2,046      100.00

. 
. summ died_date_ons if coviddeath==1, f d

                        died_date_ons
-------------------------------------------------------------
      Percentiles      Smallest
 1%    08sep2020      02sep2020
 5%    24sep2020      02sep2020
10%    05oct2020      02sep2020       Obs               2,686
25%    18oct2020      02sep2020       Sum of Wgt.       2,686

50%    28oct2020                      Mean          24oct2020
                        Largest       Std. Dev.      13.93471
75%    04nov2020      09nov2020
90%    07nov2020      09nov2020       Variance        194.176
95%    09nov2020      09nov2020       Skewness      -1.335704
99%    09nov2020      09nov2020       Kurtosis       4.626035

. 
. stcox age1 age2 age3 i.male i.ethnicity , strata(stp) 

         failure _d:  coviddeath
   analysis time _t:  (stime_onsdeath-origin)
             origin:  time enter_date
  enter on or after:  time enter_date
                 id:  patient_id

Iteration 0:   log likelihood = -27255.269
Iteration 1:   log likelihood = -24809.058
Iteration 2:   log likelihood = -24133.158
Iteration 3:   log likelihood = -24110.734
Iteration 4:   log likelihood =  -24108.95
Iteration 5:   log likelihood = -24108.748
Iteration 6:   log likelihood = -24108.744
Iteration 7:   log likelihood = -24108.744
Refining estimates:
Iteration 0:   log likelihood = -24108.744

Stratified Cox regr. -- Breslow method for ties

No. of subjects =   13,223,154                  Number of obs    =  13,223,154
No. of failures =        2,046
Time at risk    =    911660733
                                                LR chi2(8)       =     6293.05
Log likelihood  =   -24108.744                  Prob > chi2      =      0.0000

-----------------------------------------------------------------------------------------
                     _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------+----------------------------------------------------------------
                   age1 |   1.150281   .0616716     2.61   0.009     1.035541    1.277734
                   age2 |   .9730718   .1092704    -0.24   0.808     .7808359    1.212635
                   age3 |   1.053148   .2734754     0.20   0.842      .633074    1.751962
                 1.male |   1.888358   .0853753    14.06   0.000     1.728225    2.063328
                        |
              ethnicity |
                 Mixed  |   1.285902   .4568519     0.71   0.479     .6409072    2.580005
Asian or Asian British  |   3.472321   .2651374    16.30   0.000     2.989677    4.032881
                 Black  |   1.276362   .2513099     1.24   0.215      .867713    1.877464
                 Other  |   1.259918    .318238     0.91   0.360      .767963    2.067017
-----------------------------------------------------------------------------------------
                                                             Stratified by stp

. 
. stcox age1 age2 age3 i.male i.ethnicity_16 , strata(stp) 

         failure _d:  coviddeath
   analysis time _t:  (stime_onsdeath-origin)
             origin:  time enter_date
  enter on or after:  time enter_date
                 id:  patient_id

Iteration 0:   log likelihood = -27255.269
Iteration 1:   log likelihood = -24802.368
Iteration 2:   log likelihood = -24124.907
Iteration 3:   log likelihood = -24100.871
Iteration 4:   log likelihood = -24098.964
Iteration 5:   log likelihood = -24098.751
Iteration 6:   log likelihood = -24098.747
Iteration 7:   log likelihood = -24098.747
Refining estimates:
Iteration 0:   log likelihood = -24098.747

Stratified Cox regr. -- Breslow method for ties

No. of subjects =   13,223,154                  Number of obs    =  13,223,154
No. of failures =        2,046
Time at risk    =    911660733
                                                LR chi2(19)      =     6313.05
Log likelihood  =   -24098.747                  Prob > chi2      =      0.0000

-----------------------------------------------------------------------------------------------------
                                 _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------------------+----------------------------------------------------------------
                               age1 |   1.149352   .0614837     2.60   0.009     1.034948    1.276402
                               age2 |   .9773103    .109545    -0.20   0.838      .784554    1.217425
                               age3 |   1.040046   .2696397     0.15   0.880     .6257087    1.728753
                             1.male |   1.888592   .0853852    14.06   0.000      1.72844    2.063582
                                    |
                       ethnicity_16 |
                             Irish  |   .8415873   .2445741    -0.59   0.553     .4761361    1.487535
                       Other White  |   1.090949   .1174831     0.81   0.419     .8833635    1.347316
           White + Black Caribbean  |   .8485752   .6007625    -0.23   0.817     .2118696    3.398695
             White + Black African  |    2.05012   1.452772     1.01   0.311     .5112039     8.22175
                     White + Asian  |   .9340448   .9346966    -0.07   0.946      .131393    6.639927
                       Other mixed  |   1.617115   .9359336     0.83   0.406     .5201076    5.027924
          Indian or British Indian  |   2.696931   .3288628     8.14   0.000      2.12361    3.425036
    Pakistani or British Pakistani  |   4.433182   .4606712    14.33   0.000     3.616292      5.4346
Bangladeshi or British Bangladeshi  |   5.959661   1.509167     7.05   0.000     3.628035    9.789751
                       Other Asian  |   2.486092   .5427594     4.17   0.000     1.620632    3.813731
                         Caribbean  |   1.274396   .3146875     0.98   0.326     .7854463    2.067722
                           African  |   .9871447   .4442368    -0.03   0.977     .4086217    2.384735
                       Other Black  |   1.684433   .7563605     1.16   0.246     .6986169    4.061333
                           Chinese  |   1.068841   .5354854     0.13   0.894     .4003723    2.853395
                             Other  |   1.320182   .3851033     0.95   0.341     .7453057    2.338478
-----------------------------------------------------------------------------------------------------
                                                             Stratified by stp

. 
. stcox age1 age2 age3 i.male i.ethnicity i.imd, strata(stp) 

         failure _d:  coviddeath
   analysis time _t:  (stime_onsdeath-origin)
             origin:  time enter_date
  enter on or after:  time enter_date
                 id:  patient_id

Iteration 0:   log likelihood = -27255.269
Iteration 1:   log likelihood = -24729.138
Iteration 2:   log likelihood = -24018.672
Iteration 3:   log likelihood = -23996.485
Iteration 4:   log likelihood = -23994.818
Iteration 5:   log likelihood = -23994.639
Iteration 6:   log likelihood = -23994.636
Iteration 7:   log likelihood = -23994.636
Refining estimates:
Iteration 0:   log likelihood = -23994.636

Stratified Cox regr. -- Breslow method for ties

No. of subjects =   13,223,154                  Number of obs    =  13,223,154
No. of failures =        2,046
Time at risk    =    911660733
                                                LR chi2(12)      =     6521.27
Log likelihood  =   -23994.636                  Prob > chi2      =      0.0000

-----------------------------------------------------------------------------------------
                     _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------+----------------------------------------------------------------
                   age1 |   1.147377    .061031     2.58   0.010     1.033783    1.273454
                   age2 |   .9859247   .1100522    -0.13   0.899     .7921909    1.227037
                   age3 |   1.015516   .2623598     0.06   0.952     .6120368    1.684983
                 1.male |   1.910644    .086462    14.31   0.000     1.748479    2.087849
                        |
              ethnicity |
                 Mixed  |   1.127976   .4008994     0.34   0.735     .5620438    2.263756
Asian or Asian British  |   2.858067   .2213416    13.56   0.000     2.455566    3.326545
                 Black  |   1.014496    .200263     0.07   0.942     .6890044    1.493753
                 Other  |   1.144131   .2891701     0.53   0.594     .6971745    1.877631
                        |
                    imd |
                     2  |   1.221047   .1024797     2.38   0.017      1.03584    1.439367
                     3  |   1.405289    .116687     4.10   0.000     1.194226    1.653653
                     4  |   2.186809   .1681602    10.18   0.000     1.880856     2.54253
       5 most deprived  |   2.497588   .1883709    12.14   0.000      2.15438    2.895472
-----------------------------------------------------------------------------------------
                                                             Stratified by stp

. 
. tab agegroup ethnicity, col

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

   Grouped |                       Ethnicity
       age |     White      Mixed  Asian or       Black      Other |     Total
-----------+-------------------------------------------------------+----------
    18-<40 | 3,421,561     97,323    494,537    147,586    178,499 | 4,339,506 
           |     30.29      54.29      46.68      41.55      53.47 |     32.82 
-----------+-------------------------------------------------------+----------
    40-<50 | 1,838,647     36,669    252,690     84,268     72,072 | 2,284,346 
           |     16.28      20.46      23.85      23.72      21.59 |     17.28 
-----------+-------------------------------------------------------+----------
    50-<60 | 2,084,805     25,606    143,614     70,052     42,485 | 2,366,562 
           |     18.46      14.28      13.56      19.72      12.73 |     17.90 
-----------+-------------------------------------------------------+----------
    60-<70 | 1,720,122     11,796     96,704     30,687     23,887 | 1,883,196 
           |     15.23       6.58       9.13       8.64       7.16 |     14.24 
-----------+-------------------------------------------------------+----------
    70-<80 | 1,460,546      5,202     46,763     12,899     11,703 | 1,537,113 
           |     12.93       2.90       4.41       3.63       3.51 |     11.62 
-----------+-------------------------------------------------------+----------
       80+ |   769,817      2,657     25,069      9,703      5,185 |   812,431 
           |      6.82       1.48       2.37       2.73       1.55 |      6.14 
-----------+-------------------------------------------------------+----------
     Total |11,295,498    179,253  1,059,377    355,195    333,831 |13,223,154 
           |    100.00     100.00     100.00     100.00     100.00 |    100.00 

. tab male ethnicity, col

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

           |                       Ethnicity
      Male |     White      Mixed  Asian or       Black      Other |     Total
-----------+-------------------------------------------------------+----------
         0 | 5,872,445     92,162    508,560    177,044    163,852 | 6,814,063 
           |     51.99      51.41      48.01      49.84      49.08 |     51.53 
-----------+-------------------------------------------------------+----------
         1 | 5,423,053     87,091    550,817    178,151    169,979 | 6,409,091 
           |     48.01      48.59      51.99      50.16      50.92 |     48.47 
-----------+-------------------------------------------------------+----------
     Total |11,295,498    179,253  1,059,377    355,195    333,831 |13,223,154 
           |    100.00     100.00     100.00     100.00     100.00 |    100.00 

. tab imd ethnicity, col

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

        Index of |
        Multiple |
     Deprivation |                       Ethnicity
           (IMD) |     White      Mixed  Asian or       Black      Other |     Total
-----------------+-------------------------------------------------------+----------
1 least deprived | 2,423,497     23,885     93,346     24,089     45,053 | 2,609,870 
                 |     21.46      13.32       8.81       6.78      13.50 |     19.74 
-----------------+-------------------------------------------------------+----------
               2 | 2,378,336     28,929    121,274     36,626     57,590 | 2,622,755 
                 |     21.06      16.14      11.45      10.31      17.25 |     19.83 
-----------------+-------------------------------------------------------+----------
               3 | 2,336,657     34,831    201,001     59,057     65,490 | 2,697,036 
                 |     20.69      19.43      18.97      16.63      19.62 |     20.40 
-----------------+-------------------------------------------------------+----------
               4 | 2,174,386     42,262    304,523     94,714     81,802 | 2,697,687 
                 |     19.25      23.58      28.75      26.67      24.50 |     20.40 
-----------------+-------------------------------------------------------+----------
 5 most deprived | 1,982,622     49,346    339,233    140,709     83,896 | 2,595,806 
                 |     17.55      27.53      32.02      39.61      25.13 |     19.63 
-----------------+-------------------------------------------------------+----------
           Total |11,295,498    179,253  1,059,377    355,195    333,831 |13,223,154 
                 |    100.00     100.00     100.00     100.00     100.00 |    100.00 

. 
. table ethnicity , c(median age p25 age p75 age)

-----------------------------------------------------------
             Ethnicity |   med(age)    p25(age)    p75(age)
-----------------------+-----------------------------------
                 White |         51          36          66
                 Mixed |         38          28          50
Asian or Asian British |         41          32          52
                 Black |         43          32          54
                 Other |         38          29          49
-----------------------------------------------------------

. 
. 
. ***SENS AN - DEATHS IN U/L POSITION ONLY
. 
 
. use  ./analysis/cr_create_analysis_dataset_SEPT2020_STSET.dta, clear

. 
. stset stime_onsdeath, fail(onsdeath=1) id(patient_id) enter(enter_date) origin(enter_date)

                id:  patient_id
     failure event:  onsdeath == 1
obs. time interval:  (stime_onsdeath[_n-1], stime_onsdeath]
 enter on or after:  time enter_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time enter_date

------------------------------------------------------------------------------
   17695074  total observations
          0  exclusions
------------------------------------------------------------------------------
   17695074  observations remaining, representing
   17695074  subjects
      2,365  failures in single-failure-per-subject data
 1.2199e+09  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =        69

. 
. summ died_date_ons if onsdeath==1, f d

                        died_date_ons
-------------------------------------------------------------
      Percentiles      Smallest
 1%    09sep2020      02sep2020
 5%    25sep2020      02sep2020
10%    06oct2020      02sep2020       Obs               2,365
25%    18oct2020      02sep2020       Sum of Wgt.       2,365

50%    28oct2020                      Mean          24oct2020
                        Largest       Std. Dev.      13.73235
75%    04nov2020      09nov2020
90%    07nov2020      09nov2020       Variance       188.5775
95%    09nov2020      09nov2020       Skewness      -1.338435
99%    09nov2020      09nov2020       Kurtosis       4.664896

. 
. stcox age1 age2 age3 i.male i.ethnicity , strata(stp) 

         failure _d:  onsdeath == 1
   analysis time _t:  (stime_onsdeath-origin)
             origin:  time enter_date
  enter on or after:  time enter_date
                 id:  patient_id

Iteration 0:   log likelihood = -24114.452
Iteration 1:   log likelihood = -21908.226
Iteration 2:   log likelihood = -21289.172
Iteration 3:   log likelihood = -21268.163
Iteration 4:   log likelihood = -21267.019
Iteration 5:   log likelihood = -21266.927
Iteration 6:   log likelihood = -21266.926
Iteration 7:   log likelihood = -21266.926
Refining estimates:
Iteration 0:   log likelihood = -21266.926

Stratified Cox regr. -- Breslow method for ties

No. of subjects =   13,223,154                  Number of obs    =  13,223,154
No. of failures =        1,809
Time at risk    =    911660733
                                                LR chi2(8)       =     5695.05
Log likelihood  =   -21266.926                  Prob > chi2      =      0.0000

-----------------------------------------------------------------------------------------
                     _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------+----------------------------------------------------------------
                   age1 |   1.117602   .0588926     2.11   0.035     1.007936    1.239201
                   age2 |    1.03758   .1165327     0.33   0.743      .832571    1.293069
                   age3 |   .9092429   .2379664    -0.36   0.716     .5443824    1.518643
                 1.male |   1.944972   .0937311    13.80   0.000     1.769671    2.137637
                        |
              ethnicity |
                 Mixed  |   1.120757    .459407     0.28   0.781     .5018773    2.502797
Asian or Asian British  |   3.707542   .2937927    16.54   0.000     3.174207    4.330489
                 Black  |   1.195801   .2604012     0.82   0.412     .7803662    1.832395
                 Other  |   1.360193   .3550408     1.18   0.239     .8154888    2.268732
-----------------------------------------------------------------------------------------
                                                             Stratified by stp

. stcox age1 age2 age3 i.male i.ethnicity i.imd, strata(stp) 

         failure _d:  onsdeath == 1
   analysis time _t:  (stime_onsdeath-origin)
             origin:  time enter_date
  enter on or after:  time enter_date
                 id:  patient_id

Iteration 0:   log likelihood = -24114.452
Iteration 1:   log likelihood = -21834.985
Iteration 2:   log likelihood = -21183.921
Iteration 3:   log likelihood = -21163.203
Iteration 4:   log likelihood = -21162.151
Iteration 5:   log likelihood = -21162.072
Iteration 6:   log likelihood = -21162.071
Iteration 7:   log likelihood = -21162.071
Refining estimates:
Iteration 0:   log likelihood = -21162.071

Stratified Cox regr. -- Breslow method for ties

No. of subjects =   13,223,154                  Number of obs    =  13,223,154
No. of failures =        1,809
Time at risk    =    911660733
                                                LR chi2(12)      =     5904.76
Log likelihood  =   -21162.071                  Prob > chi2      =      0.0000

-----------------------------------------------------------------------------------------
                     _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------+----------------------------------------------------------------
                   age1 |   1.115031   .0583577     2.08   0.037     1.006323    1.235483
                   age2 |   1.051088   .1174902     0.45   0.656     .8442914    1.308538
                   age3 |   .8769066   .2286233    -0.50   0.614     .5260557    1.461756
                 1.male |   1.968799    .094967    14.04   0.000     1.791195    2.164013
                        |
              ethnicity |
                 Mixed  |   .9795464   .4016627    -0.05   0.960     .4385206    2.188064
Asian or Asian British  |   3.038003   .2444372    13.81   0.000     2.594781    3.556933
                 Black  |   .9458856   .2064721    -0.25   0.799      .616644    1.450917
                 Other  |   1.232478   .3219205     0.80   0.424     .7386648    2.056417
                        |
                    imd |
                     2  |   1.244627    .112087     2.43   0.015     1.043236    1.484894
                     3  |   1.453951   .1291338     4.21   0.000     1.221658    1.730413
                     4  |   2.251959   .1855315     9.85   0.000     1.916164    2.646599
       5 most deprived  |   2.569014   .2076419    11.67   0.000     2.192642    3.009991
-----------------------------------------------------------------------------------------
                                                             Stratified by stp

. 
. log close
no log file open
r(606);

end of do-file

r(606);

. d ht*

              storage   display    value
variable name   type    format     label      variable label
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
htdiag_or_hig~p float   %9.0g                 Diagnosed hypertension or high blood pressure

. do "E:\STATATMP\STD59a8_000000.tmp"

. *FULLY ADJUSTED
. stcox age1 age2 age3                                    ///
>                         i.male                                                  ///
>                         i.obese4cat                                             ///
>                         i.smoke_nomiss                                  ///
>                         i.ethnicity                                             ///
>                         i.imd                                                   ///
>                         i.htdiag_or_highbp                                              ///
>                         i.chronic_respiratory_disease   ///
>                         i.asthmacat                                             ///
>                         i.chronic_cardiac_disease               ///
>                         i.diabcat                                               ///
>                         i.cancer_exhaem_cat                             ///
>                         i.cancer_haem_cat                               ///
>                         i.chronic_liver_disease                 ///
>                         i.stroke_dementia                               ///
>                         i.other_neuro                                   ///
>                         i.chronic_kidney_disease                ///
>                         i.organ_transplant                              ///
>                         i.spleen                                                ///
>                         i.ra_sle_psoriasis                      ///
>                         i.other_immunosuppression                       ///
>                         , strata(stp)
variable chronic_kidney_disease not found
r(111);

end of do-file

r(111);

. do "E:\STATATMP\STD59a8_000000.tmp"

. *FULLY ADJUSTED
. stcox age1 age2 age3                                    ///
>                         i.male                                                  ///
>                         i.obese4cat                                             ///
>                         i.smoke_nomiss                                  ///
>                         i.ethnicity                                             ///
>                         i.imd                                                   ///
>                         i.htdiag_or_highbp                                              ///
>                         i.chronic_respiratory_disease   ///
>                         i.asthmacat                                             ///
>                         i.chronic_cardiac_disease               ///
>                         i.diabcat                                               ///
>                         i.cancer_exhaem_cat                             ///
>                         i.cancer_haem_cat                               ///
>                         i.chronic_liver_disease                 ///
>                         i.stroke_dementia                               ///
>                         i.other_neuro                                   ///
>                         i.reduced_kidney_function_cat   ///
>                         i.organ_transplant                              ///
>                         i.spleen                                                ///
>                         i.ra_sle_psoriasis                      ///
>                         i.other_immunosuppression                       ///
>                         , strata(stp)

         failure _d:  onsdeath == 1
   analysis time _t:  (stime_onsdeath-origin)
             origin:  time enter_date
  enter on or after:  time enter_date
                 id:  patient_id

Iteration 0:   log likelihood = -24114.452
Iteration 1:   log likelihood = -21740.027
Iteration 2:   log likelihood = -20729.545
Iteration 3:   log likelihood = -20671.786
Iteration 4:   log likelihood = -20664.738
Iteration 5:   log likelihood = -20663.188
Iteration 6:   log likelihood = -20663.016
Iteration 7:   log likelihood = -20663.013
Iteration 8:   log likelihood = -20663.013
Refining estimates:
Iteration 0:   log likelihood = -20663.013

Stratified Cox regr. -- Breslow method for ties

No. of subjects =   13,223,154                  Number of obs    =  13,223,154
No. of failures =        1,809
Time at risk    =    911660733
                                                LR chi2(40)      =     6902.88
Log likelihood  =   -20663.013                  Prob > chi2      =      0.0000

-----------------------------------------------------------------------------------------------
                           _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
------------------------------+----------------------------------------------------------------
                         age1 |   1.146476   .0641171     2.44   0.015     1.027452     1.27929
                         age2 |   .9270606   .1097619    -0.64   0.522     .7350684    1.169199
                         age3 |   1.200696   .3302354     0.67   0.506       .70036    2.058471
                       1.male |   1.655726   .0829516    10.06   0.000     1.500871    1.826559
                              |
                    obese4cat |
           Obese I (30-34.9)  |   1.129625   .0705084     1.95   0.051     .9995496    1.276627
          Obese II (35-39.9)  |   1.388749   .1288429     3.54   0.000      1.15785    1.665693
             Obese III (40+)  |   2.302835   .2681696     7.16   0.000       1.8329    2.893257
                              |
                 smoke_nomiss |
                      Former  |   1.460238   .0826809     6.69   0.000     1.306855    1.631624
                     Current  |   .8246992   .0933061    -1.70   0.088     .6606798    1.029438
                              |
                    ethnicity |
                       Mixed  |   .9846473    .403995    -0.04   0.970     .4405931    2.200512
      Asian or Asian British  |   2.988291   .2508446    13.04   0.000     2.534959    3.522694
                       Black  |   .9527455   .2089951    -0.22   0.825     .6198071    1.464527
                       Other  |   1.386595   .3629603     1.25   0.212     .8301108    2.316133
                              |
                          imd |
                           2  |    1.18211   .1065093     1.86   0.063     .9907489    1.410431
                           3  |   1.322448   .1176749     3.14   0.002     1.110801     1.57442
                           4  |   1.941363   .1608004     8.01   0.000     1.650452    2.283551
             5 most deprived  |   2.065314   .1691324     8.86   0.000     1.759056    2.424893
                              |
           1.htdiag_or_highbp |   1.021935   .0606345     0.37   0.715     .9097439    1.147963
1.chronic_respiratory_disease |   1.972718   .1112318    12.05   0.000     1.766322    2.203231
                              |
                    asthmacat |
                 Yes, no OCS  |   1.089645    .076114     1.23   0.219     .9502257     1.24952
                Yes with OCS  |   1.129917   .1441413     0.96   0.338     .8799546    1.450883
                              |
    1.chronic_cardiac_disease |   1.469054   .0753629     7.50   0.000     1.328528    1.624443
                              |
                      diabcat |
         Controlled diabetes  |   1.312543   .0791373     4.51   0.000      1.16625    1.477185
       Uncontrolled diabetes  |   1.926789   .1442966     8.76   0.000      1.66375    2.231415
  Diabetes, no hba1c measure  |    1.60387   .1779353     4.26   0.000     1.290434    1.993437
                              |
            cancer_exhaem_cat |
                   Last year  |   2.351015   .3609766     5.57   0.000     1.740048    3.176505
               2-5 years ago  |   1.083253   .1320229     0.66   0.512     .8530777    1.375534
                    5+ years  |   1.010553   .0787941     0.13   0.893     .8673413    1.177412
                              |
              cancer_haem_cat |
                   Last year  |   1.916629   .8601077     1.45   0.147     .7953389    4.618743
               2-5 years ago  |   1.575397   .4390232     1.63   0.103     .9123927    2.720184
                    5+ years  |   2.309675   .3663941     5.28   0.000      1.69247    3.151961
                              |
      1.chronic_liver_disease |   1.339291   .2590379     1.51   0.131     .9167284    1.956634
            1.stroke_dementia |   1.507639   .0947019     6.54   0.000     1.332998    1.705161
                1.other_neuro |    2.68524   .2708544     9.79   0.000     2.203557    3.272217
                              |
  reduced_kidney_function_cat |
Stage 3a/3b egfr 30-60        |   1.419742   .0792941     6.28   0.000     1.272533    1.583981
           Stage 4/5 egfr<30  |   2.532746   .2365807     9.95   0.000     2.109026    3.041595
                              |
           1.organ_transplant |   5.377885   1.306581     6.92   0.000     3.340475    8.657944
                     1.spleen |   1.559276    .554096     1.25   0.211     .7770421     3.12897
           1.ra_sle_psoriasis |   1.361559   .1051267     4.00   0.000     1.170347    1.584011
    1.other_immunosuppression |   1.252757   .5621004     0.50   0.616     .5199251    3.018513
-----------------------------------------------------------------------------------------------
                                                             Stratified by stp

. 
end of do-file

. 
